"use strict";var lh=Object.create;var Yn=Object.defineProperty;var ch=Object.getOwnPropertyDescriptor;var dh=Object.getOwnPropertyNames;var fh=Object.getPrototypeOf,hh=Object.prototype.hasOwnProperty;var w=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),mh=(r,e)=>{for(var t in e)Yn(r,t,{get:e[t],enumerable:!0})},ul=(r,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of dh(e))!hh.call(r,a)&&a!==t&&Yn(r,a,{get:()=>e[a],enumerable:!(s=ch(e,a))||s.enumerable});return r};var He=(r,e,t)=>(t=r!=null?lh(fh(r)):{},ul(e||!r||!r.__esModule?Yn(t,"default",{value:r,enumerable:!0}):t,r)),ph=r=>ul(Yn({},"__esModule",{value:!0}),r);var cl=w((m_,ll)=>{"use strict";function _h(r){if(!/^data:/i.test(r))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');r=r.replace(/\r?\n/g,"");let e=r.indexOf(",");if(e===-1||e<=4)throw new TypeError("malformed data: URI");let t=r.substring(5,e).split(";"),s="",a=!1,u=t[0]||"text/plain",c=u;for(let b=1;b<t.length;b++)t[b]==="base64"?a=!0:(c+=`;${t[b]}`,t[b].indexOf("charset=")===0&&(s=t[b].substring(8)));!t[0]&&!s.length&&(c+=";charset=US-ASCII",s="US-ASCII");let f=a?"base64":"ascii",m=unescape(r.substring(e+1)),S=Buffer.from(m,f);return S.type=u,S.typeFull=c,S.charset=s,S}ll.exports=_h});var fl=w((Xn,dl)=>{(function(r,e){typeof Xn=="object"&&typeof dl<"u"?e(Xn):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis<"u"?globalThis:r||self,e(r.WebStreamsPolyfill={}))})(Xn,function(r){"use strict";let e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:n=>`Symbol(${n})`;function t(){}function s(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}let a=s();function u(n){return typeof n=="object"&&n!==null||typeof n=="function"}let c=t,f=Promise,m=Promise.prototype.then,S=Promise.resolve.bind(f),b=Promise.reject.bind(f);function T(n){return new f(n)}function g(n){return S(n)}function p(n){return b(n)}function D(n,i,o){return m.call(n,i,o)}function L(n,i,o){D(D(n,i,o),void 0,c)}function te(n,i){L(n,i)}function le(n,i){L(n,void 0,i)}function se(n,i,o){return D(n,i,o)}function ie(n){D(n,void 0,c)}let U=(()=>{let n=a&&a.queueMicrotask;if(typeof n=="function")return n;let i=g(void 0);return o=>D(i,o)})();function N(n,i,o){if(typeof n!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(n,i,o)}function ke(n,i,o){try{return g(N(n,i,o))}catch(l){return p(l)}}let _n=16384;class Ee{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(i){let o=this._back,l=o;o._elements.length===_n-1&&(l={_elements:[],_next:void 0}),o._elements.push(i),l!==o&&(this._back=l,o._next=l),++this._size}shift(){let i=this._front,o=i,l=this._cursor,d=l+1,h=i._elements,_=h[l];return d===_n&&(o=i._next,d=0),--this._size,this._cursor=d,i!==o&&(this._front=o),h[l]=void 0,_}forEach(i){let o=this._cursor,l=this._front,d=l._elements;for(;(o!==d.length||l._next!==void 0)&&!(o===d.length&&(l=l._next,d=l._elements,o=0,d.length===0));)i(d[o]),++o}peek(){let i=this._front,o=this._cursor;return i._elements[o]}}function Qo(n,i){n._ownerReadableStream=i,i._reader=n,i._state==="readable"?Ks(n):i._state==="closed"?Fd(n):Yo(n,i._storedError)}function Xs(n,i){let o=n._ownerReadableStream;return xe(o,i)}function tt(n){n._ownerReadableStream._state==="readable"?Gs(n,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):jd(n,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),n._ownerReadableStream._reader=void 0,n._ownerReadableStream=void 0}function Kt(n){return new TypeError("Cannot "+n+" a stream using a released reader")}function Ks(n){n._closedPromise=T((i,o)=>{n._closedPromise_resolve=i,n._closedPromise_reject=o})}function Yo(n,i){Ks(n),Gs(n,i)}function Fd(n){Ks(n),Xo(n)}function Gs(n,i){n._closedPromise_reject!==void 0&&(ie(n._closedPromise),n._closedPromise_reject(i),n._closedPromise_resolve=void 0,n._closedPromise_reject=void 0)}function jd(n,i){Yo(n,i)}function Xo(n){n._closedPromise_resolve!==void 0&&(n._closedPromise_resolve(void 0),n._closedPromise_resolve=void 0,n._closedPromise_reject=void 0)}let Ko=e("[[AbortSteps]]"),Go=e("[[ErrorSteps]]"),Js=e("[[CancelSteps]]"),Zs=e("[[PullSteps]]"),Jo=Number.isFinite||function(n){return typeof n=="number"&&isFinite(n)},Bd=Math.trunc||function(n){return n<0?Math.ceil(n):Math.floor(n)};function Ud(n){return typeof n=="object"||typeof n=="function"}function rt(n,i){if(n!==void 0&&!Ud(n))throw new TypeError(`${i} is not an object.`)}function Oe(n,i){if(typeof n!="function")throw new TypeError(`${i} is not a function.`)}function Wd(n){return typeof n=="object"&&n!==null||typeof n=="function"}function Zo(n,i){if(!Wd(n))throw new TypeError(`${i} is not an object.`)}function nt(n,i,o){if(n===void 0)throw new TypeError(`Parameter ${i} is required in '${o}'.`)}function ei(n,i,o){if(n===void 0)throw new TypeError(`${i} is required in '${o}'.`)}function ti(n){return Number(n)}function eu(n){return n===0?0:n}function zd(n){return eu(Bd(n))}function tu(n,i){let l=Number.MAX_SAFE_INTEGER,d=Number(n);if(d=eu(d),!Jo(d))throw new TypeError(`${i} is not a finite number`);if(d=zd(d),d<0||d>l)throw new TypeError(`${i} is outside the accepted range of 0 to ${l}, inclusive`);return!Jo(d)||d===0?0:d}function ri(n,i){if(!pt(n))throw new TypeError(`${i} is not a ReadableStream.`)}function Gt(n){return new vr(n)}function ru(n,i){n._reader._readRequests.push(i)}function ni(n,i,o){let d=n._reader._readRequests.shift();o?d._closeSteps():d._chunkSteps(i)}function gn(n){return n._reader._readRequests.length}function nu(n){let i=n._reader;return!(i===void 0||!dt(i))}class vr{constructor(i){if(nt(i,1,"ReadableStreamDefaultReader"),ri(i,"First parameter"),_t(i))throw new TypeError("This stream has already been locked for exclusive reading by another reader");Qo(this,i),this._readRequests=new Ee}get closed(){return dt(this)?this._closedPromise:p(wn("closed"))}cancel(i=void 0){return dt(this)?this._ownerReadableStream===void 0?p(Kt("cancel")):Xs(this,i):p(wn("cancel"))}read(){if(!dt(this))return p(wn("read"));if(this._ownerReadableStream===void 0)return p(Kt("read from"));let i,o,l=T((h,_)=>{i=h,o=_});return Rr(this,{_chunkSteps:h=>i({value:h,done:!1}),_closeSteps:()=>i({value:void 0,done:!0}),_errorSteps:h=>o(h)}),l}releaseLock(){if(!dt(this))throw wn("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");tt(this)}}}Object.defineProperties(vr.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(vr.prototype,e.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function dt(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_readRequests")?!1:n instanceof vr}function Rr(n,i){let o=n._ownerReadableStream;o._disturbed=!0,o._state==="closed"?i._closeSteps():o._state==="errored"?i._errorSteps(o._storedError):o._readableStreamController[Zs](i)}function wn(n){return new TypeError(`ReadableStreamDefaultReader.prototype.${n} can only be used on a ReadableStreamDefaultReader`)}let su=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class iu{constructor(i,o){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=i,this._preventCancel=o}next(){let i=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?se(this._ongoingPromise,i,i):i(),this._ongoingPromise}return(i){let o=()=>this._returnSteps(i);return this._ongoingPromise?se(this._ongoingPromise,o,o):o()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let i=this._reader;if(i._ownerReadableStream===void 0)return p(Kt("iterate"));let o,l,d=T((_,y)=>{o=_,l=y});return Rr(i,{_chunkSteps:_=>{this._ongoingPromise=void 0,U(()=>o({value:_,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,tt(i),o({value:void 0,done:!0})},_errorSteps:_=>{this._ongoingPromise=void 0,this._isFinished=!0,tt(i),l(_)}}),d}_returnSteps(i){if(this._isFinished)return Promise.resolve({value:i,done:!0});this._isFinished=!0;let o=this._reader;if(o._ownerReadableStream===void 0)return p(Kt("finish iterating"));if(!this._preventCancel){let l=Xs(o,i);return tt(o),se(l,()=>({value:i,done:!0}))}return tt(o),g({value:i,done:!0})}}let au={next(){return ou(this)?this._asyncIteratorImpl.next():p(uu("next"))},return(n){return ou(this)?this._asyncIteratorImpl.return(n):p(uu("return"))}};su!==void 0&&Object.setPrototypeOf(au,su);function $d(n,i){let o=Gt(n),l=new iu(o,i),d=Object.create(au);return d._asyncIteratorImpl=l,d}function ou(n){if(!u(n)||!Object.prototype.hasOwnProperty.call(n,"_asyncIteratorImpl"))return!1;try{return n._asyncIteratorImpl instanceof iu}catch{return!1}}function uu(n){return new TypeError(`ReadableStreamAsyncIterator.${n} can only be used on a ReadableSteamAsyncIterator`)}let lu=Number.isNaN||function(n){return n!==n};function Pr(n){return n.slice()}function cu(n,i,o,l,d){new Uint8Array(n).set(new Uint8Array(o,l,d),i)}function f_(n){return n}function yn(n){return!1}function du(n,i,o){if(n.slice)return n.slice(i,o);let l=o-i,d=new ArrayBuffer(l);return cu(d,0,n,i,l),d}function Nd(n){return!(typeof n!="number"||lu(n)||n<0)}function fu(n){let i=du(n.buffer,n.byteOffset,n.byteOffset+n.byteLength);return new Uint8Array(i)}function si(n){let i=n._queue.shift();return n._queueTotalSize-=i.size,n._queueTotalSize<0&&(n._queueTotalSize=0),i.value}function ii(n,i,o){if(!Nd(o)||o===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");n._queue.push({value:i,size:o}),n._queueTotalSize+=o}function Vd(n){return n._queue.peek().value}function ft(n){n._queue=new Ee,n._queueTotalSize=0}class qr{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!ai(this))throw di("view");return this._view}respond(i){if(!ai(this))throw di("respond");if(nt(i,1,"respond"),i=tu(i,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");yn(this._view.buffer),vn(this._associatedReadableByteStreamController,i)}respondWithNewView(i){if(!ai(this))throw di("respondWithNewView");if(nt(i,1,"respondWithNewView"),!ArrayBuffer.isView(i))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");yn(i.buffer),Rn(this._associatedReadableByteStreamController,i)}}Object.defineProperties(qr.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(qr.prototype,e.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class Jt{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!At(this))throw Dr("byobRequest");return ci(this)}get desiredSize(){if(!At(this))throw Dr("desiredSize");return bu(this)}close(){if(!At(this))throw Dr("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let i=this._controlledReadableByteStream._state;if(i!=="readable")throw new TypeError(`The stream (in ${i} state) is not in the readable state and cannot be closed`);Ar(this)}enqueue(i){if(!At(this))throw Dr("enqueue");if(nt(i,1,"enqueue"),!ArrayBuffer.isView(i))throw new TypeError("chunk must be an array buffer view");if(i.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(i.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let o=this._controlledReadableByteStream._state;if(o!=="readable")throw new TypeError(`The stream (in ${o} state) is not in the readable state and cannot be enqueued to`);Sn(this,i)}error(i=void 0){if(!At(this))throw Dr("error");Me(this,i)}[Js](i){hu(this),ft(this);let o=this._cancelAlgorithm(i);return Tn(this),o}[Zs](i){let o=this._controlledReadableByteStream;if(this._queueTotalSize>0){let d=this._queue.shift();this._queueTotalSize-=d.byteLength,gu(this);let h=new Uint8Array(d.buffer,d.byteOffset,d.byteLength);i._chunkSteps(h);return}let l=this._autoAllocateChunkSize;if(l!==void 0){let d;try{d=new ArrayBuffer(l)}catch(_){i._errorSteps(_);return}let h={buffer:d,bufferByteLength:l,byteOffset:0,byteLength:l,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(h)}ru(o,i),Dt(this)}}Object.defineProperties(Jt.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(Jt.prototype,e.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function At(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_controlledReadableByteStream")?!1:n instanceof Jt}function ai(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_associatedReadableByteStreamController")?!1:n instanceof qr}function Dt(n){if(!Xd(n))return;if(n._pulling){n._pullAgain=!0;return}n._pulling=!0;let o=n._pullAlgorithm();L(o,()=>{n._pulling=!1,n._pullAgain&&(n._pullAgain=!1,Dt(n))},l=>{Me(n,l)})}function hu(n){ui(n),n._pendingPullIntos=new Ee}function oi(n,i){let o=!1;n._state==="closed"&&(o=!0);let l=mu(i);i.readerType==="default"?ni(n,l,o):Jd(n,l,o)}function mu(n){let i=n.bytesFilled,o=n.elementSize;return new n.viewConstructor(n.buffer,n.byteOffset,i/o)}function bn(n,i,o,l){n._queue.push({buffer:i,byteOffset:o,byteLength:l}),n._queueTotalSize+=l}function pu(n,i){let o=i.elementSize,l=i.bytesFilled-i.bytesFilled%o,d=Math.min(n._queueTotalSize,i.byteLength-i.bytesFilled),h=i.bytesFilled+d,_=h-h%o,y=d,v=!1;_>l&&(y=_-i.bytesFilled,v=!0);let I=n._queue;for(;y>0;){let B=I.peek(),F=Math.min(y,B.byteLength),V=i.byteOffset+i.bytesFilled;cu(i.buffer,V,B.buffer,B.byteOffset,F),B.byteLength===F?I.shift():(B.byteOffset+=F,B.byteLength-=F),n._queueTotalSize-=F,_u(n,F,i),y-=F}return v}function _u(n,i,o){o.bytesFilled+=i}function gu(n){n._queueTotalSize===0&&n._closeRequested?(Tn(n),xr(n._controlledReadableByteStream)):Dt(n)}function ui(n){n._byobRequest!==null&&(n._byobRequest._associatedReadableByteStreamController=void 0,n._byobRequest._view=null,n._byobRequest=null)}function wu(n){for(;n._pendingPullIntos.length>0;){if(n._queueTotalSize===0)return;let i=n._pendingPullIntos.peek();pu(n,i)&&(li(n),oi(n._controlledReadableByteStream,i))}}function Hd(n,i,o){let l=n._controlledReadableByteStream,d=1;i.constructor!==DataView&&(d=i.constructor.BYTES_PER_ELEMENT);let h=i.constructor,_=i.buffer,y={buffer:_,bufferByteLength:_.byteLength,byteOffset:i.byteOffset,byteLength:i.byteLength,bytesFilled:0,elementSize:d,viewConstructor:h,readerType:"byob"};if(n._pendingPullIntos.length>0){n._pendingPullIntos.push(y),vu(l,o);return}if(l._state==="closed"){let v=new h(y.buffer,y.byteOffset,0);o._closeSteps(v);return}if(n._queueTotalSize>0){if(pu(n,y)){let v=mu(y);gu(n),o._chunkSteps(v);return}if(n._closeRequested){let v=new TypeError("Insufficient bytes to fill elements in the given buffer");Me(n,v),o._errorSteps(v);return}}n._pendingPullIntos.push(y),vu(l,o),Dt(n)}function Qd(n,i){let o=n._controlledReadableByteStream;if(fi(o))for(;Ru(o)>0;){let l=li(n);oi(o,l)}}function Yd(n,i,o){if(_u(n,i,o),o.bytesFilled<o.elementSize)return;li(n);let l=o.bytesFilled%o.elementSize;if(l>0){let d=o.byteOffset+o.bytesFilled,h=du(o.buffer,d-l,d);bn(n,h,0,h.byteLength)}o.bytesFilled-=l,oi(n._controlledReadableByteStream,o),wu(n)}function yu(n,i){let o=n._pendingPullIntos.peek();ui(n),n._controlledReadableByteStream._state==="closed"?Qd(n):Yd(n,i,o),Dt(n)}function li(n){return n._pendingPullIntos.shift()}function Xd(n){let i=n._controlledReadableByteStream;return i._state!=="readable"||n._closeRequested||!n._started?!1:!!(nu(i)&&gn(i)>0||fi(i)&&Ru(i)>0||bu(n)>0)}function Tn(n){n._pullAlgorithm=void 0,n._cancelAlgorithm=void 0}function Ar(n){let i=n._controlledReadableByteStream;if(!(n._closeRequested||i._state!=="readable")){if(n._queueTotalSize>0){n._closeRequested=!0;return}if(n._pendingPullIntos.length>0&&n._pendingPullIntos.peek().bytesFilled>0){let l=new TypeError("Insufficient bytes to fill elements in the given buffer");throw Me(n,l),l}Tn(n),xr(i)}}function Sn(n,i){let o=n._controlledReadableByteStream;if(n._closeRequested||o._state!=="readable")return;let l=i.buffer,d=i.byteOffset,h=i.byteLength,_=l;if(n._pendingPullIntos.length>0){let y=n._pendingPullIntos.peek();yn(y.buffer),y.buffer=y.buffer}if(ui(n),nu(o))if(gn(o)===0)bn(n,_,d,h);else{let y=new Uint8Array(_,d,h);ni(o,y,!1)}else fi(o)?(bn(n,_,d,h),wu(n)):bn(n,_,d,h);Dt(n)}function Me(n,i){let o=n._controlledReadableByteStream;o._state==="readable"&&(hu(n),ft(n),Tn(n),Yu(o,i))}function ci(n){if(n._byobRequest===null&&n._pendingPullIntos.length>0){let i=n._pendingPullIntos.peek(),o=new Uint8Array(i.buffer,i.byteOffset+i.bytesFilled,i.byteLength-i.bytesFilled),l=Object.create(qr.prototype);Gd(l,n,o),n._byobRequest=l}return n._byobRequest}function bu(n){let i=n._controlledReadableByteStream._state;return i==="errored"?null:i==="closed"?0:n._strategyHWM-n._queueTotalSize}function vn(n,i){let o=n._pendingPullIntos.peek();if(n._controlledReadableByteStream._state==="closed"){if(i!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(i===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(o.bytesFilled+i>o.byteLength)throw new RangeError("bytesWritten out of range")}o.buffer=o.buffer,yu(n,i)}function Rn(n,i){let o=n._pendingPullIntos.peek();if(n._controlledReadableByteStream._state==="closed"){if(i.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(i.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(o.byteOffset+o.bytesFilled!==i.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(o.bufferByteLength!==i.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(o.bytesFilled+i.byteLength>o.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");o.buffer=i.buffer,yu(n,i.byteLength)}function Tu(n,i,o,l,d,h,_){i._controlledReadableByteStream=n,i._pullAgain=!1,i._pulling=!1,i._byobRequest=null,i._queue=i._queueTotalSize=void 0,ft(i),i._closeRequested=!1,i._started=!1,i._strategyHWM=h,i._pullAlgorithm=l,i._cancelAlgorithm=d,i._autoAllocateChunkSize=_,i._pendingPullIntos=new Ee,n._readableStreamController=i;let y=o();L(g(y),()=>{i._started=!0,Dt(i)},v=>{Me(i,v)})}function Kd(n,i,o){let l=Object.create(Jt.prototype),d=()=>{},h=()=>g(void 0),_=()=>g(void 0);i.start!==void 0&&(d=()=>i.start(l)),i.pull!==void 0&&(h=()=>i.pull(l)),i.cancel!==void 0&&(_=v=>i.cancel(v));let y=i.autoAllocateChunkSize;if(y===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");Tu(n,l,d,h,_,o,y)}function Gd(n,i,o){n._associatedReadableByteStreamController=i,n._view=o}function di(n){return new TypeError(`ReadableStreamBYOBRequest.prototype.${n} can only be used on a ReadableStreamBYOBRequest`)}function Dr(n){return new TypeError(`ReadableByteStreamController.prototype.${n} can only be used on a ReadableByteStreamController`)}function Su(n){return new Lr(n)}function vu(n,i){n._reader._readIntoRequests.push(i)}function Jd(n,i,o){let d=n._reader._readIntoRequests.shift();o?d._closeSteps(i):d._chunkSteps(i)}function Ru(n){return n._reader._readIntoRequests.length}function fi(n){let i=n._reader;return!(i===void 0||!Lt(i))}class Lr{constructor(i){if(nt(i,1,"ReadableStreamBYOBReader"),ri(i,"First parameter"),_t(i))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!At(i._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");Qo(this,i),this._readIntoRequests=new Ee}get closed(){return Lt(this)?this._closedPromise:p(Pn("closed"))}cancel(i=void 0){return Lt(this)?this._ownerReadableStream===void 0?p(Kt("cancel")):Xs(this,i):p(Pn("cancel"))}read(i){if(!Lt(this))return p(Pn("read"));if(!ArrayBuffer.isView(i))return p(new TypeError("view must be an array buffer view"));if(i.byteLength===0)return p(new TypeError("view must have non-zero byteLength"));if(i.buffer.byteLength===0)return p(new TypeError("view's buffer must have non-zero byteLength"));if(yn(i.buffer),this._ownerReadableStream===void 0)return p(Kt("read from"));let o,l,d=T((_,y)=>{o=_,l=y});return Pu(this,i,{_chunkSteps:_=>o({value:_,done:!1}),_closeSteps:_=>o({value:_,done:!0}),_errorSteps:_=>l(_)}),d}releaseLock(){if(!Lt(this))throw Pn("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");tt(this)}}}Object.defineProperties(Lr.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(Lr.prototype,e.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function Lt(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_readIntoRequests")?!1:n instanceof Lr}function Pu(n,i,o){let l=n._ownerReadableStream;l._disturbed=!0,l._state==="errored"?o._errorSteps(l._storedError):Hd(l._readableStreamController,i,o)}function Pn(n){return new TypeError(`ReadableStreamBYOBReader.prototype.${n} can only be used on a ReadableStreamBYOBReader`)}function Cr(n,i){let{highWaterMark:o}=n;if(o===void 0)return i;if(lu(o)||o<0)throw new RangeError("Invalid highWaterMark");return o}function qn(n){let{size:i}=n;return i||(()=>1)}function An(n,i){rt(n,i);let o=n?.highWaterMark,l=n?.size;return{highWaterMark:o===void 0?void 0:ti(o),size:l===void 0?void 0:Zd(l,`${i} has member 'size' that`)}}function Zd(n,i){return Oe(n,i),o=>ti(n(o))}function ef(n,i){rt(n,i);let o=n?.abort,l=n?.close,d=n?.start,h=n?.type,_=n?.write;return{abort:o===void 0?void 0:tf(o,n,`${i} has member 'abort' that`),close:l===void 0?void 0:rf(l,n,`${i} has member 'close' that`),start:d===void 0?void 0:nf(d,n,`${i} has member 'start' that`),write:_===void 0?void 0:sf(_,n,`${i} has member 'write' that`),type:h}}function tf(n,i,o){return Oe(n,o),l=>ke(n,i,[l])}function rf(n,i,o){return Oe(n,o),()=>ke(n,i,[])}function nf(n,i,o){return Oe(n,o),l=>N(n,i,[l])}function sf(n,i,o){return Oe(n,o),(l,d)=>ke(n,i,[l,d])}function qu(n,i){if(!Zt(n))throw new TypeError(`${i} is not a WritableStream.`)}function af(n){if(typeof n!="object"||n===null)return!1;try{return typeof n.aborted=="boolean"}catch{return!1}}let of=typeof AbortController=="function";function uf(){if(of)return new AbortController}class Ir{constructor(i={},o={}){i===void 0?i=null:Zo(i,"First parameter");let l=An(o,"Second parameter"),d=ef(i,"First parameter");if(Du(this),d.type!==void 0)throw new RangeError("Invalid type is specified");let _=qn(l),y=Cr(l,1);Sf(this,d,y,_)}get locked(){if(!Zt(this))throw kn("locked");return er(this)}abort(i=void 0){return Zt(this)?er(this)?p(new TypeError("Cannot abort a stream that already has a writer")):Dn(this,i):p(kn("abort"))}close(){return Zt(this)?er(this)?p(new TypeError("Cannot close a stream that already has a writer")):Ne(this)?p(new TypeError("Cannot close an already-closing stream")):Lu(this):p(kn("close"))}getWriter(){if(!Zt(this))throw kn("getWriter");return Au(this)}}Object.defineProperties(Ir.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(Ir.prototype,e.toStringTag,{value:"WritableStream",configurable:!0});function Au(n){return new kr(n)}function lf(n,i,o,l,d=1,h=()=>1){let _=Object.create(Ir.prototype);Du(_);let y=Object.create(tr.prototype);return Mu(_,y,n,i,o,l,d,h),_}function Du(n){n._state="writable",n._storedError=void 0,n._writer=void 0,n._writableStreamController=void 0,n._writeRequests=new Ee,n._inFlightWriteRequest=void 0,n._closeRequest=void 0,n._inFlightCloseRequest=void 0,n._pendingAbortRequest=void 0,n._backpressure=!1}function Zt(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_writableStreamController")?!1:n instanceof Ir}function er(n){return n._writer!==void 0}function Dn(n,i){var o;if(n._state==="closed"||n._state==="errored")return g(void 0);n._writableStreamController._abortReason=i,(o=n._writableStreamController._abortController)===null||o===void 0||o.abort();let l=n._state;if(l==="closed"||l==="errored")return g(void 0);if(n._pendingAbortRequest!==void 0)return n._pendingAbortRequest._promise;let d=!1;l==="erroring"&&(d=!0,i=void 0);let h=T((_,y)=>{n._pendingAbortRequest={_promise:void 0,_resolve:_,_reject:y,_reason:i,_wasAlreadyErroring:d}});return n._pendingAbortRequest._promise=h,d||mi(n,i),h}function Lu(n){let i=n._state;if(i==="closed"||i==="errored")return p(new TypeError(`The stream (in ${i} state) is not in the writable state and cannot be closed`));let o=T((d,h)=>{let _={_resolve:d,_reject:h};n._closeRequest=_}),l=n._writer;return l!==void 0&&n._backpressure&&i==="writable"&&vi(l),vf(n._writableStreamController),o}function cf(n){return T((o,l)=>{let d={_resolve:o,_reject:l};n._writeRequests.push(d)})}function hi(n,i){if(n._state==="writable"){mi(n,i);return}pi(n)}function mi(n,i){let o=n._writableStreamController;n._state="erroring",n._storedError=i;let l=n._writer;l!==void 0&&Iu(l,i),!pf(n)&&o._started&&pi(n)}function pi(n){n._state="errored",n._writableStreamController[Go]();let i=n._storedError;if(n._writeRequests.forEach(d=>{d._reject(i)}),n._writeRequests=new Ee,n._pendingAbortRequest===void 0){Ln(n);return}let o=n._pendingAbortRequest;if(n._pendingAbortRequest=void 0,o._wasAlreadyErroring){o._reject(i),Ln(n);return}let l=n._writableStreamController[Ko](o._reason);L(l,()=>{o._resolve(),Ln(n)},d=>{o._reject(d),Ln(n)})}function df(n){n._inFlightWriteRequest._resolve(void 0),n._inFlightWriteRequest=void 0}function ff(n,i){n._inFlightWriteRequest._reject(i),n._inFlightWriteRequest=void 0,hi(n,i)}function hf(n){n._inFlightCloseRequest._resolve(void 0),n._inFlightCloseRequest=void 0,n._state==="erroring"&&(n._storedError=void 0,n._pendingAbortRequest!==void 0&&(n._pendingAbortRequest._resolve(),n._pendingAbortRequest=void 0)),n._state="closed";let o=n._writer;o!==void 0&&Bu(o)}function mf(n,i){n._inFlightCloseRequest._reject(i),n._inFlightCloseRequest=void 0,n._pendingAbortRequest!==void 0&&(n._pendingAbortRequest._reject(i),n._pendingAbortRequest=void 0),hi(n,i)}function Ne(n){return!(n._closeRequest===void 0&&n._inFlightCloseRequest===void 0)}function pf(n){return!(n._inFlightWriteRequest===void 0&&n._inFlightCloseRequest===void 0)}function _f(n){n._inFlightCloseRequest=n._closeRequest,n._closeRequest=void 0}function gf(n){n._inFlightWriteRequest=n._writeRequests.shift()}function Ln(n){n._closeRequest!==void 0&&(n._closeRequest._reject(n._storedError),n._closeRequest=void 0);let i=n._writer;i!==void 0&&Ti(i,n._storedError)}function _i(n,i){let o=n._writer;o!==void 0&&i!==n._backpressure&&(i?Cf(o):vi(o)),n._backpressure=i}class kr{constructor(i){if(nt(i,1,"WritableStreamDefaultWriter"),qu(i,"First parameter"),er(i))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=i,i._writer=this;let o=i._state;if(o==="writable")!Ne(i)&&i._backpressure?On(this):Uu(this),En(this);else if(o==="erroring")Si(this,i._storedError),En(this);else if(o==="closed")Uu(this),Df(this);else{let l=i._storedError;Si(this,l),ju(this,l)}}get closed(){return Ct(this)?this._closedPromise:p(It("closed"))}get desiredSize(){if(!Ct(this))throw It("desiredSize");if(this._ownerWritableStream===void 0)throw Er("desiredSize");return Tf(this)}get ready(){return Ct(this)?this._readyPromise:p(It("ready"))}abort(i=void 0){return Ct(this)?this._ownerWritableStream===void 0?p(Er("abort")):wf(this,i):p(It("abort"))}close(){if(!Ct(this))return p(It("close"));let i=this._ownerWritableStream;return i===void 0?p(Er("close")):Ne(i)?p(new TypeError("Cannot close an already-closing stream")):Cu(this)}releaseLock(){if(!Ct(this))throw It("releaseLock");this._ownerWritableStream!==void 0&&ku(this)}write(i=void 0){return Ct(this)?this._ownerWritableStream===void 0?p(Er("write to")):Eu(this,i):p(It("write"))}}Object.defineProperties(kr.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(kr.prototype,e.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function Ct(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_ownerWritableStream")?!1:n instanceof kr}function wf(n,i){let o=n._ownerWritableStream;return Dn(o,i)}function Cu(n){let i=n._ownerWritableStream;return Lu(i)}function yf(n){let i=n._ownerWritableStream,o=i._state;return Ne(i)||o==="closed"?g(void 0):o==="errored"?p(i._storedError):Cu(n)}function bf(n,i){n._closedPromiseState==="pending"?Ti(n,i):Lf(n,i)}function Iu(n,i){n._readyPromiseState==="pending"?Wu(n,i):If(n,i)}function Tf(n){let i=n._ownerWritableStream,o=i._state;return o==="errored"||o==="erroring"?null:o==="closed"?0:xu(i._writableStreamController)}function ku(n){let i=n._ownerWritableStream,o=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");Iu(n,o),bf(n,o),i._writer=void 0,n._ownerWritableStream=void 0}function Eu(n,i){let o=n._ownerWritableStream,l=o._writableStreamController,d=Rf(l,i);if(o!==n._ownerWritableStream)return p(Er("write to"));let h=o._state;if(h==="errored")return p(o._storedError);if(Ne(o)||h==="closed")return p(new TypeError("The stream is closing or closed and cannot be written to"));if(h==="erroring")return p(o._storedError);let _=cf(o);return Pf(l,i,d),_}let Ou={};class tr{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!gi(this))throw bi("abortReason");return this._abortReason}get signal(){if(!gi(this))throw bi("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(i=void 0){if(!gi(this))throw bi("error");this._controlledWritableStream._state==="writable"&&Fu(this,i)}[Ko](i){let o=this._abortAlgorithm(i);return Cn(this),o}[Go](){ft(this)}}Object.defineProperties(tr.prototype,{error:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(tr.prototype,e.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function gi(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_controlledWritableStream")?!1:n instanceof tr}function Mu(n,i,o,l,d,h,_,y){i._controlledWritableStream=n,n._writableStreamController=i,i._queue=void 0,i._queueTotalSize=void 0,ft(i),i._abortReason=void 0,i._abortController=uf(),i._started=!1,i._strategySizeAlgorithm=y,i._strategyHWM=_,i._writeAlgorithm=l,i._closeAlgorithm=d,i._abortAlgorithm=h;let v=yi(i);_i(n,v);let I=o(),B=g(I);L(B,()=>{i._started=!0,In(i)},F=>{i._started=!0,hi(n,F)})}function Sf(n,i,o,l){let d=Object.create(tr.prototype),h=()=>{},_=()=>g(void 0),y=()=>g(void 0),v=()=>g(void 0);i.start!==void 0&&(h=()=>i.start(d)),i.write!==void 0&&(_=I=>i.write(I,d)),i.close!==void 0&&(y=()=>i.close()),i.abort!==void 0&&(v=I=>i.abort(I)),Mu(n,d,h,_,y,v,o,l)}function Cn(n){n._writeAlgorithm=void 0,n._closeAlgorithm=void 0,n._abortAlgorithm=void 0,n._strategySizeAlgorithm=void 0}function vf(n){ii(n,Ou,0),In(n)}function Rf(n,i){try{return n._strategySizeAlgorithm(i)}catch(o){return wi(n,o),1}}function xu(n){return n._strategyHWM-n._queueTotalSize}function Pf(n,i,o){try{ii(n,i,o)}catch(d){wi(n,d);return}let l=n._controlledWritableStream;if(!Ne(l)&&l._state==="writable"){let d=yi(n);_i(l,d)}In(n)}function In(n){let i=n._controlledWritableStream;if(!n._started||i._inFlightWriteRequest!==void 0)return;if(i._state==="erroring"){pi(i);return}if(n._queue.length===0)return;let l=Vd(n);l===Ou?qf(n):Af(n,l)}function wi(n,i){n._controlledWritableStream._state==="writable"&&Fu(n,i)}function qf(n){let i=n._controlledWritableStream;_f(i),si(n);let o=n._closeAlgorithm();Cn(n),L(o,()=>{hf(i)},l=>{mf(i,l)})}function Af(n,i){let o=n._controlledWritableStream;gf(o);let l=n._writeAlgorithm(i);L(l,()=>{df(o);let d=o._state;if(si(n),!Ne(o)&&d==="writable"){let h=yi(n);_i(o,h)}In(n)},d=>{o._state==="writable"&&Cn(n),ff(o,d)})}function yi(n){return xu(n)<=0}function Fu(n,i){let o=n._controlledWritableStream;Cn(n),mi(o,i)}function kn(n){return new TypeError(`WritableStream.prototype.${n} can only be used on a WritableStream`)}function bi(n){return new TypeError(`WritableStreamDefaultController.prototype.${n} can only be used on a WritableStreamDefaultController`)}function It(n){return new TypeError(`WritableStreamDefaultWriter.prototype.${n} can only be used on a WritableStreamDefaultWriter`)}function Er(n){return new TypeError("Cannot "+n+" a stream using a released writer")}function En(n){n._closedPromise=T((i,o)=>{n._closedPromise_resolve=i,n._closedPromise_reject=o,n._closedPromiseState="pending"})}function ju(n,i){En(n),Ti(n,i)}function Df(n){En(n),Bu(n)}function Ti(n,i){n._closedPromise_reject!==void 0&&(ie(n._closedPromise),n._closedPromise_reject(i),n._closedPromise_resolve=void 0,n._closedPromise_reject=void 0,n._closedPromiseState="rejected")}function Lf(n,i){ju(n,i)}function Bu(n){n._closedPromise_resolve!==void 0&&(n._closedPromise_resolve(void 0),n._closedPromise_resolve=void 0,n._closedPromise_reject=void 0,n._closedPromiseState="resolved")}function On(n){n._readyPromise=T((i,o)=>{n._readyPromise_resolve=i,n._readyPromise_reject=o}),n._readyPromiseState="pending"}function Si(n,i){On(n),Wu(n,i)}function Uu(n){On(n),vi(n)}function Wu(n,i){n._readyPromise_reject!==void 0&&(ie(n._readyPromise),n._readyPromise_reject(i),n._readyPromise_resolve=void 0,n._readyPromise_reject=void 0,n._readyPromiseState="rejected")}function Cf(n){On(n)}function If(n,i){Si(n,i)}function vi(n){n._readyPromise_resolve!==void 0&&(n._readyPromise_resolve(void 0),n._readyPromise_resolve=void 0,n._readyPromise_reject=void 0,n._readyPromiseState="fulfilled")}let zu=typeof DOMException<"u"?DOMException:void 0;function kf(n){if(!(typeof n=="function"||typeof n=="object"))return!1;try{return new n,!0}catch{return!1}}function Ef(){let n=function(o,l){this.message=o||"",this.name=l||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return n.prototype=Object.create(Error.prototype),Object.defineProperty(n.prototype,"constructor",{value:n,writable:!0,configurable:!0}),n}let Of=kf(zu)?zu:Ef();function $u(n,i,o,l,d,h){let _=Gt(n),y=Au(i);n._disturbed=!0;let v=!1,I=g(void 0);return T((B,F)=>{let V;if(h!==void 0){if(V=()=>{let P=new Of("Aborted","AbortError"),k=[];l||k.push(()=>i._state==="writable"?Dn(i,P):g(void 0)),d||k.push(()=>n._state==="readable"?xe(n,P):g(void 0)),de(()=>Promise.all(k.map(Y=>Y())),!0,P)},h.aborted){V();return}h.addEventListener("abort",V)}function gt(){return T((P,k)=>{function Y(Fe){Fe?P():D(jr(),Y,k)}Y(!1)})}function jr(){return v?g(!0):D(y._readyPromise,()=>T((P,k)=>{Rr(_,{_chunkSteps:Y=>{I=D(Eu(y,Y),void 0,t),P(!1)},_closeSteps:()=>P(!0),_errorSteps:k})}))}if(ce(n,_._closedPromise,P=>{l?j(!0,P):de(()=>Dn(i,P),!0,P)}),ce(i,y._closedPromise,P=>{d?j(!0,P):de(()=>xe(n,P),!0,P)}),Ve(n,_._closedPromise,()=>{o?j():de(()=>yf(y))}),Ne(i)||i._state==="closed"){let P=new TypeError("the destination writable stream closed before all data could be piped to it");d?j(!0,P):de(()=>xe(n,P),!0,P)}ie(gt());function wt(){let P=I;return D(I,()=>P!==I?wt():void 0)}function ce(P,k,Y){P._state==="errored"?Y(P._storedError):le(k,Y)}function Ve(P,k,Y){P._state==="closed"?Y():te(k,Y)}function de(P,k,Y){if(v)return;v=!0,i._state==="writable"&&!Ne(i)?te(wt(),Fe):Fe();function Fe(){L(P(),()=>W(k,Y),yt=>W(!0,yt))}}function j(P,k){v||(v=!0,i._state==="writable"&&!Ne(i)?te(wt(),()=>W(P,k)):W(P,k))}function W(P,k){ku(y),tt(_),h!==void 0&&h.removeEventListener("abort",V),P?F(k):B(void 0)}})}class rr{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Mn(this))throw jn("desiredSize");return Ri(this)}close(){if(!Mn(this))throw jn("close");if(!nr(this))throw new TypeError("The stream is not in a state that permits close");Mr(this)}enqueue(i=void 0){if(!Mn(this))throw jn("enqueue");if(!nr(this))throw new TypeError("The stream is not in a state that permits enqueue");return Fn(this,i)}error(i=void 0){if(!Mn(this))throw jn("error");ht(this,i)}[Js](i){ft(this);let o=this._cancelAlgorithm(i);return xn(this),o}[Zs](i){let o=this._controlledReadableStream;if(this._queue.length>0){let l=si(this);this._closeRequested&&this._queue.length===0?(xn(this),xr(o)):Or(this),i._chunkSteps(l)}else ru(o,i),Or(this)}}Object.defineProperties(rr.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(rr.prototype,e.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function Mn(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_controlledReadableStream")?!1:n instanceof rr}function Or(n){if(!Nu(n))return;if(n._pulling){n._pullAgain=!0;return}n._pulling=!0;let o=n._pullAlgorithm();L(o,()=>{n._pulling=!1,n._pullAgain&&(n._pullAgain=!1,Or(n))},l=>{ht(n,l)})}function Nu(n){let i=n._controlledReadableStream;return!nr(n)||!n._started?!1:!!(_t(i)&&gn(i)>0||Ri(n)>0)}function xn(n){n._pullAlgorithm=void 0,n._cancelAlgorithm=void 0,n._strategySizeAlgorithm=void 0}function Mr(n){if(!nr(n))return;let i=n._controlledReadableStream;n._closeRequested=!0,n._queue.length===0&&(xn(n),xr(i))}function Fn(n,i){if(!nr(n))return;let o=n._controlledReadableStream;if(_t(o)&&gn(o)>0)ni(o,i,!1);else{let l;try{l=n._strategySizeAlgorithm(i)}catch(d){throw ht(n,d),d}try{ii(n,i,l)}catch(d){throw ht(n,d),d}}Or(n)}function ht(n,i){let o=n._controlledReadableStream;o._state==="readable"&&(ft(n),xn(n),Yu(o,i))}function Ri(n){let i=n._controlledReadableStream._state;return i==="errored"?null:i==="closed"?0:n._strategyHWM-n._queueTotalSize}function Mf(n){return!Nu(n)}function nr(n){let i=n._controlledReadableStream._state;return!n._closeRequested&&i==="readable"}function Vu(n,i,o,l,d,h,_){i._controlledReadableStream=n,i._queue=void 0,i._queueTotalSize=void 0,ft(i),i._started=!1,i._closeRequested=!1,i._pullAgain=!1,i._pulling=!1,i._strategySizeAlgorithm=_,i._strategyHWM=h,i._pullAlgorithm=l,i._cancelAlgorithm=d,n._readableStreamController=i;let y=o();L(g(y),()=>{i._started=!0,Or(i)},v=>{ht(i,v)})}function xf(n,i,o,l){let d=Object.create(rr.prototype),h=()=>{},_=()=>g(void 0),y=()=>g(void 0);i.start!==void 0&&(h=()=>i.start(d)),i.pull!==void 0&&(_=()=>i.pull(d)),i.cancel!==void 0&&(y=v=>i.cancel(v)),Vu(n,d,h,_,y,o,l)}function jn(n){return new TypeError(`ReadableStreamDefaultController.prototype.${n} can only be used on a ReadableStreamDefaultController`)}function Ff(n,i){return At(n._readableStreamController)?Bf(n):jf(n)}function jf(n,i){let o=Gt(n),l=!1,d=!1,h=!1,_,y,v,I,B,F=T(ce=>{B=ce});function V(){return l||(l=!0,Rr(o,{_chunkSteps:Ve=>{U(()=>{l=!1;let de=Ve,j=Ve;d||Fn(v._readableStreamController,de),h||Fn(I._readableStreamController,j)})},_closeSteps:()=>{l=!1,d||Mr(v._readableStreamController),h||Mr(I._readableStreamController),(!d||!h)&&B(void 0)},_errorSteps:()=>{l=!1}})),g(void 0)}function gt(ce){if(d=!0,_=ce,h){let Ve=Pr([_,y]),de=xe(n,Ve);B(de)}return F}function jr(ce){if(h=!0,y=ce,d){let Ve=Pr([_,y]),de=xe(n,Ve);B(de)}return F}function wt(){}return v=Pi(wt,V,gt),I=Pi(wt,V,jr),le(o._closedPromise,ce=>{ht(v._readableStreamController,ce),ht(I._readableStreamController,ce),(!d||!h)&&B(void 0)}),[v,I]}function Bf(n){let i=Gt(n),o=!1,l=!1,d=!1,h,_,y,v,I,B=T(j=>{I=j});function F(j){le(j._closedPromise,W=>{j===i&&(Me(y._readableStreamController,W),Me(v._readableStreamController,W),(!l||!d)&&I(void 0))})}function V(){Lt(i)&&(tt(i),i=Gt(n),F(i)),Rr(i,{_chunkSteps:W=>{U(()=>{o=!1;let P=W,k=W;if(!l&&!d)try{k=fu(W)}catch(Y){Me(y._readableStreamController,Y),Me(v._readableStreamController,Y),I(xe(n,Y));return}l||Sn(y._readableStreamController,P),d||Sn(v._readableStreamController,k)})},_closeSteps:()=>{o=!1,l||Ar(y._readableStreamController),d||Ar(v._readableStreamController),y._readableStreamController._pendingPullIntos.length>0&&vn(y._readableStreamController,0),v._readableStreamController._pendingPullIntos.length>0&&vn(v._readableStreamController,0),(!l||!d)&&I(void 0)},_errorSteps:()=>{o=!1}})}function gt(j,W){dt(i)&&(tt(i),i=Su(n),F(i));let P=W?v:y,k=W?y:v;Pu(i,j,{_chunkSteps:Fe=>{U(()=>{o=!1;let yt=W?d:l;if(W?l:d)yt||Rn(P._readableStreamController,Fe);else{let ol;try{ol=fu(Fe)}catch(Ai){Me(P._readableStreamController,Ai),Me(k._readableStreamController,Ai),I(xe(n,Ai));return}yt||Rn(P._readableStreamController,Fe),Sn(k._readableStreamController,ol)}})},_closeSteps:Fe=>{o=!1;let yt=W?d:l,Qn=W?l:d;yt||Ar(P._readableStreamController),Qn||Ar(k._readableStreamController),Fe!==void 0&&(yt||Rn(P._readableStreamController,Fe),!Qn&&k._readableStreamController._pendingPullIntos.length>0&&vn(k._readableStreamController,0)),(!yt||!Qn)&&I(void 0)},_errorSteps:()=>{o=!1}})}function jr(){if(o)return g(void 0);o=!0;let j=ci(y._readableStreamController);return j===null?V():gt(j._view,!1),g(void 0)}function wt(){if(o)return g(void 0);o=!0;let j=ci(v._readableStreamController);return j===null?V():gt(j._view,!0),g(void 0)}function ce(j){if(l=!0,h=j,d){let W=Pr([h,_]),P=xe(n,W);I(P)}return B}function Ve(j){if(d=!0,_=j,l){let W=Pr([h,_]),P=xe(n,W);I(P)}return B}function de(){}return y=Qu(de,jr,ce),v=Qu(de,wt,Ve),F(i),[y,v]}function Uf(n,i){rt(n,i);let o=n,l=o?.autoAllocateChunkSize,d=o?.cancel,h=o?.pull,_=o?.start,y=o?.type;return{autoAllocateChunkSize:l===void 0?void 0:tu(l,`${i} has member 'autoAllocateChunkSize' that`),cancel:d===void 0?void 0:Wf(d,o,`${i} has member 'cancel' that`),pull:h===void 0?void 0:zf(h,o,`${i} has member 'pull' that`),start:_===void 0?void 0:$f(_,o,`${i} has member 'start' that`),type:y===void 0?void 0:Nf(y,`${i} has member 'type' that`)}}function Wf(n,i,o){return Oe(n,o),l=>ke(n,i,[l])}function zf(n,i,o){return Oe(n,o),l=>ke(n,i,[l])}function $f(n,i,o){return Oe(n,o),l=>N(n,i,[l])}function Nf(n,i){if(n=`${n}`,n!=="bytes")throw new TypeError(`${i} '${n}' is not a valid enumeration value for ReadableStreamType`);return n}function Vf(n,i){rt(n,i);let o=n?.mode;return{mode:o===void 0?void 0:Hf(o,`${i} has member 'mode' that`)}}function Hf(n,i){if(n=`${n}`,n!=="byob")throw new TypeError(`${i} '${n}' is not a valid enumeration value for ReadableStreamReaderMode`);return n}function Qf(n,i){return rt(n,i),{preventCancel:!!n?.preventCancel}}function Hu(n,i){rt(n,i);let o=n?.preventAbort,l=n?.preventCancel,d=n?.preventClose,h=n?.signal;return h!==void 0&&Yf(h,`${i} has member 'signal' that`),{preventAbort:!!o,preventCancel:!!l,preventClose:!!d,signal:h}}function Yf(n,i){if(!af(n))throw new TypeError(`${i} is not an AbortSignal.`)}function Xf(n,i){rt(n,i);let o=n?.readable;ei(o,"readable","ReadableWritablePair"),ri(o,`${i} has member 'readable' that`);let l=n?.writable;return ei(l,"writable","ReadableWritablePair"),qu(l,`${i} has member 'writable' that`),{readable:o,writable:l}}class mt{constructor(i={},o={}){i===void 0?i=null:Zo(i,"First parameter");let l=An(o,"Second parameter"),d=Uf(i,"First parameter");if(qi(this),d.type==="bytes"){if(l.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let h=Cr(l,0);Kd(this,d,h)}else{let h=qn(l),_=Cr(l,1);xf(this,d,_,h)}}get locked(){if(!pt(this))throw kt("locked");return _t(this)}cancel(i=void 0){return pt(this)?_t(this)?p(new TypeError("Cannot cancel a stream that already has a reader")):xe(this,i):p(kt("cancel"))}getReader(i=void 0){if(!pt(this))throw kt("getReader");return Vf(i,"First parameter").mode===void 0?Gt(this):Su(this)}pipeThrough(i,o={}){if(!pt(this))throw kt("pipeThrough");nt(i,1,"pipeThrough");let l=Xf(i,"First parameter"),d=Hu(o,"Second parameter");if(_t(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(er(l.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let h=$u(this,l.writable,d.preventClose,d.preventAbort,d.preventCancel,d.signal);return ie(h),l.readable}pipeTo(i,o={}){if(!pt(this))return p(kt("pipeTo"));if(i===void 0)return p("Parameter 1 is required in 'pipeTo'.");if(!Zt(i))return p(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let l;try{l=Hu(o,"Second parameter")}catch(d){return p(d)}return _t(this)?p(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):er(i)?p(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):$u(this,i,l.preventClose,l.preventAbort,l.preventCancel,l.signal)}tee(){if(!pt(this))throw kt("tee");let i=Ff(this);return Pr(i)}values(i=void 0){if(!pt(this))throw kt("values");let o=Qf(i,"First parameter");return $d(this,o.preventCancel)}}Object.defineProperties(mt.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(mt.prototype,e.toStringTag,{value:"ReadableStream",configurable:!0}),typeof e.asyncIterator=="symbol"&&Object.defineProperty(mt.prototype,e.asyncIterator,{value:mt.prototype.values,writable:!0,configurable:!0});function Pi(n,i,o,l=1,d=()=>1){let h=Object.create(mt.prototype);qi(h);let _=Object.create(rr.prototype);return Vu(h,_,n,i,o,l,d),h}function Qu(n,i,o){let l=Object.create(mt.prototype);qi(l);let d=Object.create(Jt.prototype);return Tu(l,d,n,i,o,0,void 0),l}function qi(n){n._state="readable",n._reader=void 0,n._storedError=void 0,n._disturbed=!1}function pt(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_readableStreamController")?!1:n instanceof mt}function _t(n){return n._reader!==void 0}function xe(n,i){if(n._disturbed=!0,n._state==="closed")return g(void 0);if(n._state==="errored")return p(n._storedError);xr(n);let o=n._reader;o!==void 0&&Lt(o)&&(o._readIntoRequests.forEach(d=>{d._closeSteps(void 0)}),o._readIntoRequests=new Ee);let l=n._readableStreamController[Js](i);return se(l,t)}function xr(n){n._state="closed";let i=n._reader;i!==void 0&&(Xo(i),dt(i)&&(i._readRequests.forEach(o=>{o._closeSteps()}),i._readRequests=new Ee))}function Yu(n,i){n._state="errored",n._storedError=i;let o=n._reader;o!==void 0&&(Gs(o,i),dt(o)?(o._readRequests.forEach(l=>{l._errorSteps(i)}),o._readRequests=new Ee):(o._readIntoRequests.forEach(l=>{l._errorSteps(i)}),o._readIntoRequests=new Ee))}function kt(n){return new TypeError(`ReadableStream.prototype.${n} can only be used on a ReadableStream`)}function Xu(n,i){rt(n,i);let o=n?.highWaterMark;return ei(o,"highWaterMark","QueuingStrategyInit"),{highWaterMark:ti(o)}}let Ku=n=>n.byteLength;Object.defineProperty(Ku,"name",{value:"size",configurable:!0});class Bn{constructor(i){nt(i,1,"ByteLengthQueuingStrategy"),i=Xu(i,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=i.highWaterMark}get highWaterMark(){if(!Ju(this))throw Gu("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!Ju(this))throw Gu("size");return Ku}}Object.defineProperties(Bn.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(Bn.prototype,e.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function Gu(n){return new TypeError(`ByteLengthQueuingStrategy.prototype.${n} can only be used on a ByteLengthQueuingStrategy`)}function Ju(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_byteLengthQueuingStrategyHighWaterMark")?!1:n instanceof Bn}let Zu=()=>1;Object.defineProperty(Zu,"name",{value:"size",configurable:!0});class Un{constructor(i){nt(i,1,"CountQueuingStrategy"),i=Xu(i,"First parameter"),this._countQueuingStrategyHighWaterMark=i.highWaterMark}get highWaterMark(){if(!tl(this))throw el("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!tl(this))throw el("size");return Zu}}Object.defineProperties(Un.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(Un.prototype,e.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function el(n){return new TypeError(`CountQueuingStrategy.prototype.${n} can only be used on a CountQueuingStrategy`)}function tl(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_countQueuingStrategyHighWaterMark")?!1:n instanceof Un}function Kf(n,i){rt(n,i);let o=n?.flush,l=n?.readableType,d=n?.start,h=n?.transform,_=n?.writableType;return{flush:o===void 0?void 0:Gf(o,n,`${i} has member 'flush' that`),readableType:l,start:d===void 0?void 0:Jf(d,n,`${i} has member 'start' that`),transform:h===void 0?void 0:Zf(h,n,`${i} has member 'transform' that`),writableType:_}}function Gf(n,i,o){return Oe(n,o),l=>ke(n,i,[l])}function Jf(n,i,o){return Oe(n,o),l=>N(n,i,[l])}function Zf(n,i,o){return Oe(n,o),(l,d)=>ke(n,i,[l,d])}class Wn{constructor(i={},o={},l={}){i===void 0&&(i=null);let d=An(o,"Second parameter"),h=An(l,"Third parameter"),_=Kf(i,"First parameter");if(_.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(_.writableType!==void 0)throw new RangeError("Invalid writableType specified");let y=Cr(h,0),v=qn(h),I=Cr(d,1),B=qn(d),F,V=T(gt=>{F=gt});eh(this,V,I,B,y,v),rh(this,_),_.start!==void 0?F(_.start(this._transformStreamController)):F(void 0)}get readable(){if(!rl(this))throw al("readable");return this._readable}get writable(){if(!rl(this))throw al("writable");return this._writable}}Object.defineProperties(Wn.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(Wn.prototype,e.toStringTag,{value:"TransformStream",configurable:!0});function eh(n,i,o,l,d,h){function _(){return i}function y(V){return ih(n,V)}function v(V){return ah(n,V)}function I(){return oh(n)}n._writable=lf(_,y,I,v,o,l);function B(){return uh(n)}function F(V){return $n(n,V),g(void 0)}n._readable=Pi(_,B,F,d,h),n._backpressure=void 0,n._backpressureChangePromise=void 0,n._backpressureChangePromise_resolve=void 0,Nn(n,!0),n._transformStreamController=void 0}function rl(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_transformStreamController")?!1:n instanceof Wn}function zn(n,i){ht(n._readable._readableStreamController,i),$n(n,i)}function $n(n,i){nl(n._transformStreamController),wi(n._writable._writableStreamController,i),n._backpressure&&Nn(n,!1)}function Nn(n,i){n._backpressureChangePromise!==void 0&&n._backpressureChangePromise_resolve(),n._backpressureChangePromise=T(o=>{n._backpressureChangePromise_resolve=o}),n._backpressure=i}class Fr{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Vn(this))throw Hn("desiredSize");let i=this._controlledTransformStream._readable._readableStreamController;return Ri(i)}enqueue(i=void 0){if(!Vn(this))throw Hn("enqueue");sl(this,i)}error(i=void 0){if(!Vn(this))throw Hn("error");nh(this,i)}terminate(){if(!Vn(this))throw Hn("terminate");sh(this)}}Object.defineProperties(Fr.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(Fr.prototype,e.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function Vn(n){return!u(n)||!Object.prototype.hasOwnProperty.call(n,"_controlledTransformStream")?!1:n instanceof Fr}function th(n,i,o,l){i._controlledTransformStream=n,n._transformStreamController=i,i._transformAlgorithm=o,i._flushAlgorithm=l}function rh(n,i){let o=Object.create(Fr.prototype),l=h=>{try{return sl(o,h),g(void 0)}catch(_){return p(_)}},d=()=>g(void 0);i.transform!==void 0&&(l=h=>i.transform(h,o)),i.flush!==void 0&&(d=()=>i.flush(o)),th(n,o,l,d)}function nl(n){n._transformAlgorithm=void 0,n._flushAlgorithm=void 0}function sl(n,i){let o=n._controlledTransformStream,l=o._readable._readableStreamController;if(!nr(l))throw new TypeError("Readable side is not in a state that permits enqueue");try{Fn(l,i)}catch(h){throw $n(o,h),o._readable._storedError}Mf(l)!==o._backpressure&&Nn(o,!0)}function nh(n,i){zn(n._controlledTransformStream,i)}function il(n,i){let o=n._transformAlgorithm(i);return se(o,void 0,l=>{throw zn(n._controlledTransformStream,l),l})}function sh(n){let i=n._controlledTransformStream,o=i._readable._readableStreamController;Mr(o);let l=new TypeError("TransformStream terminated");$n(i,l)}function ih(n,i){let o=n._transformStreamController;if(n._backpressure){let l=n._backpressureChangePromise;return se(l,()=>{let d=n._writable;if(d._state==="erroring")throw d._storedError;return il(o,i)})}return il(o,i)}function ah(n,i){return zn(n,i),g(void 0)}function oh(n){let i=n._readable,o=n._transformStreamController,l=o._flushAlgorithm();return nl(o),se(l,()=>{if(i._state==="errored")throw i._storedError;Mr(i._readableStreamController)},d=>{throw zn(n,d),i._storedError})}function uh(n){return Nn(n,!1),n._backpressureChangePromise}function Hn(n){return new TypeError(`TransformStreamDefaultController.prototype.${n} can only be used on a TransformStreamDefaultController`)}function al(n){return new TypeError(`TransformStream.prototype.${n} can only be used on a TransformStream`)}r.ByteLengthQueuingStrategy=Bn,r.CountQueuingStrategy=Un,r.ReadableByteStreamController=Jt,r.ReadableStream=mt,r.ReadableStreamBYOBReader=Lr,r.ReadableStreamBYOBRequest=qr,r.ReadableStreamDefaultController=rr,r.ReadableStreamDefaultReader=vr,r.TransformStream=Wn,r.TransformStreamDefaultController=Fr,r.WritableStream=Ir,r.WritableStreamDefaultController=tr,r.WritableStreamDefaultWriter=kr,Object.defineProperty(r,"__esModule",{value:!0})})});var hl=w(()=>{if(!globalThis.ReadableStream)try{Object.assign(globalThis,require("stream/web"))}catch{Object.assign(globalThis,fl())}try{let{Blob:r}=require("buffer");r&&!r.prototype.stream&&(r.prototype.stream=function(t){let s=0,a=this;return new ReadableStream({type:"bytes",async pull(u){let f=await a.slice(s,Math.min(a.size,s+65536)).arrayBuffer();s+=f.byteLength,u.enqueue(new Uint8Array(f)),s===a.size&&u.close()}})})}catch{}});var Be=w(Ae=>{"use strict";Object.defineProperty(Ae,"__esModule",{value:!0});Ae.API_V1_1_STREAM_PREFIX=Ae.API_V1_1_UPLOAD_PREFIX=Ae.API_V1_1_PREFIX=Ae.API_V2_LABS_PREFIX=Ae.API_V2_PREFIX=void 0;Ae.API_V2_PREFIX="https://api.twitter.com/2/";Ae.API_V2_LABS_PREFIX="https://api.twitter.com/labs/2/";Ae.API_V1_1_PREFIX="https://api.twitter.com/1.1/";Ae.API_V1_1_UPLOAD_PREFIX="https://upload.twitter.com/1.1/";Ae.API_V1_1_STREAM_PREFIX="https://stream.twitter.com/1.1/"});var or=w(Mt=>{"use strict";Object.defineProperty(Mt,"__esModule",{value:!0});Mt.PreviousableTwitterPaginator=Mt.TwitterPaginator=void 0;var Nr=class{constructor({realData:e,rateLimit:t,instance:s,queryParams:a,sharedParams:u}){this._maxResultsWhenFetchLast=100,this._realData=e,this._rateLimit=t,this._instance=s,this._queryParams=a,this._sharedParams=u}get _isRateLimitOk(){return!this._rateLimit||this._rateLimit.reset*1e3<Date.now()?!0:this._rateLimit.remaining>0}makeRequest(e){return this._instance.get(this.getEndpoint(),e,{fullResponse:!0,params:this._sharedParams})}makeNewInstanceFromResult(e,t){return new this.constructor({realData:e.data,rateLimit:e.rateLimit,instance:this._instance,queryParams:t,sharedParams:this._sharedParams})}getEndpoint(){return this._endpoint}injectQueryParams(e){return{...e?{max_results:e}:{},...this._queryParams}}async next(e){let t=this.getNextQueryParams(e),s=await this.makeRequest(t);return this.makeNewInstanceFromResult(s,t)}async fetchNext(e){let t=this.getNextQueryParams(e),s=await this.makeRequest(t);return await this.refreshInstanceFromResult(s,!0),this}async fetchLast(e=1/0){let t=this.getNextQueryParams(this._maxResultsWhenFetchLast),s=0;for(;s<e&&this._isRateLimitOk;){let a=await this.makeRequest(t);if(await this.refreshInstanceFromResult(a,!0),s+=this.getPageLengthFromRequest(a),this.isFetchLastOver(a))break;t=this.getNextQueryParams(this._maxResultsWhenFetchLast)}return this}get rateLimit(){var e;return{...(e=this._rateLimit)!==null&&e!==void 0?e:{}}}get data(){return this._realData}get done(){return!this.canFetchNextPage(this._realData)}*[Symbol.iterator](){yield*this.getItemArray()}async*[Symbol.asyncIterator](){yield*this.getItemArray();let e=this,t=this.canFetchNextPage(this._realData);for(;t&&this._isRateLimitOk&&e.getItemArray().length>0;){let s=await e.next(this._maxResultsWhenFetchLast);this.refreshInstanceFromResult({data:s._realData,headers:{},rateLimit:s._rateLimit},!0),t=this.canFetchNextPage(s._realData),yield*s.getItemArray(),e=s}}async*fetchAndIterate(){for(let s of this.getItemArray())yield[s,this];let e=this,t=this.canFetchNextPage(this._realData);for(;t&&this._isRateLimitOk&&e.getItemArray().length>0;){let s=await e.next(this._maxResultsWhenFetchLast);this.refreshInstanceFromResult({data:s._realData,headers:{},rateLimit:s._rateLimit},!0),t=this.canFetchNextPage(s._realData);for(let a of s.getItemArray())yield[a,s];this._rateLimit=s._rateLimit,e=s}}};Mt.TwitterPaginator=Nr;var ji=class extends Nr{async previous(e){let t=this.getPreviousQueryParams(e),s=await this.makeRequest(t);return this.makeNewInstanceFromResult(s,t)}async fetchPrevious(e){let t=this.getPreviousQueryParams(e),s=await this.makeRequest(t);return await this.refreshInstanceFromResult(s,!1),this}};Mt.PreviousableTwitterPaginator=ji;Mt.default=Nr});var xt=w(ur=>{"use strict";var Ph=ur&&ur.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ur,"__esModule",{value:!0});ur.CursoredV1Paginator=void 0;var qh=Ph(or()),Bi=class extends qh.default{getNextQueryParams(e){var t;return{...this._queryParams,cursor:(t=this._realData.next_cursor_str)!==null&&t!==void 0?t:this._realData.next_cursor,...e?{count:e}:{}}}isFetchLastOver(e){return!this.canFetchNextPage(e.data)}canFetchNextPage(e){return!this.isNextCursorInvalid(e.next_cursor)||!this.isNextCursorInvalid(e.next_cursor_str)}isNextCursorInvalid(e){return e===void 0||e===0||e===-1||e==="0"||e==="-1"}};ur.CursoredV1Paginator=Bi});var zi=w(lr=>{"use strict";Object.defineProperty(lr,"__esModule",{value:!0});lr.WelcomeDmV1Paginator=lr.DmEventsV1Paginator=void 0;var Bl=xt(),Ui=class extends Bl.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="direct_messages/events/list.json"}refreshInstanceFromResult(e,t){let s=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.events.push(...s.events),this._realData.next_cursor=s.next_cursor)}getPageLengthFromRequest(e){return e.data.events.length}getItemArray(){return this.events}get events(){return this._realData.events}};lr.DmEventsV1Paginator=Ui;var Wi=class extends Bl.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="direct_messages/welcome_messages/list.json"}refreshInstanceFromResult(e,t){let s=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.welcome_messages.push(...s.welcome_messages),this._realData.next_cursor=s.next_cursor)}getPageLengthFromRequest(e){return e.data.welcome_messages.length}getItemArray(){return this.welcomeMessages}get welcomeMessages(){return this._realData.welcome_messages}};lr.WelcomeDmV1Paginator=Wi});var Wl=w(Ul=>{"use strict";Object.defineProperty(Ul,"__esModule",{value:!0})});var zl=w(Vr=>{"use strict";Object.defineProperty(Vr,"__esModule",{value:!0});Vr.EUploadMimeType=void 0;var Ah;(function(r){r.Jpeg="image/jpeg",r.Mp4="video/mp4",r.Mov="video/quicktime",r.Gif="image/gif",r.Png="image/png",r.Srt="text/plain",r.Webp="image/webp"})(Ah=Vr.EUploadMimeType||(Vr.EUploadMimeType={}))});var Nl=w($l=>{"use strict";Object.defineProperty($l,"__esModule",{value:!0})});var Hl=w(Vl=>{"use strict";Object.defineProperty(Vl,"__esModule",{value:!0})});var Yl=w(Ql=>{"use strict";Object.defineProperty(Ql,"__esModule",{value:!0})});var Kl=w(Xl=>{"use strict";Object.defineProperty(Xl,"__esModule",{value:!0})});var Jl=w(Gl=>{"use strict";Object.defineProperty(Gl,"__esModule",{value:!0})});var Zl=w(Hr=>{"use strict";Object.defineProperty(Hr,"__esModule",{value:!0});Hr.EDirectMessageEventTypeV1=void 0;var Dh;(function(r){r.Create="message_create",r.WelcomeCreate="welcome_message"})(Dh=Hr.EDirectMessageEventTypeV1||(Hr.EDirectMessageEventTypeV1={}))});var tc=w(ec=>{"use strict";Object.defineProperty(ec,"__esModule",{value:!0})});var rc=w(oe=>{"use strict";var Lh=oe&&oe.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,a)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),ot=oe&&oe.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Lh(e,r,t)};Object.defineProperty(oe,"__esModule",{value:!0});ot(Wl(),oe);ot(zl(),oe);ot(Nl(),oe);ot(Hl(),oe);ot(Yl(),oe);ot(Kl(),oe);ot(Jl(),oe);ot(Zl(),oe);ot(tc(),oe)});var sc=w(nc=>{"use strict";Object.defineProperty(nc,"__esModule",{value:!0})});var ac=w(ic=>{"use strict";Object.defineProperty(ic,"__esModule",{value:!0})});var uc=w(oc=>{"use strict";Object.defineProperty(oc,"__esModule",{value:!0})});var cc=w(lc=>{"use strict";Object.defineProperty(lc,"__esModule",{value:!0})});var fc=w(dc=>{"use strict";Object.defineProperty(dc,"__esModule",{value:!0})});var mc=w(hc=>{"use strict";Object.defineProperty(hc,"__esModule",{value:!0})});var pc=w(De=>{"use strict";var Ch=De&&De.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,a)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),cr=De&&De.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Ch(e,r,t)};Object.defineProperty(De,"__esModule",{value:!0});cr(sc(),De);cr(ac(),De);cr(uc(),De);cr(cc(),De);cr(fc(),De);cr(mc(),De)});var _c=w(Z=>{"use strict";Object.defineProperty(Z,"__esModule",{value:!0});Z.EApiV2ErrorCode=Z.EApiV1ErrorCode=Z.ApiResponseError=Z.ApiPartialResponseError=Z.ApiRequestError=Z.ETwitterApiError=void 0;var is;(function(r){r.Request="request",r.PartialResponse="partial-response",r.Response="response"})(is=Z.ETwitterApiError||(Z.ETwitterApiError={}));var Qr=class extends Error{constructor(){super(...arguments),this.error=!0}},$i=class extends Qr{constructor(e,t){super(e),this.type=is.Request,Error.captureStackTrace(this,this.constructor),Object.defineProperty(this,"_options",{value:t})}get request(){return this._options.request}get requestError(){return this._options.requestError}toJSON(){return{type:this.type,error:this.requestError}}};Z.ApiRequestError=$i;var Ni=class extends Qr{constructor(e,t){super(e),this.type=is.PartialResponse,Error.captureStackTrace(this,this.constructor),Object.defineProperty(this,"_options",{value:t})}get request(){return this._options.request}get response(){return this._options.response}get responseError(){return this._options.responseError}get rawContent(){return this._options.rawContent}toJSON(){return{type:this.type,error:this.responseError}}};Z.ApiPartialResponseError=Ni;var Vi=class extends Qr{constructor(e,t){if(super(e),this.type=is.Response,Error.captureStackTrace(this,this.constructor),Object.defineProperty(this,"_options",{value:t}),this.code=t.code,this.headers=t.headers,this.rateLimit=t.rateLimit,t.data&&typeof t.data=="object"&&"error"in t.data&&!t.data.errors){let s={...t.data};s.errors=[{code:dr.InternalError,message:s.error}],this.data=s}else this.data=t.data}get request(){return this._options.request}get response(){return this._options.response}hasErrorCode(...e){let t=this.errors;if(!t?.length)return!1;if("code"in t[0])return t.some(u=>e.includes(u.code));let s=this.data;return e.includes(s.type)}get errors(){var e;return(e=this.data)===null||e===void 0?void 0:e.errors}get rateLimitError(){return this.code===420||this.code===429}get isAuthError(){return this.code===401?!0:this.hasErrorCode(dr.AuthTimestampInvalid,dr.AuthenticationFail,dr.BadAuthenticationData,dr.InvalidOrExpiredToken)}toJSON(){return{type:this.type,code:this.code,error:this.data,rateLimit:this.rateLimit,headers:this.headers}}};Z.ApiResponseError=Vi;var dr;(function(r){r[r.InvalidCoordinates=3]="InvalidCoordinates",r[r.NoLocationFound=13]="NoLocationFound",r[r.AuthenticationFail=32]="AuthenticationFail",r[r.InvalidOrExpiredToken=89]="InvalidOrExpiredToken",r[r.UnableToVerifyCredentials=99]="UnableToVerifyCredentials",r[r.AuthTimestampInvalid=135]="AuthTimestampInvalid",r[r.BadAuthenticationData=215]="BadAuthenticationData",r[r.NoUserMatch=17]="NoUserMatch",r[r.UserNotFound=50]="UserNotFound",r[r.ResourceNotFound=34]="ResourceNotFound",r[r.TweetNotFound=144]="TweetNotFound",r[r.TweetNotVisible=179]="TweetNotVisible",r[r.NotAllowedResource=220]="NotAllowedResource",r[r.MediaIdNotFound=325]="MediaIdNotFound",r[r.TweetNoLongerAvailable=421]="TweetNoLongerAvailable",r[r.TweetViolatedRules=422]="TweetViolatedRules",r[r.TargetUserSuspended=63]="TargetUserSuspended",r[r.YouAreSuspended=64]="YouAreSuspended",r[r.AccountUpdateFailed=120]="AccountUpdateFailed",r[r.NoSelfSpamReport=36]="NoSelfSpamReport",r[r.NoSelfMute=271]="NoSelfMute",r[r.AccountLocked=326]="AccountLocked",r[r.RateLimitExceeded=88]="RateLimitExceeded",r[r.NoDMRightForApp=93]="NoDMRightForApp",r[r.OverCapacity=130]="OverCapacity",r[r.InternalError=131]="InternalError",r[r.TooManyFollowings=161]="TooManyFollowings",r[r.TweetLimitExceeded=185]="TweetLimitExceeded",r[r.DuplicatedTweet=187]="DuplicatedTweet",r[r.TooManySpamReports=205]="TooManySpamReports",r[r.RequestLooksLikeSpam=226]="RequestLooksLikeSpam",r[r.NoWriteRightForApp=261]="NoWriteRightForApp",r[r.TweetActionsDisabled=425]="TweetActionsDisabled",r[r.TweetRepliesRestricted=433]="TweetRepliesRestricted",r[r.NamedParameterMissing=38]="NamedParameterMissing",r[r.InvalidAttachmentUrl=44]="InvalidAttachmentUrl",r[r.TweetTextTooLong=186]="TweetTextTooLong",r[r.MissingUrlParameter=195]="MissingUrlParameter",r[r.NoMultipleGifs=323]="NoMultipleGifs",r[r.InvalidMediaIds=324]="InvalidMediaIds",r[r.InvalidUrl=407]="InvalidUrl",r[r.TooManyTweetAttachments=386]="TooManyTweetAttachments",r[r.StatusAlreadyFavorited=139]="StatusAlreadyFavorited",r[r.FollowRequestAlreadySent=160]="FollowRequestAlreadySent",r[r.CannotUnmuteANonMutedAccount=272]="CannotUnmuteANonMutedAccount",r[r.TweetAlreadyRetweeted=327]="TweetAlreadyRetweeted",r[r.ReplyToDeletedTweet=385]="ReplyToDeletedTweet",r[r.DMReceiverNotFollowingYou=150]="DMReceiverNotFollowingYou",r[r.UnableToSendDM=151]="UnableToSendDM",r[r.MustAllowDMFromAnyone=214]="MustAllowDMFromAnyone",r[r.CannotSendDMToThisUser=349]="CannotSendDMToThisUser",r[r.DMTextTooLong=354]="DMTextTooLong",r[r.SubscriptionAlreadyExists=355]="SubscriptionAlreadyExists",r[r.CallbackUrlNotApproved=415]="CallbackUrlNotApproved",r[r.SuspendedApplication=416]="SuspendedApplication",r[r.OobOauthIsNotAllowed=417]="OobOauthIsNotAllowed"})(dr=Z.EApiV1ErrorCode||(Z.EApiV1ErrorCode={}));var Ih;(function(r){r.InvalidRequest="https://api.twitter.com/2/problems/invalid-request",r.ClientForbidden="https://api.twitter.com/2/problems/client-forbidden",r.UnsupportedAuthentication="https://api.twitter.com/2/problems/unsupported-authentication",r.InvalidRules="https://api.twitter.com/2/problems/invalid-rules",r.TooManyRules="https://api.twitter.com/2/problems/rule-cap",r.DuplicatedRules="https://api.twitter.com/2/problems/duplicate-rules",r.RateLimitExceeded="https://api.twitter.com/2/problems/usage-capped",r.ConnectionError="https://api.twitter.com/2/problems/streaming-connection",r.ClientDisconnected="https://api.twitter.com/2/problems/client-disconnected",r.TwitterDisconnectedYou="https://api.twitter.com/2/problems/operational-disconnect",r.ResourceNotFound="https://api.twitter.com/2/problems/resource-not-found",r.ResourceUnauthorized="https://api.twitter.com/2/problems/not-authorized-for-resource",r.DisallowedResource="https://api.twitter.com/2/problems/disallowed-resource"})(Ih=Z.EApiV2ErrorCode||(Z.EApiV2ErrorCode={}))});var wc=w(gc=>{"use strict";Object.defineProperty(gc,"__esModule",{value:!0})});var yc=w(Yr=>{"use strict";Object.defineProperty(Yr,"__esModule",{value:!0});Yr.ETwitterStreamEvent=void 0;var kh;(function(r){r.Connected="connected",r.ConnectError="connect error",r.ConnectionError="connection error",r.ConnectionClosed="connection closed",r.ConnectionLost="connection lost",r.ReconnectAttempt="reconnect attempt",r.Reconnected="reconnected",r.ReconnectError="reconnect error",r.ReconnectLimitExceeded="reconnect limit exceeded",r.DataKeepAlive="data keep-alive",r.Data="data event content",r.DataError="data twitter error",r.TweetParseError="data tweet parse error",r.Error="stream error"})(kh=Yr.ETwitterStreamEvent||(Yr.ETwitterStreamEvent={}))});var Tc=w(bc=>{"use strict";Object.defineProperty(bc,"__esModule",{value:!0})});var Sc=w(as=>{"use strict";Object.defineProperty(as,"__esModule",{value:!0});as.TwitterApiPluginResponseOverride=void 0;var Hi=class{constructor(e){this.value=e}};as.TwitterApiPluginResponseOverride=Hi});var vc=w(Ft=>{"use strict";var Eh=Ft&&Ft.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,a)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),Oh=Ft&&Ft.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Eh(e,r,t)};Object.defineProperty(Ft,"__esModule",{value:!0});Oh(Sc(),Ft)});var Ye=w(Te=>{"use strict";var Mh=Te&&Te.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,a)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),jt=Te&&Te.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Mh(e,r,t)};Object.defineProperty(Te,"__esModule",{value:!0});jt(rc(),Te);jt(pc(),Te);jt(_c(),Te);jt(wc(),Te);jt(yc(),Te);jt(Tc(),Te);jt(vc(),Te)});var us=w(os=>{"use strict";Object.defineProperty(os,"__esModule",{value:!0});os.TwitterApiV2Settings=void 0;os.TwitterApiV2Settings={debug:!1,deprecationWarnings:!0,logger:{log:console.log.bind(console)}}});var Tt=w(me=>{"use strict";Object.defineProperty(me,"__esModule",{value:!0});me.safeDeprecationWarning=me.hasMultipleItems=me.isTweetStreamV2ErrorPayload=me.trimUndefinedProperties=me.arrayWrap=me.sharedPromise=void 0;var xh=us();function Fh(r){let e={value:void 0,promise:r().then(t=>(e.value=t,t))};return e}me.sharedPromise=Fh;function jh(r){return Array.isArray(r)?r:[r]}me.arrayWrap=jh;function Bh(r){for(let e in r)r[e]===void 0&&delete r[e]}me.trimUndefinedProperties=Bh;function Uh(r){return typeof r=="object"&&"errors"in r&&!("data"in r)}me.isTweetStreamV2ErrorPayload=Uh;function Wh(r){return Array.isArray(r)&&r.length>1?!0:r.toString().includes(",")}me.hasMultipleItems=Wh;var Rc=new Set;function zh(r){if(typeof console>"u"||!console.warn||!xh.TwitterApiV2Settings.deprecationWarnings)return;let e=`${r.instance}-${r.method}-${r.problem}`;if(Rc.has(e))return;let t=`[twitter-api-v2] Deprecation warning: In ${r.instance}.${r.method}() call, ${r.problem}.
${r.resolution}.`;console.warn(t),console.warn("To disable this message, import variable TwitterApiV2Settings from twitter-api-v2 and set TwitterApiV2Settings.deprecationWarnings to false."),Rc.add(e)}me.safeDeprecationWarning=zh});var Yi=w(Se=>{"use strict";var $h=Se&&Se.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,a)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),Nh=Se&&Se.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Vh=Se&&Se.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&$h(e,r,t);return Nh(e,r),e},Hh=Se&&Se.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Se,"__esModule",{value:!0});Se.RequestHandlerHelper=void 0;var Qh=require("https"),pe=us(),Yh=Hh(cs()),Qi=Ye(),ut=Vh(require("zlib")),Xh=require("events"),ls=class{constructor(e){this.requestData=e,this.requestErrorHandled=!1,this.responseData=[]}get hrefPathname(){let e=this.requestData.url;return e.hostname+e.pathname}isCompressionDisabled(){return!this.requestData.compression||this.requestData.compression==="identity"}isFormEncodedEndpoint(){return this.requestData.url.href.startsWith("https://api.twitter.com/oauth/")}createRequestError(e){return pe.TwitterApiV2Settings.debug&&pe.TwitterApiV2Settings.logger.log("Request error:",e),new Qi.ApiRequestError("Request failed.",{request:this.req,error:e})}createPartialResponseError(e,t){let a=`Request failed with partial response with HTTP code ${this.res.statusCode}`;return t?a+=" (connection abruptly closed)":a+=" (parse error)",new Qi.ApiPartialResponseError(a,{request:this.req,response:this.res,responseError:e,rawContent:Buffer.concat(this.responseData).toString()})}formatV1Errors(e){return e.map(({code:t,message:s})=>`${s} (Twitter code ${t})`).join(", ")}formatV2Error(e){return`${e.title}: ${e.detail} (see ${e.type})`}createResponseError({res:e,data:t,rateLimit:s,code:a}){var u;pe.TwitterApiV2Settings.debug&&(pe.TwitterApiV2Settings.logger.log(`Request failed with code ${a}, data:`,t),pe.TwitterApiV2Settings.logger.log("Response headers:",e.headers));let c=`Request failed with code ${a}`;if(!((u=t?.errors)===null||u===void 0)&&u.length){let f=t.errors;"code"in f[0]?c+=" - "+this.formatV1Errors(f):c+=" - "+this.formatV2Error(t)}return new Qi.ApiResponseError(c,{code:a,data:t,headers:e.headers,request:this.req,response:e,rateLimit:s})}getResponseDataStream(e){if(this.isCompressionDisabled())return e;let t=(e.headers["content-encoding"]||"identity").trim().toLowerCase();if(t==="br"){let s=ut.createBrotliDecompress({flush:ut.constants.BROTLI_OPERATION_FLUSH,finishFlush:ut.constants.BROTLI_OPERATION_FLUSH});return e.pipe(s),s}if(t==="gzip"){let s=ut.createGunzip({flush:ut.constants.Z_SYNC_FLUSH,finishFlush:ut.constants.Z_SYNC_FLUSH});return e.pipe(s),s}if(t==="deflate"){let s=ut.createInflate({flush:ut.constants.Z_SYNC_FLUSH,finishFlush:ut.constants.Z_SYNC_FLUSH});return e.pipe(s),s}return e}detectResponseType(e){var t,s;return!((t=e.headers["content-type"])===null||t===void 0)&&t.includes("application/json")||!((s=e.headers["content-type"])===null||s===void 0)&&s.includes("application/problem+json")?"json":this.isFormEncodedEndpoint()?"url":"text"}getParsedResponse(e){let t=this.responseData,s=this.requestData.forceParseMode||this.detectResponseType(e);if(s==="buffer")return Buffer.concat(t);if(s==="text")return Buffer.concat(t).toString();if(s==="json"){let a=Buffer.concat(t).toString();return a.length?JSON.parse(a):void 0}else if(s==="url"){let a=Buffer.concat(t).toString(),u={};for(let[c,f]of new URLSearchParams(a))u[c]=f;return u}else return}getRateLimitFromResponse(e){let t;return e.headers["x-rate-limit-limit"]&&(t={limit:Number(e.headers["x-rate-limit-limit"]),remaining:Number(e.headers["x-rate-limit-remaining"]),reset:Number(e.headers["x-rate-limit-reset"])},e.headers["x-app-limit-24hour-limit"]&&(t.day={limit:Number(e.headers["x-app-limit-24hour-limit"]),remaining:Number(e.headers["x-app-limit-24hour-remaining"]),reset:Number(e.headers["x-app-limit-24hour-reset"])}),this.requestData.rateLimitSaver&&this.requestData.rateLimitSaver(t)),t}onSocketEventHandler(e,t,s){let a=this.onSocketCloseHandler.bind(this,e);s.on("close",a),t.on("complete",()=>s.off("close",a))}onSocketCloseHandler(e){if(this.req.removeAllListeners("timeout"),!this.res&&!this.requestErrorHandled)return e(this.createRequestError(new Error("Socket closed without any information.")))}requestErrorHandler(e,t){var s,a;(a=(s=this.requestData).requestEventDebugHandler)===null||a===void 0||a.call(s,"request-error",{requestError:t}),this.requestErrorHandled=!0,e(this.createRequestError(t))}timeoutErrorHandler(){this.requestErrorHandled=!0,this.req.destroy(new Error("Request timeout."))}classicResponseHandler(e,t,s){this.res=s;let a=this.getResponseDataStream(s);a.on("data",u=>this.responseData.push(u)),a.on("end",this.onResponseEndHandler.bind(this,e,t)),a.on("close",this.onResponseCloseHandler.bind(this,e,t)),this.requestData.requestEventDebugHandler&&(this.requestData.requestEventDebugHandler("response",{res:s}),s.on("aborted",u=>this.requestData.requestEventDebugHandler("response-aborted",{error:u})),s.on("error",u=>this.requestData.requestEventDebugHandler("response-error",{error:u})),s.on("close",()=>this.requestData.requestEventDebugHandler("response-close",{data:this.responseData})),s.on("end",()=>this.requestData.requestEventDebugHandler("response-end")))}onResponseEndHandler(e,t){let s=this.getRateLimitFromResponse(this.res),a;try{a=this.getParsedResponse(this.res)}catch(c){t(this.createPartialResponseError(c,!1));return}let u=this.res.statusCode;if(u>=400){t(this.createResponseError({data:a,res:this.res,rateLimit:s,code:u}));return}pe.TwitterApiV2Settings.debug&&(pe.TwitterApiV2Settings.logger.log(`[${this.requestData.options.method} ${this.hrefPathname}]: Request succeeds with code ${this.res.statusCode}`),pe.TwitterApiV2Settings.logger.log("Response body:",a)),e({data:a,headers:this.res.headers,rateLimit:s})}onResponseCloseHandler(e,t){let s=this.res;if(s.aborted)try{return this.getParsedResponse(this.res),this.onResponseEndHandler(e,t)}catch(a){return t(this.createPartialResponseError(a,!0))}if(!s.complete)return t(this.createPartialResponseError(new Error("Response has been interrupted before response could be parsed."),!0))}streamResponseHandler(e,t,s){if(s.statusCode<400){pe.TwitterApiV2Settings.debug&&pe.TwitterApiV2Settings.logger.log(`[${this.requestData.options.method} ${this.hrefPathname}]: Request succeeds with code ${s.statusCode} (starting stream)`);let u=this.getResponseDataStream(s);e({req:this.req,res:u,originalResponse:s,requestData:this.requestData})}else this.classicResponseHandler(()=>{},t,s)}debugRequest(){let e=this.requestData.url;pe.TwitterApiV2Settings.logger.log(`[${this.requestData.options.method} ${this.hrefPathname}]`,this.requestData.options),e.search&&pe.TwitterApiV2Settings.logger.log("Request parameters:",[...e.searchParams.entries()].map(([t,s])=>`${t}: ${s}`)),this.requestData.body&&pe.TwitterApiV2Settings.logger.log("Request body:",this.requestData.body)}buildRequest(){var e;let t=this.requestData.url,s=t.username?`${t.username}:${t.password}`:void 0,a=(e=this.requestData.options.headers)!==null&&e!==void 0?e:{};this.requestData.compression===!0||this.requestData.compression==="brotli"?a["accept-encoding"]="br;q=1.0, gzip;q=0.8, deflate;q=0.5, *;q=0.1":this.requestData.compression==="gzip"?a["accept-encoding"]="gzip;q=1, deflate;q=0.5, *;q=0.1":this.requestData.compression==="deflate"&&(a["accept-encoding"]="deflate;q=1, *;q=0.1"),pe.TwitterApiV2Settings.debug&&this.debugRequest(),this.req=(0,Qh.request)({...this.requestData.options,host:t.hostname,port:t.port||void 0,path:t.pathname+t.search,protocol:t.protocol,auth:s,headers:a})}registerRequestEventDebugHandlers(e){e.on("close",()=>this.requestData.requestEventDebugHandler("close")),e.on("abort",()=>this.requestData.requestEventDebugHandler("abort")),e.on("socket",t=>{this.requestData.requestEventDebugHandler("socket",{socket:t}),t.on("error",s=>this.requestData.requestEventDebugHandler("socket-error",{socket:t,error:s})),t.on("connect",()=>this.requestData.requestEventDebugHandler("socket-connect",{socket:t})),t.on("close",s=>this.requestData.requestEventDebugHandler("socket-close",{socket:t,withError:s})),t.on("end",()=>this.requestData.requestEventDebugHandler("socket-end",{socket:t})),t.on("lookup",(...s)=>this.requestData.requestEventDebugHandler("socket-lookup",{socket:t,data:s})),t.on("timeout",()=>this.requestData.requestEventDebugHandler("socket-timeout",{socket:t}))})}makeRequest(){return this.buildRequest(),new Promise((e,t)=>{let s=f=>{u.emit("complete"),e(f)},a=f=>{u.emit("complete"),t(f)},u=new Xh.EventEmitter,c=this.req;c.on("error",this.requestErrorHandler.bind(this,a)),c.on("socket",this.onSocketEventHandler.bind(this,a,u)),c.on("response",this.classicResponseHandler.bind(this,s,a)),this.requestData.options.timeout&&c.on("timeout",this.timeoutErrorHandler.bind(this)),this.requestData.requestEventDebugHandler&&this.registerRequestEventDebugHandlers(c),this.requestData.body&&c.write(this.requestData.body),c.end()})}async makeRequestAsStream(){let{req:e,res:t,requestData:s,originalResponse:a}=await this.makeRequestAndResolveWhenReady();return new Yh.default(s,{req:e,res:t,originalResponse:a})}makeRequestAndResolveWhenReady(){return this.buildRequest(),new Promise((e,t)=>{let s=this.req;s.on("error",this.requestErrorHandler.bind(this,t)),s.on("response",this.streamResponseHandler.bind(this,e,t)),this.requestData.body&&s.write(this.requestData.body),s.end()})}};Se.RequestHandlerHelper=ls;Se.default=ls});var Pc=w(Xr=>{"use strict";Object.defineProperty(Xr,"__esModule",{value:!0});Xr.TweetStreamEventCombiner=void 0;var Kh=require("events"),St=Ye(),ds=class extends Kh.EventEmitter{constructor(e){super(),this.stream=e,this.stack=[],this.onStreamData=this.onStreamData.bind(this),this.onStreamError=this.onStreamError.bind(this),this.onceNewEvent=this.once.bind(this,"event"),e.on(St.ETwitterStreamEvent.Data,this.onStreamData),e.on(St.ETwitterStreamEvent.ConnectionError,this.onStreamError),e.on(St.ETwitterStreamEvent.TweetParseError,this.onStreamError),e.on(St.ETwitterStreamEvent.ConnectionClosed,this.onStreamError)}nextEvent(){return new Promise(this.onceNewEvent)}hasStack(){return this.stack.length>0}popStack(){let e=this.stack;return this.stack=[],e}destroy(){this.removeAllListeners(),this.stream.off(St.ETwitterStreamEvent.Data,this.onStreamData),this.stream.off(St.ETwitterStreamEvent.ConnectionError,this.onStreamError),this.stream.off(St.ETwitterStreamEvent.TweetParseError,this.onStreamError),this.stream.off(St.ETwitterStreamEvent.ConnectionClosed,this.onStreamError)}emitEvent(e,t){this.emit("event",{type:e,payload:t})}onStreamError(e){this.emitEvent("error",e)}onStreamData(e){this.stack.push(e),this.emitEvent("data",e)}};Xr.TweetStreamEventCombiner=ds;Xr.default=ds});var qc=w(fr=>{"use strict";Object.defineProperty(fr,"__esModule",{value:!0});fr.EStreamParserEvent=void 0;var Gh=require("events"),Xi=class extends Gh.EventEmitter{constructor(){super(...arguments),this.currentMessage=""}push(e){this.currentMessage+=e,e=this.currentMessage;let t=e.length,s=0,a=0;for(;a<t;){if(e.slice(a,a+2)===`\r
`){let u=e.slice(s,a);if(s=a+=2,!u.length)continue;try{let c=JSON.parse(u);if(c){this.emit(Ki.ParsedData,c);continue}}catch(c){this.emit(Ki.ParseError,c)}}a++}this.currentMessage=e.slice(s,t)}reset(){this.currentMessage=""}};fr.default=Xi;var Ki;(function(r){r.ParsedData="parsed data",r.ParseError="parse error"})(Ki=fr.EStreamParserEvent||(fr.EStreamParserEvent={}))});var cs=w(ve=>{"use strict";var Jh=ve&&ve.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,a)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),Zh=ve&&ve.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),em=ve&&ve.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Jh(e,r,t);return Zh(e,r),e},Lc=ve&&ve.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ve,"__esModule",{value:!0});ve.TweetStream=void 0;var tm=require("events"),Ac=Lc(Yi()),M=Ye(),rm=Lc(Pc()),Gi=em(qc()),Dc=[5,15,30,60,90,120,180,300,600,900],nm=r=>r>Dc.length?901e3:Dc[r-1]*1e3,fs=class extends tm.EventEmitter{constructor(e,t){super(),this.requestData=e,this.autoReconnect=!1,this.autoReconnectRetries=5,this.keepAliveTimeoutMs=1e3*120,this.nextRetryTimeout=nm,this.parser=new Gi.default,this.connectionProcessRunning=!1,this.onKeepAliveTimeout=this.onKeepAliveTimeout.bind(this),this.initEventsFromParser(),t&&(this.req=t.req,this.res=t.res,this.originalResponse=t.originalResponse,this.initEventsFromRequest())}on(e,t){return super.on(e,t)}initEventsFromRequest(){if(!this.req||!this.res)throw new Error("TweetStream error: You cannot init TweetStream without a request and response object.");let e=t=>{this.emit(M.ETwitterStreamEvent.ConnectionError,t),this.emit(M.ETwitterStreamEvent.Error,{type:M.ETwitterStreamEvent.ConnectionError,error:t,message:"Connection lost or closed by Twitter."}),this.onConnectionError()};this.req.on("error",e),this.res.on("error",e),this.res.on("close",()=>e(new Error("Connection closed by Twitter."))),this.res.on("data",t=>{if(this.resetKeepAliveTimeout(),t.toString()===`\r
`)return this.emit(M.ETwitterStreamEvent.DataKeepAlive);this.parser.push(t.toString())}),this.resetKeepAliveTimeout()}initEventsFromParser(){let e=this.requestData.payloadIsError;this.parser.on(Gi.EStreamParserEvent.ParsedData,t=>{e&&e(t)?(this.emit(M.ETwitterStreamEvent.DataError,t),this.emit(M.ETwitterStreamEvent.Error,{type:M.ETwitterStreamEvent.DataError,error:t,message:"Twitter sent a payload that is detected as an error payload."})):this.emit(M.ETwitterStreamEvent.Data,t)}),this.parser.on(Gi.EStreamParserEvent.ParseError,t=>{this.emit(M.ETwitterStreamEvent.TweetParseError,t),this.emit(M.ETwitterStreamEvent.Error,{type:M.ETwitterStreamEvent.TweetParseError,error:t,message:"Failed to parse stream data."})})}resetKeepAliveTimeout(){this.unbindKeepAliveTimeout(),this.keepAliveTimeoutMs!==1/0&&(this.keepAliveTimeout=setTimeout(this.onKeepAliveTimeout,this.keepAliveTimeoutMs))}onKeepAliveTimeout(){this.emit(M.ETwitterStreamEvent.ConnectionLost),this.onConnectionError()}unbindTimeouts(){this.unbindRetryTimeout(),this.unbindKeepAliveTimeout()}unbindKeepAliveTimeout(){this.keepAliveTimeout&&(clearTimeout(this.keepAliveTimeout),this.keepAliveTimeout=void 0)}unbindRetryTimeout(){this.retryTimeout&&(clearTimeout(this.retryTimeout),this.retryTimeout=void 0)}closeWithoutEmit(){this.unbindTimeouts(),this.res&&(this.res.removeAllListeners(),this.res.destroy()),this.req&&(this.req.removeAllListeners(),this.req.destroy())}close(){this.emit(M.ETwitterStreamEvent.ConnectionClosed),this.closeWithoutEmit()}destroy(){this.removeAllListeners(),this.close()}async clone(){let t=await new Ac.default(this.requestData).makeRequestAsStream(),s=this.eventNames();for(let a of s){let u=this.listeners(a);for(let c of u)t.on(a,c)}return t}async connect(e={}){typeof e.autoReconnect<"u"&&(this.autoReconnect=e.autoReconnect),typeof e.autoReconnectRetries<"u"&&(this.autoReconnectRetries=e.autoReconnectRetries==="unlimited"?1/0:e.autoReconnectRetries),typeof e.keepAliveTimeout<"u"&&(this.keepAliveTimeoutMs=e.keepAliveTimeout==="disable"?1/0:e.keepAliveTimeout),typeof e.nextRetryTimeout<"u"&&(this.nextRetryTimeout=e.nextRetryTimeout),this.unbindTimeouts();try{await this.reconnect()}catch(t){if(this.emit(M.ETwitterStreamEvent.ConnectError,0),this.emit(M.ETwitterStreamEvent.Error,{type:M.ETwitterStreamEvent.ConnectError,error:t,message:"Connect error - Initial connection just failed."}),this.autoReconnect)this.makeAutoReconnectRetry(0,t);else throw t}return this}async reconnect(){if(this.connectionProcessRunning)throw new Error("Connection process is already running.");this.connectionProcessRunning=!0;try{let e=!0;this.req&&(e=!1,this.closeWithoutEmit());let{req:t,res:s,originalResponse:a}=await new Ac.default(this.requestData).makeRequestAndResolveWhenReady();this.req=t,this.res=s,this.originalResponse=a,this.emit(e?M.ETwitterStreamEvent.Connected:M.ETwitterStreamEvent.Reconnected),this.parser.reset(),this.initEventsFromRequest()}finally{this.connectionProcessRunning=!1}}async onConnectionError(e=0){if(this.unbindTimeouts(),this.closeWithoutEmit(),!this.autoReconnect){this.emit(M.ETwitterStreamEvent.ConnectionClosed);return}if(e>=this.autoReconnectRetries){this.emit(M.ETwitterStreamEvent.ReconnectLimitExceeded),this.emit(M.ETwitterStreamEvent.ConnectionClosed);return}try{this.emit(M.ETwitterStreamEvent.ReconnectAttempt,e),await this.reconnect()}catch(t){this.emit(M.ETwitterStreamEvent.ReconnectError,e),this.emit(M.ETwitterStreamEvent.Error,{type:M.ETwitterStreamEvent.ReconnectError,error:t,message:`Reconnect error - ${e+1} attempts made yet.`}),this.makeAutoReconnectRetry(e,t)}}makeAutoReconnectRetry(e,t){let s=this.nextRetryTimeout(e+1,t);this.retryTimeout=setTimeout(()=>{this.onConnectionError(e+1)},s)}async*[Symbol.asyncIterator](){let e=new rm.default(this);try{for(;;){if(!this.req||this.req.aborted)throw new Error("Connection closed");e.hasStack()&&(yield*e.popStack());let{type:t,payload:s}=await e.nextEvent();if(t==="error")throw s}}finally{e.destroy()}}};ve.TweetStream=fs;ve.default=fs});var Cc=w(hr=>{"use strict";Object.defineProperty(hr,"__esModule",{value:!0});hr.applyResponseHooks=hr.hasRequestErrorPlugins=void 0;var hs=Ye();function sm(r){var e;if(!(!((e=r.clientSettings.plugins)===null||e===void 0)&&e.length))return!1;for(let t of r.clientSettings.plugins)if(t.onRequestError||t.onResponseError)return!0;return!1}hr.hasRequestErrorPlugins=sm;async function im(r,e,t,s){let a;return s instanceof hs.ApiRequestError||s instanceof hs.ApiPartialResponseError?a=await this.applyPluginMethod("onRequestError",{client:this,url:this.getUrlObjectFromUrlString(r.url),params:r,computedParams:e,requestOptions:t,error:s}):s instanceof hs.ApiResponseError&&(a=await this.applyPluginMethod("onResponseError",{client:this,url:this.getUrlObjectFromUrlString(r.url),params:r,computedParams:e,requestOptions:t,error:s})),a&&a instanceof hs.TwitterApiPluginResponseOverride?a.value:Promise.reject(s)}hr.applyResponseHooks=im});var Ji=w(Ue=>{"use strict";var am=Ue&&Ue.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,a)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),om=Ue&&Ue.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),um=Ue&&Ue.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&am(e,r,t);return om(e,r),e};Object.defineProperty(Ue,"__esModule",{value:!0});Ue.OAuth1Helper=void 0;var lm=um(require("crypto")),_e=class{constructor(e){this.nonceLength=32,this.consumerKeys=e.consumerKeys}static percentEncode(e){return encodeURIComponent(e).replace(/!/g,"%21").replace(/\*/g,"%2A").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29")}hash(e,t){return lm.createHmac("sha1",t).update(e).digest("base64")}authorize(e,t={}){let s={oauth_consumer_key:this.consumerKeys.key,oauth_nonce:this.getNonce(),oauth_signature_method:"HMAC-SHA1",oauth_timestamp:this.getTimestamp(),oauth_version:"1.0"};return t.key!==void 0&&(s.oauth_token=t.key),e.data||(e.data={}),s.oauth_signature=this.getSignature(e,t.secret,s),s}toHeader(e){let t=kc(e),s="OAuth ";for(let a of t)a.key.indexOf("oauth_")===0&&(s+=_e.percentEncode(a.key)+'="'+_e.percentEncode(a.value)+'",');return{Authorization:s.slice(0,s.length-1)}}getNonce(){let e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",t="";for(let s=0;s<this.nonceLength;s++)t+=e[Math.trunc(Math.random()*e.length)];return t}getTimestamp(){return Math.trunc(new Date().getTime()/1e3)}getSignature(e,t,s){return this.hash(this.getBaseString(e,s),this.getSigningKey(t))}getSigningKey(e){return _e.percentEncode(this.consumerKeys.secret)+"&"+_e.percentEncode(e||"")}getBaseString(e,t){return e.method.toUpperCase()+"&"+_e.percentEncode(this.getBaseUrl(e.url))+"&"+_e.percentEncode(this.getParameterString(e,t))}getParameterString(e,t){let s=kc(fm(Ic(t,Ic(e.data,dm(e.url))))),a="";for(let{key:u,value:c}of s)if(c&&Array.isArray(c)){c.sort();let f="";c.forEach((m,S)=>{f+=u+"="+m,S<c.length&&(f+="&")}),a+=f}else a+=u+"="+c+"&";return a.slice(0,a.length-1)}getBaseUrl(e){return e.split("?")[0]}};Ue.OAuth1Helper=_e;Ue.default=_e;function Ic(r,e){return{...r||{},...e||{}}}function kc(r){return Object.keys(r).sort().map(e=>({key:e,value:r[e]}))}function cm(r){let e=r.split("&"),t={};for(let s of e){let[a,u=""]=s.split("=");t[a]?(Array.isArray(t[a])||(t[a]=[t[a]]),t[a].push(decodeURIComponent(u))):t[a]=decodeURIComponent(u)}return t}function dm(r){let e=r.split("?");return e.length===1?{}:cm(e[1])}function fm(r){let e={};for(let t in r){let s=r[t];s&&Array.isArray(s)?s=s.map(a=>_e.percentEncode(a)):s=_e.percentEncode(s),e[_e.percentEncode(t)]=s}return e}});var Ec=w(ms=>{"use strict";Object.defineProperty(ms,"__esModule",{value:!0});ms.FormDataHelper=void 0;var hm=Tt(),Le=class{constructor(){this._boundary="",this._chunks=[]}bodyAppend(...e){let t=e.map(s=>s instanceof Buffer?s:Buffer.from(s));this._chunks.push(...t)}append(e,t,s){let a=t instanceof Buffer?t:t.toString(),u=this.getMultipartHeader(e,a,s);this.bodyAppend(u,a,Le.LINE_BREAK)}getHeaders(){return{"content-type":"multipart/form-data; boundary="+this.getBoundary()}}getLength(){return this._chunks.reduce((e,t)=>e+t.length,this.getMultipartFooter().length)}getBuffer(){let e=[...this._chunks,this.getMultipartFooter()],t=Buffer.alloc(this.getLength()),s=0;for(let a of e)for(let u=0;u<a.length;s++,u++)t[s]=a[u];return t}getBoundary(){return this._boundary||this.generateBoundary(),this._boundary}generateBoundary(){let e="--------------------------";for(let t=0;t<24;t++)e+=Math.floor(Math.random()*10).toString(16);this._boundary=e}getMultipartHeader(e,t,s){s||(s=t instanceof Buffer?Le.DEFAULT_CONTENT_TYPE:"");let a={"Content-Disposition":["form-data",`name="${e}"`],"Content-Type":s},u="";for(let[c,f]of Object.entries(a))f.length&&(u+=c+": "+(0,hm.arrayWrap)(f).join("; ")+Le.LINE_BREAK);return"--"+this.getBoundary()+Le.LINE_BREAK+u+Le.LINE_BREAK}getMultipartFooter(){return this._footerChunk?this._footerChunk:this._footerChunk=Buffer.from("--"+this.getBoundary()+"--"+Le.LINE_BREAK)}};ms.FormDataHelper=Le;Le.LINE_BREAK=`\r
`;Le.DEFAULT_CONTENT_TYPE="application/octet-stream"});var Zi=w(Bt=>{"use strict";var mm=Bt&&Bt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Bt,"__esModule",{value:!0});Bt.RequestParamHelpers=void 0;var pm=Ec(),Oc=mm(Ji()),Kr=class{static formatQueryToString(e){let t={};for(let s in e)typeof e[s]=="string"?t[s]=e[s]:typeof e[s]<"u"&&(t[s]=String(e[s]));return t}static autoDetectBodyType(e){if(e.pathname.startsWith("/2/")||e.pathname.startsWith("/labs/2/"))return e.password.startsWith("/2/oauth2")?"url":"json";if(e.hostname==="upload.twitter.com")return e.pathname==="/1.1/media/upload.json"?"form-data":"json";let t=e.pathname.split("/1.1/",2)[1];return this.JSON_1_1_ENDPOINTS.has(t)?"json":"url"}static addQueryParamsToUrl(e,t){let s=Object.entries(t);if(s.length){let a="";for(let[u,c]of s)a+=(a.length?"&":"?")+`${Oc.default.percentEncode(u)}=${Oc.default.percentEncode(c)}`;e.search=a}}static constructBodyParams(e,t,s){if(e instanceof Buffer)return e;if(s==="json")return t["content-type"]||(t["content-type"]="application/json;charset=UTF-8"),JSON.stringify(e);if(s==="url")return t["content-type"]||(t["content-type"]="application/x-www-form-urlencoded;charset=UTF-8"),Object.keys(e).length?new URLSearchParams(e).toString().replace(/\*/g,"%2A"):"";if(s==="raw")throw new Error("You can only use raw body mode with Buffers. To give a string, use Buffer.from(str).");{let a=new pm.FormDataHelper;for(let u in e)a.append(u,e[u]);if(!t["content-type"]){let u=a.getHeaders();t["content-type"]=u["content-type"]}return a.getBuffer()}}static setBodyLengthHeader(e,t){var s;e.headers=(s=e.headers)!==null&&s!==void 0?s:{},typeof t=="string"?e.headers["content-length"]=Buffer.byteLength(t):e.headers["content-length"]=t.length}static isOAuthSerializable(e){return!(e instanceof Buffer)}static mergeQueryAndBodyForOAuth(e,t){let s={};for(let a in e)s[a]=e[a];if(this.isOAuthSerializable(t))for(let a in t){let u=t[a];this.isOAuthSerializable(u)&&(s[a]=typeof u=="object"&&u!==null&&"toString"in u?u.toString():u)}return s}static moveUrlQueryParamsIntoObject(e,t){for(let[s,a]of e.searchParams)t[s]=a;return e.search="",e}static applyRequestParametersToUrl(e,t){return e.pathname=e.pathname.replace(/:([A-Z_-]+)/ig,(s,a)=>t[a]!==void 0?String(t[a]):s),e}};Bt.RequestParamHelpers=Kr;Kr.JSON_1_1_ENDPOINTS=new Set(["direct_messages/events/new.json","direct_messages/welcome_messages/new.json","direct_messages/welcome_messages/rules/new.json","media/metadata/create.json","collections/entries/curate.json"]);Bt.default=Kr});var ta=w(Xe=>{"use strict";var _m=Xe&&Xe.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,a)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),gm=Xe&&Xe.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),wm=Xe&&Xe.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&_m(e,r,t);return gm(e,r),e};Object.defineProperty(Xe,"__esModule",{value:!0});Xe.OAuth2Helper=void 0;var ym=wm(require("crypto")),ea=class{static getCodeVerifier(){return this.generateRandomString(128)}static getCodeChallengeFromVerifier(e){return this.escapeBase64Url(ym.createHash("sha256").update(e).digest("base64"))}static getAuthHeader(e,t){let s=encodeURIComponent(e)+":"+encodeURIComponent(t);return Buffer.from(s).toString("base64")}static generateRandomString(e){let t="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~";for(let a=0;a<e;a++)t+=s[Math.floor(Math.random()*s.length)];return t}static escapeBase64Url(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}};Xe.OAuth2Helper=ea});var xc=w(mr=>{"use strict";var ps=mr&&mr.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(mr,"__esModule",{value:!0});mr.ClientRequestMaker=void 0;var bm=Ye(),Tm=ps(cs()),Mc=Cc(),Sm=Tt(),vm=ps(Ji()),Rm=ps(Yi()),lt=ps(Zi()),Pm=ta(),Ut=class{constructor(e){this.rateLimits={},this.clientSettings={},e&&(this.clientSettings=e)}getRateLimits(){return this.rateLimits}saveRateLimit(e,t){this.rateLimits[e]=t}async send(e){var t,s,a,u,c;if(!((t=this.clientSettings.plugins)===null||t===void 0)&&t.length){let g=await this.applyPreRequestConfigHooks(e);if(g)return g}let f=this.getHttpRequestArgs(e),m={method:f.method,headers:f.headers,timeout:e.timeout,agent:this.clientSettings.httpAgent},S=e.enableRateLimitSave!==!1;f.body&&lt.default.setBodyLengthHeader(m,f.body),!((s=this.clientSettings.plugins)===null||s===void 0)&&s.length&&await this.applyPreRequestHooks(e,f,m);let b=new Rm.default({url:f.url,options:m,body:f.body,rateLimitSaver:S?this.saveRateLimit.bind(this,f.rawUrl):void 0,requestEventDebugHandler:e.requestEventDebugHandler,compression:(u=(a=e.compression)!==null&&a!==void 0?a:this.clientSettings.compression)!==null&&u!==void 0?u:!0,forceParseMode:e.forceParseMode}).makeRequest();(0,Mc.hasRequestErrorPlugins)(this)&&(b=this.applyResponseErrorHooks(e,f,m,b));let T=await b;if(!((c=this.clientSettings.plugins)===null||c===void 0)&&c.length){let g=await this.applyPostRequestHooks(e,f,m,T);if(g)return g.value}return T}sendStream(e){var t,s;this.clientSettings.plugins&&this.applyPreStreamRequestConfigHooks(e);let a=this.getHttpRequestArgs(e),u={method:a.method,headers:a.headers,agent:this.clientSettings.httpAgent},c=e.enableRateLimitSave!==!1,f=e.autoConnect!==!1;a.body&&lt.default.setBodyLengthHeader(u,a.body);let m={url:a.url,options:u,body:a.body,rateLimitSaver:c?this.saveRateLimit.bind(this,a.rawUrl):void 0,payloadIsError:e.payloadIsError,compression:(s=(t=e.compression)!==null&&t!==void 0?t:this.clientSettings.compression)!==null&&s!==void 0?s:!0},S=new Tm.default(m);return f?S.connect():S}initializeToken(e){if(typeof e=="string")this.bearerToken=e;else if(typeof e=="object"&&"appKey"in e)this.consumerToken=e.appKey,this.consumerSecret=e.appSecret,e.accessToken&&e.accessSecret&&(this.accessToken=e.accessToken,this.accessSecret=e.accessSecret),this._oauth=this.buildOAuth();else if(typeof e=="object"&&"username"in e){let t=encodeURIComponent(e.username)+":"+encodeURIComponent(e.password);this.basicToken=Buffer.from(t).toString("base64")}else typeof e=="object"&&"clientId"in e&&(this.clientId=e.clientId,this.clientSecret=e.clientSecret)}getActiveTokens(){return this.bearerToken?{type:"oauth2",bearerToken:this.bearerToken}:this.basicToken?{type:"basic",token:this.basicToken}:this.consumerSecret&&this._oauth?{type:"oauth-1.0a",appKey:this.consumerToken,appSecret:this.consumerSecret,accessToken:this.accessToken,accessSecret:this.accessSecret}:this.clientId?{type:"oauth2-user",clientId:this.clientId}:{type:"none"}}buildOAuth(){if(!this.consumerSecret||!this.consumerToken)throw new Error("Invalid consumer tokens");return new vm.default({consumerKeys:{key:this.consumerToken,secret:this.consumerSecret}})}getOAuthAccessTokens(){if(!(!this.accessSecret||!this.accessToken))return{key:this.accessToken,secret:this.accessSecret}}getPlugins(){var e;return(e=this.clientSettings.plugins)!==null&&e!==void 0?e:[]}hasPlugins(){var e;return!!(!((e=this.clientSettings.plugins)===null||e===void 0)&&e.length)}async applyPluginMethod(e,t){var s;let a;for(let u of this.getPlugins()){let c=await((s=u[e])===null||s===void 0?void 0:s.call(u,t));c&&c instanceof bm.TwitterApiPluginResponseOverride&&(a=c)}return a}writeAuthHeaders({headers:e,bodyInSignature:t,url:s,method:a,query:u,body:c}){if(e={...e},this.bearerToken)e.Authorization="Bearer "+this.bearerToken;else if(this.basicToken)e.Authorization="Basic "+this.basicToken;else if(this.clientId&&this.clientSecret)e.Authorization="Basic "+Pm.OAuth2Helper.getAuthHeader(this.clientId,this.clientSecret);else if(this.consumerSecret&&this._oauth){let f=t?lt.default.mergeQueryAndBodyForOAuth(u,c):u,m=this._oauth.authorize({url:s.toString(),method:a,data:f},this.getOAuthAccessTokens());e={...e,...this._oauth.toHeader(m)}}return e}getUrlObjectFromUrlString(e){return e.startsWith("http")||(e="https://"+e),new URL(e)}getHttpRequestArgs({url:e,method:t,query:s={},body:a={},headers:u,forceBodyMode:c,enableAuth:f,params:m}){let S;t=t.toUpperCase(),u=u??{},u["x-user-agent"]||(u["x-user-agent"]="Node.twitter-api-v2");let b=this.getUrlObjectFromUrlString(e),T=b.origin+b.pathname;m&&lt.default.applyRequestParametersToUrl(b,m);let g=lt.default.formatQueryToString(s);lt.default.moveUrlQueryParamsIntoObject(b,g),a instanceof Buffer||(0,Sm.trimUndefinedProperties)(a);let p=c??lt.default.autoDetectBodyType(b);if(f!==!1){let D=Ut.BODY_METHODS.has(t)&&p==="url";u=this.writeAuthHeaders({headers:u,bodyInSignature:D,method:t,query:g,url:b,body:a})}return Ut.BODY_METHODS.has(t)&&(S=lt.default.constructBodyParams(a,u,p)||void 0),lt.default.addQueryParamsToUrl(b,g),{rawUrl:T,url:b,method:t,headers:u,body:S}}async applyPreRequestConfigHooks(e){var t;let s=this.getUrlObjectFromUrlString(e.url);for(let a of this.getPlugins()){let u=await((t=a.onBeforeRequestConfig)===null||t===void 0?void 0:t.call(a,{client:this,url:s,params:e}));if(u)return u}}applyPreStreamRequestConfigHooks(e){var t;let s=this.getUrlObjectFromUrlString(e.url);for(let a of this.getPlugins())(t=a.onBeforeStreamRequestConfig)===null||t===void 0||t.call(a,{client:this,url:s,params:e})}async applyPreRequestHooks(e,t,s){await this.applyPluginMethod("onBeforeRequest",{client:this,url:this.getUrlObjectFromUrlString(e.url),params:e,computedParams:t,requestOptions:s})}async applyPostRequestHooks(e,t,s,a){return await this.applyPluginMethod("onAfterRequest",{client:this,url:this.getUrlObjectFromUrlString(e.url),params:e,computedParams:t,requestOptions:s,response:a})}applyResponseErrorHooks(e,t,s,a){return a.catch(Mc.applyResponseHooks.bind(this,e,t,s))}};mr.ClientRequestMaker=Ut;Ut.BODY_METHODS=new Set(["POST","PUT","PATCH"])});var na=w(ra=>{"use strict";Object.defineProperty(ra,"__esModule",{value:!0});var qm=xc(),Fc=Tt(),jc=Be(),Gr=class{constructor(e,t={}){this._currentUser=null,this._currentUserV2=null,e instanceof Gr?this._requestMaker=e._requestMaker:(this._requestMaker=new qm.ClientRequestMaker(t),this._requestMaker.initializeToken(e))}setPrefix(e){this._prefix=e}cloneWithPrefix(e){let t=this.constructor(this);return t.setPrefix(e),t}getActiveTokens(){return this._requestMaker.getActiveTokens()}getPlugins(){return this._requestMaker.getPlugins()}getPluginOfType(e){return this.getPlugins().find(t=>t instanceof e)}hasHitRateLimit(e){var t;return this.isRateLimitStatusObsolete(e)?!1:((t=this.getLastRateLimitStatus(e))===null||t===void 0?void 0:t.remaining)===0}isRateLimitStatusObsolete(e){let t=this.getLastRateLimitStatus(e);return t===void 0?!0:t.reset*1e3<Date.now()}getLastRateLimitStatus(e){let t=e.match(/^https?:\/\//)?e:this._prefix+e;return this._requestMaker.getRateLimits()[t]}getCurrentUserObject(e=!1){return!e&&this._currentUser?this._currentUser.value?Promise.resolve(this._currentUser.value):this._currentUser.promise:(this._currentUser=(0,Fc.sharedPromise)(()=>this.get("account/verify_credentials.json",{tweet_mode:"extended"},{prefix:jc.API_V1_1_PREFIX})),this._currentUser.promise)}getCurrentUserV2Object(e=!1){return!e&&this._currentUserV2?this._currentUserV2.value?Promise.resolve(this._currentUserV2.value):this._currentUserV2.promise:(this._currentUserV2=(0,Fc.sharedPromise)(()=>this.get("users/me",void 0,{prefix:jc.API_V2_PREFIX})),this._currentUserV2.promise)}async get(e,t={},{fullResponse:s,prefix:a=this._prefix,...u}={}){a&&(e=a+e);let c=await this._requestMaker.send({url:e,method:"GET",query:t,...u});return s?c:c.data}async delete(e,t={},{fullResponse:s,prefix:a=this._prefix,...u}={}){a&&(e=a+e);let c=await this._requestMaker.send({url:e,method:"DELETE",query:t,...u});return s?c:c.data}async post(e,t,{fullResponse:s,prefix:a=this._prefix,...u}={}){a&&(e=a+e);let c=await this._requestMaker.send({url:e,method:"POST",body:t,...u});return s?c:c.data}async put(e,t,{fullResponse:s,prefix:a=this._prefix,...u}={}){a&&(e=a+e);let c=await this._requestMaker.send({url:e,method:"PUT",body:t,...u});return s?c:c.data}async patch(e,t,{fullResponse:s,prefix:a=this._prefix,...u}={}){a&&(e=a+e);let c=await this._requestMaker.send({url:e,method:"PATCH",body:t,...u});return s?c:c.data}getStream(e,t,{prefix:s=this._prefix,...a}={}){return this._requestMaker.sendStream({url:s?s+e:e,method:"GET",query:t,...a})}postStream(e,t,{prefix:s=this._prefix,...a}={}){return this._requestMaker.sendStream({url:s?s+e:e,method:"POST",body:t,...a})}};ra.default=Gr});var _s=w(Jr=>{"use strict";var Am=Jr&&Jr.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Jr,"__esModule",{value:!0});var Bc=Am(na()),sa=class extends Bc.default{constructor(e){if(!(e instanceof Bc.default))throw new Error("You must instance SubTwitterApi instance from existing TwitterApi instance.");super(e)}};Jr.default=sa});var ca=w(ge=>{"use strict";var Dm=ge&&ge.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ge,"__esModule",{value:!0});ge.UserFavoritesV1Paginator=ge.ListTimelineV1Paginator=ge.UserTimelineV1Paginator=ge.MentionTimelineV1Paginator=ge.HomeTimelineV1Paginator=void 0;var Lm=Dm(or()),Wt=class extends Lm.default{constructor(){super(...arguments),this.hasFinishedFetch=!1}refreshInstanceFromResult(e,t){let s=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.push(...s),this.hasFinishedFetch=s.length===0)}getNextQueryParams(e){let t=BigInt(this._realData[this._realData.length-1].id_str);return{...this.injectQueryParams(e),max_id:(t-BigInt(1)).toString()}}getPageLengthFromRequest(e){return e.data.length}isFetchLastOver(e){return!e.data.length}canFetchNextPage(e){return e.length>0}getItemArray(){return this.tweets}get tweets(){return this._realData}get done(){return super.done||this.hasFinishedFetch}},ia=class extends Wt{constructor(){super(...arguments),this._endpoint="statuses/home_timeline.json"}};ge.HomeTimelineV1Paginator=ia;var aa=class extends Wt{constructor(){super(...arguments),this._endpoint="statuses/mentions_timeline.json"}};ge.MentionTimelineV1Paginator=aa;var oa=class extends Wt{constructor(){super(...arguments),this._endpoint="statuses/user_timeline.json"}};ge.UserTimelineV1Paginator=oa;var ua=class extends Wt{constructor(){super(...arguments),this._endpoint="lists/statuses.json"}};ge.ListTimelineV1Paginator=ua;var la=class extends Wt{constructor(){super(...arguments),this._endpoint="favorites/list.json"}};ge.UserFavoritesV1Paginator=la});var ha=w(pr=>{"use strict";Object.defineProperty(pr,"__esModule",{value:!0});pr.MuteUserIdsV1Paginator=pr.MuteUserListV1Paginator=void 0;var Uc=xt(),da=class extends Uc.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="mutes/users/list.json"}refreshInstanceFromResult(e,t){let s=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.users.push(...s.users),this._realData.next_cursor=s.next_cursor)}getPageLengthFromRequest(e){return e.data.users.length}getItemArray(){return this.users}get users(){return this._realData.users}};pr.MuteUserListV1Paginator=da;var fa=class extends Uc.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="mutes/users/ids.json",this._maxResultsWhenFetchLast=5e3}refreshInstanceFromResult(e,t){let s=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.ids.push(...s.ids),this._realData.next_cursor=s.next_cursor)}getPageLengthFromRequest(e){return e.data.ids.length}getItemArray(){return this.ids}get ids(){return this._realData.ids}};pr.MuteUserIdsV1Paginator=fa});var _a=w(_r=>{"use strict";Object.defineProperty(_r,"__esModule",{value:!0});_r.UserFollowerIdsV1Paginator=_r.UserFollowerListV1Paginator=void 0;var Wc=xt(),ma=class extends Wc.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="followers/list.json"}refreshInstanceFromResult(e,t){let s=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.users.push(...s.users),this._realData.next_cursor=s.next_cursor)}getPageLengthFromRequest(e){return e.data.users.length}getItemArray(){return this.users}get users(){return this._realData.users}};_r.UserFollowerListV1Paginator=ma;var pa=class extends Wc.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="followers/ids.json",this._maxResultsWhenFetchLast=5e3}refreshInstanceFromResult(e,t){let s=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.ids.push(...s.ids),this._realData.next_cursor=s.next_cursor)}getPageLengthFromRequest(e){return e.data.ids.length}getItemArray(){return this.ids}get ids(){return this._realData.ids}};_r.UserFollowerIdsV1Paginator=pa});var ya=w(gr=>{"use strict";Object.defineProperty(gr,"__esModule",{value:!0});gr.UserFollowersIdsV1Paginator=gr.UserFriendListV1Paginator=void 0;var zc=xt(),ga=class extends zc.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="friends/list.json"}refreshInstanceFromResult(e,t){let s=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.users.push(...s.users),this._realData.next_cursor=s.next_cursor)}getPageLengthFromRequest(e){return e.data.users.length}getItemArray(){return this.users}get users(){return this._realData.users}};gr.UserFriendListV1Paginator=ga;var wa=class extends zc.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="friends/ids.json",this._maxResultsWhenFetchLast=5e3}refreshInstanceFromResult(e,t){let s=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.ids.push(...s.ids),this._realData.next_cursor=s.next_cursor)}getPageLengthFromRequest(e){return e.data.ids.length}getItemArray(){return this.ids}get ids(){return this._realData.ids}};gr.UserFollowersIdsV1Paginator=wa});var Sa=w(Ke=>{"use strict";var Cm=Ke&&Ke.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ke,"__esModule",{value:!0});Ke.FriendshipsOutgoingV1Paginator=Ke.FriendshipsIncomingV1Paginator=Ke.UserSearchV1Paginator=void 0;var Im=Cm(or()),km=xt(),ba=class extends Im.default{constructor(){super(...arguments),this._endpoint="users/search.json"}refreshInstanceFromResult(e,t){let s=e.data;this._rateLimit=e.rateLimit,t&&this._realData.push(...s)}getNextQueryParams(e){var t;let s=Number((t=this._queryParams.page)!==null&&t!==void 0?t:"1");return{...this._queryParams,page:s+1,...e?{count:e}:{}}}getPageLengthFromRequest(e){return e.data.length}isFetchLastOver(e){return!e.data.length}canFetchNextPage(e){return e.length>0}getItemArray(){return this.users}get users(){return this._realData}};Ke.UserSearchV1Paginator=ba;var gs=class extends km.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="friendships/incoming.json",this._maxResultsWhenFetchLast=5e3}refreshInstanceFromResult(e,t){let s=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.ids.push(...s.ids),this._realData.next_cursor=s.next_cursor)}getPageLengthFromRequest(e){return e.data.ids.length}getItemArray(){return this.ids}get ids(){return this._realData.ids}};Ke.FriendshipsIncomingV1Paginator=gs;var Ta=class extends gs{constructor(){super(...arguments),this._endpoint="friendships/outgoing.json"}};Ke.FriendshipsOutgoingV1Paginator=Ta});var Da=w(Ce=>{"use strict";Object.defineProperty(Ce,"__esModule",{value:!0});Ce.ListSubscribersV1Paginator=Ce.ListMembersV1Paginator=Ce.ListSubscriptionsV1Paginator=Ce.ListOwnershipsV1Paginator=Ce.ListMembershipsV1Paginator=void 0;var $c=xt(),Zr=class extends $c.CursoredV1Paginator{refreshInstanceFromResult(e,t){let s=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.lists.push(...s.lists),this._realData.next_cursor=s.next_cursor)}getPageLengthFromRequest(e){return e.data.lists.length}getItemArray(){return this.lists}get lists(){return this._realData.lists}},va=class extends Zr{constructor(){super(...arguments),this._endpoint="lists/memberships.json"}};Ce.ListMembershipsV1Paginator=va;var Ra=class extends Zr{constructor(){super(...arguments),this._endpoint="lists/ownerships.json"}};Ce.ListOwnershipsV1Paginator=Ra;var Pa=class extends Zr{constructor(){super(...arguments),this._endpoint="lists/subscriptions.json"}};Ce.ListSubscriptionsV1Paginator=Pa;var ws=class extends $c.CursoredV1Paginator{refreshInstanceFromResult(e,t){let s=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.users.push(...s.users),this._realData.next_cursor=s.next_cursor)}getPageLengthFromRequest(e){return e.data.users.length}getItemArray(){return this.users}get users(){return this._realData.users}},qa=class extends ws{constructor(){super(...arguments),this._endpoint="lists/members.json"}};Ce.ListMembersV1Paginator=qa;var Aa=class extends ws{constructor(){super(...arguments),this._endpoint="lists/subscribers.json"}};Ce.ListSubscribersV1Paginator=Aa});var ka=w(tn=>{"use strict";var Qc=tn&&tn.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(tn,"__esModule",{value:!0});var Em=Qc(_s()),La=Be(),Om=Tt(),Mm=Qc(ys()),zt=ca(),Nc=ha(),Vc=_a(),Hc=ya(),Ca=Sa(),en=Da(),Ia=class extends Em.default{constructor(){super(...arguments),this._prefix=La.API_V1_1_PREFIX}singleTweet(e,t={}){return this.get("statuses/show.json",{tweet_mode:"extended",id:e,...t})}tweets(e,t={}){return this.post("statuses/lookup.json",{tweet_mode:"extended",id:e,...t})}oembedTweet(e,t={}){return this.get("oembed",{url:`https://twitter.com/i/statuses/${e}`,...t},{prefix:"https://publish.twitter.com/"})}async homeTimeline(e={}){let t={tweet_mode:"extended",...e},s=await this.get("statuses/home_timeline.json",t,{fullResponse:!0});return new zt.HomeTimelineV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}async mentionTimeline(e={}){let t={tweet_mode:"extended",...e},s=await this.get("statuses/mentions_timeline.json",t,{fullResponse:!0});return new zt.MentionTimelineV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}async userTimeline(e,t={}){let s={tweet_mode:"extended",user_id:e,...t},a=await this.get("statuses/user_timeline.json",s,{fullResponse:!0});return new zt.UserTimelineV1Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:s})}async userTimelineByUsername(e,t={}){let s={tweet_mode:"extended",screen_name:e,...t},a=await this.get("statuses/user_timeline.json",s,{fullResponse:!0});return new zt.UserTimelineV1Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:s})}async favoriteTimeline(e,t={}){let s={tweet_mode:"extended",user_id:e,...t},a=await this.get("favorites/list.json",s,{fullResponse:!0});return new zt.UserFavoritesV1Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:s})}async favoriteTimelineByUsername(e,t={}){let s={tweet_mode:"extended",screen_name:e,...t},a=await this.get("favorites/list.json",s,{fullResponse:!0});return new zt.UserFavoritesV1Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:s})}user(e){return this.get("users/show.json",{tweet_mode:"extended",...e})}users(e){return this.get("users/lookup.json",{tweet_mode:"extended",...e})}verifyCredentials(e={}){return this.get("account/verify_credentials.json",e)}async listMutedUsers(e={}){let t={tweet_mode:"extended",...e},s=await this.get("mutes/users/list.json",t,{fullResponse:!0});return new Nc.MuteUserListV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}async listMutedUserIds(e={}){let t={stringify_ids:!0,...e},s=await this.get("mutes/users/ids.json",t,{fullResponse:!0});return new Nc.MuteUserIdsV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}async userFriendList(e={}){let t={...e},s=await this.get("friends/list.json",t,{fullResponse:!0});return new Hc.UserFriendListV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}async userFollowerList(e={}){let t={...e},s=await this.get("followers/list.json",t,{fullResponse:!0});return new Vc.UserFollowerListV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}async userFollowerIds(e={}){let t={stringify_ids:!0,...e},s=await this.get("followers/ids.json",t,{fullResponse:!0});return new Vc.UserFollowerIdsV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}async userFollowingIds(e={}){let t={stringify_ids:!0,...e},s=await this.get("friends/ids.json",t,{fullResponse:!0});return new Hc.UserFollowersIdsV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}async searchUsers(e,t={}){let s={q:e,tweet_mode:"extended",page:1,...t},a=await this.get("users/search.json",s,{fullResponse:!0});return new Ca.UserSearchV1Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:s})}friendship(e){return this.get("friendships/show.json",e)}friendships(e){return this.get("friendships/lookup.json",e)}friendshipsNoRetweets(){return this.get("friendships/no_retweets/ids.json",{stringify_ids:!0})}async friendshipsIncoming(e={}){let t={stringify_ids:!0,...e},s=await this.get("friendships/incoming.json",t,{fullResponse:!0});return new Ca.FriendshipsIncomingV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}async friendshipsOutgoing(e={}){let t={stringify_ids:!0,...e},s=await this.get("friendships/outgoing.json",t,{fullResponse:!0});return new Ca.FriendshipsOutgoingV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}accountSettings(){return this.get("account/settings.json")}userProfileBannerSizes(e){return this.get("users/profile_banner.json",e)}list(e){return this.get("lists/show.json",{tweet_mode:"extended",...e})}lists(e={}){return this.get("lists/list.json",{tweet_mode:"extended",...e})}async listMembers(e={}){let t={tweet_mode:"extended",...e},s=await this.get("lists/members.json",t,{fullResponse:!0});return new en.ListMembersV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}listGetMember(e){return this.get("lists/members/show.json",{tweet_mode:"extended",...e})}async listMemberships(e={}){let t={tweet_mode:"extended",...e},s=await this.get("lists/memberships.json",t,{fullResponse:!0});return new en.ListMembershipsV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}async listOwnerships(e={}){let t={tweet_mode:"extended",...e},s=await this.get("lists/ownerships.json",t,{fullResponse:!0});return new en.ListOwnershipsV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}async listStatuses(e){let t={tweet_mode:"extended",...e},s=await this.get("lists/statuses.json",t,{fullResponse:!0});return new zt.ListTimelineV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}async listSubscribers(e={}){let t={tweet_mode:"extended",...e},s=await this.get("lists/subscribers.json",t,{fullResponse:!0});return new en.ListSubscribersV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}listGetSubscriber(e){return this.get("lists/subscribers/show.json",{tweet_mode:"extended",...e})}async listSubscriptions(e={}){let t={tweet_mode:"extended",...e},s=await this.get("lists/subscriptions.json",t,{fullResponse:!0});return new en.ListSubscriptionsV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}mediaInfo(e){return this.get("media/upload.json",{command:"STATUS",media_id:e},{prefix:La.API_V1_1_UPLOAD_PREFIX})}filterStream({autoConnect:e,...t}={}){let s={};for(let[u,c]of Object.entries(t))if(u==="follow"||u==="track")s[u]=c.toString();else if(u==="locations"){let f=c;s.locations=(0,Om.arrayWrap)(f).map(m=>`${m.lng},${m.lat}`).join(",")}else s[u]=c;return this.stream.postStream("statuses/filter.json",s,{autoConnect:e})}sampleStream({autoConnect:e,...t}={}){return this.stream.getStream("statuses/sample.json",t,{autoConnect:e})}get stream(){let e=new Mm.default(this);return e.setPrefix(La.API_V1_1_STREAM_PREFIX),e}trendsByPlace(e,t={}){return this.get("trends/place.json",{id:e,...t})}trendsAvailable(){return this.get("trends/available.json")}trendsClosest(e,t){return this.get("trends/closest.json",{lat:e,long:t})}geoPlace(e){return this.get("geo/id/:place_id.json",void 0,{params:{place_id:e}})}geoSearch(e){return this.get("geo/search.json",e)}geoReverseGeoCode(e){return this.get("geo/reverse_geocode.json",e)}rateLimitStatuses(...e){return this.get("application/rate_limit_status.json",{resources:e})}supportedLanguages(){return this.get("help/languages.json")}};tn.default=Ia});var Kc=w(z=>{"use strict";var xm=z&&z.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,a)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),Fm=z&&z.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),jm=z&&z.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&xm(e,r,t);return Fm(e,r),e};Object.defineProperty(z,"__esModule",{value:!0});z.readNextPartOf=z.sleepSecs=z.getMediaCategoryByMime=z.getMimeType=z.getFileSizeFromFileHandle=z.getFileHandle=z.readFileIntoBuffer=void 0;var bs=jm(require("fs")),Yc=Tt(),X=Ye();async function Bm(r){let e=await Xc(r);return typeof e=="number"?new Promise((t,s)=>{bs.readFile(e,(a,u)=>{if(a)return s(a);t(u)})}):e instanceof Buffer?e:e.readFile()}z.readFileIntoBuffer=Bm;function Xc(r){if(typeof r=="string")return bs.promises.open(r,"r");if(typeof r=="number")return r;if(typeof r=="object"&&!(r instanceof Buffer))return r;if(r instanceof Buffer)return r;throw new Error("Given file is not valid, please check its type.")}z.getFileHandle=Xc;async function Um(r){return typeof r=="number"?(await new Promise((t,s)=>{bs.fstat(r,(a,u)=>{a&&s(a),t(u)})})).size:r instanceof Buffer?r.length:(await r.stat()).size}z.getFileSizeFromFileHandle=Um;function Wm(r,e,t){if(typeof t=="string")return t;if(typeof r=="string"&&!e)return zm(r);if(typeof e=="string")return $m(e);throw new Error("You must specify type if file is a file handle or Buffer.")}z.getMimeType=Wm;function zm(r){return r.endsWith(".jpeg")||r.endsWith(".jpg")?X.EUploadMimeType.Jpeg:r.endsWith(".png")?X.EUploadMimeType.Png:r.endsWith(".webp")?X.EUploadMimeType.Webp:r.endsWith(".gif")?X.EUploadMimeType.Gif:r.endsWith(".mpeg4")||r.endsWith(".mp4")?X.EUploadMimeType.Mp4:r.endsWith(".mov")||r.endsWith(".mov")?X.EUploadMimeType.Mov:r.endsWith(".srt")?X.EUploadMimeType.Srt:((0,Yc.safeDeprecationWarning)({instance:"TwitterApiv1ReadWrite",method:"uploadMedia",problem:"options.mimeType is missing and filename couldn't help to resolve MIME type, so it will fallback to image/jpeg",resolution:"If you except to give filenames without extensions, please specify explicitlty the MIME type using options.mimeType"}),X.EUploadMimeType.Jpeg)}function $m(r){return(0,Yc.safeDeprecationWarning)({instance:"TwitterApiv1ReadWrite",method:"uploadMedia",problem:"you're using options.type",resolution:"Remove options.type argument and migrate to options.mimeType which takes the real MIME type. If you're using type=longmp4, add options.longVideo alongside of mimeType=EUploadMimeType.Mp4"}),r==="gif"?X.EUploadMimeType.Gif:r==="jpg"?X.EUploadMimeType.Jpeg:r==="png"?X.EUploadMimeType.Png:r==="webp"?X.EUploadMimeType.Webp:r==="srt"?X.EUploadMimeType.Srt:r==="mp4"||r==="longmp4"?X.EUploadMimeType.Mp4:r==="mov"?X.EUploadMimeType.Mov:r}function Nm(r,e){return r===X.EUploadMimeType.Mp4||r===X.EUploadMimeType.Mov?e==="tweet"?"TweetVideo":"DmVideo":r===X.EUploadMimeType.Gif?e==="tweet"?"TweetGif":"DmGif":r===X.EUploadMimeType.Srt?"Subtitles":e==="tweet"?"TweetImage":"DmImage"}z.getMediaCategoryByMime=Nm;function Vm(r){return new Promise(e=>setTimeout(e,r*1e3))}z.sleepSecs=Vm;async function Hm(r,e,t=0,s){if(r instanceof Buffer){let u=r.slice(t,t+e);return[u,u.length]}if(!s)throw new Error("Well, we will need a buffer to store file content.");let a;return typeof r=="number"?a=await new Promise((u,c)=>{bs.read(r,s,0,e,t,(f,m)=>{f&&c(f),u(m)})}):a=(await r.read(s,0,e,t)).bytesRead,[s,a]}z.readNextPartOf=Hm});var Ma=w(We=>{"use strict";var Qm=We&&We.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,a)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),Ym=We&&We.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Xm=We&&We.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Qm(e,r,t);return Ym(e,r),e},Km=We&&We.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(We,"__esModule",{value:!0});var Gc=Xm(require("fs")),$t=Be(),Ts=Tt(),Gm=Ye(),Jm=Km(ka()),Ge=Kc(),Ea="media/upload.json",Oa=class extends Jm.default{constructor(){super(...arguments),this._prefix=$t.API_V1_1_PREFIX}get readOnly(){return this}tweet(e,t={}){let s={status:e,tweet_mode:"extended",...t};return this.post("statuses/update.json",s)}async quote(e,t,s={}){let a="https://twitter.com/i/statuses/"+t;return this.tweet(e,{...s,attachment_url:a})}async tweetThread(e){let t=[];for(let s of e){let a=t.length?t[t.length-1]:null,u={...typeof s=="string"?{status:s}:s},c=a?a.id_str:u.in_reply_to_status_id,f=u.status;c?t.push(await this.reply(f,c,u)):t.push(await this.tweet(f,u))}return t}reply(e,t,s={}){return this.tweet(e,{auto_populate_reply_metadata:!0,in_reply_to_status_id:t,...s})}deleteTweet(e){return this.post("statuses/destroy/:id.json",{tweet_mode:"extended"},{params:{id:e}})}reportUserAsSpam(e){return this.post("users/report_spam.json",{tweet_mode:"extended",...e})}updateFriendship(e){return this.post("friendships/update.json",e)}createFriendship(e){return this.post("friendships/create.json",e)}destroyFriendship(e){return this.post("friendships/destroy.json",e)}updateAccountSettings(e){return this.post("account/settings.json",e)}updateAccountProfile(e){return this.post("account/update_profile.json",e)}async updateAccountProfileBanner(e,t={}){let s={banner:await(0,Ge.readFileIntoBuffer)(e),...t};return this.post("account/update_profile_banner.json",s,{forceBodyMode:"form-data"})}async updateAccountProfileImage(e,t={}){let s={tweet_mode:"extended",image:await(0,Ge.readFileIntoBuffer)(e),...t};return this.post("account/update_profile_image.json",s,{forceBodyMode:"form-data"})}removeAccountProfileBanner(){return this.post("account/remove_profile_banner.json")}createList(e){return this.post("lists/create.json",{tweet_mode:"extended",...e})}updateList(e){return this.post("lists/update.json",{tweet_mode:"extended",...e})}removeList(e){return this.post("lists/destroy.json",{tweet_mode:"extended",...e})}addListMembers(e){let s=e.user_id&&(0,Ts.hasMultipleItems)(e.user_id)||e.screen_name&&(0,Ts.hasMultipleItems)(e.screen_name)?"lists/members/create_all.json":"lists/members/create.json";return this.post(s,e)}removeListMembers(e){let s=e.user_id&&(0,Ts.hasMultipleItems)(e.user_id)||e.screen_name&&(0,Ts.hasMultipleItems)(e.screen_name)?"lists/members/destroy_all.json":"lists/members/destroy.json";return this.post(s,e)}subscribeToList(e){return this.post("lists/subscribers/create.json",{tweet_mode:"extended",...e})}unsubscribeOfList(e){return this.post("lists/subscribers/destroy.json",{tweet_mode:"extended",...e})}createMediaMetadata(e,t){return this.post("media/metadata/create.json",{media_id:e,...t},{prefix:$t.API_V1_1_UPLOAD_PREFIX,forceBodyMode:"json"})}createMediaSubtitles(e,t){return this.post("media/subtitles/create.json",{media_id:e,media_category:"TweetVideo",subtitle_info:{subtitles:t}},{prefix:$t.API_V1_1_UPLOAD_PREFIX,forceBodyMode:"json"})}deleteMediaSubtitles(e,...t){return this.post("media/subtitles/delete.json",{media_id:e,media_category:"TweetVideo",subtitle_info:{subtitles:t.map(s=>({language_code:s}))}},{prefix:$t.API_V1_1_UPLOAD_PREFIX,forceBodyMode:"json"})}async uploadMedia(e,t={},s=!1){var a;let u=(a=t.chunkLength)!==null&&a!==void 0?a:1048576,{fileHandle:c,mediaCategory:f,fileSize:m,mimeType:S}=await this.getUploadMediaRequirements(e,t);try{let b=await this.post(Ea,{command:"INIT",total_bytes:m,media_type:S,media_category:f,additional_owners:t.additionalOwners,shared:t.shared?!0:void 0},{prefix:$t.API_V1_1_UPLOAD_PREFIX});await this.mediaChunkedUpload(c,u,b.media_id_string,t.maxConcurrentUploads);let T=await this.post(Ea,{command:"FINALIZE",media_id:b.media_id_string},{prefix:$t.API_V1_1_UPLOAD_PREFIX});return T.processing_info&&T.processing_info.state!=="succeeded"&&await this.awaitForMediaProcessingCompletion(T),s?T:T.media_id_string}finally{typeof e=="number"?Gc.close(e,()=>{}):typeof c=="object"&&!(c instanceof Buffer)&&c.close()}}async awaitForMediaProcessingCompletion(e){for(var t;;){e=await this.mediaInfo(e.media_id_string);let{processing_info:s}=e;if(!s||s.state==="succeeded")return;if(!((t=s.error)===null||t===void 0)&&t.code){let{name:a,message:u}=s.error;throw new Error(`Failed to process media: ${a} - ${u}.`)}if(s.state==="failed")throw new Error("Failed to process the media.");s.check_after_secs?await(0,Ge.sleepSecs)(s.check_after_secs):await(0,Ge.sleepSecs)(5)}}async getUploadMediaRequirements(e,{mimeType:t,type:s,target:a,longVideo:u}={}){let c;try{c=await(0,Ge.getFileHandle)(e);let f=(0,Ge.getMimeType)(e,s,t),m;return f===Gm.EUploadMimeType.Mp4&&(!t&&!s&&a!=="dm"||u)?m="amplify_video":m=(0,Ge.getMediaCategoryByMime)(f,a??"tweet"),{fileHandle:c,mediaCategory:m,fileSize:await(0,Ge.getFileSizeFromFileHandle)(c),mimeType:f}}catch(f){throw typeof e=="number"?Gc.close(e,()=>{}):typeof c=="object"&&!(c instanceof Buffer)&&c.close(),f}}async mediaChunkedUpload(e,t,s,a=3){let u=0;if(a<1)throw new RangeError("Bad maxConcurrentUploads parameter.");let c=e instanceof Buffer?void 0:Buffer.alloc(t),f,m,S=0;[f,m]=await(0,Ge.readNextPartOf)(e,t,S,c),S+=m;let b=new Set;for(;m;){let T=f.slice(0,m);if(T.length){let g=this.post(Ea,{command:"APPEND",media_id:s,segment_index:u,media:T},{prefix:$t.API_V1_1_UPLOAD_PREFIX});b.add(g),g.then(()=>{b.delete(g)}),u++}b.size>=a&&await Promise.race(b),[f,m]=await(0,Ge.readNextPartOf)(e,t,S,c),S+=m}await Promise.all([...b])}};We.default=Oa});var ys=w(Nt=>{"use strict";var Zm=Nt&&Nt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Nt,"__esModule",{value:!0});Nt.TwitterApiv1=void 0;var ep=Be(),Jc=zi(),rn=Ye(),tp=Zm(Ma()),Ss=class extends tp.default{constructor(){super(...arguments),this._prefix=ep.API_V1_1_PREFIX}get readWrite(){return this}sendDm({recipient_id:e,custom_profile_id:t,...s}){let a={event:{type:rn.EDirectMessageEventTypeV1.Create,[rn.EDirectMessageEventTypeV1.Create]:{target:{recipient_id:e},message_data:s}}};return t&&(a.event[rn.EDirectMessageEventTypeV1.Create].custom_profile_id=t),this.post("direct_messages/events/new.json",a,{forceBodyMode:"json"})}getDmEvent(e){return this.get("direct_messages/events/show.json",{id:e})}deleteDm(e){return this.delete("direct_messages/events/destroy.json",{id:e})}async listDmEvents(e={}){let t={...e},s=await this.get("direct_messages/events/list.json",t,{fullResponse:!0});return new Jc.DmEventsV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}newWelcomeDm(e,t){let s={[rn.EDirectMessageEventTypeV1.WelcomeCreate]:{name:e,message_data:t}};return this.post("direct_messages/welcome_messages/new.json",s,{forceBodyMode:"json"})}getWelcomeDm(e){return this.get("direct_messages/welcome_messages/show.json",{id:e})}deleteWelcomeDm(e){return this.delete("direct_messages/welcome_messages/destroy.json",{id:e})}updateWelcomeDm(e,t){let s={message_data:t};return this.put("direct_messages/welcome_messages/update.json",s,{forceBodyMode:"json",query:{id:e}})}async listWelcomeDms(e={}){let t={...e},s=await this.get("direct_messages/welcome_messages/list.json",t,{fullResponse:!0});return new Jc.WelcomeDmV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}newWelcomeDmRule(e){return this.post("direct_messages/welcome_messages/rules/new.json",{welcome_message_rule:{welcome_message_id:e}},{forceBodyMode:"json"})}getWelcomeDmRule(e){return this.get("direct_messages/welcome_messages/rules/show.json",{id:e})}deleteWelcomeDmRule(e){return this.delete("direct_messages/welcome_messages/rules/destroy.json",{id:e})}async listWelcomeDmRules(e={}){let t={...e};return this.get("direct_messages/welcome_messages/rules/list.json",t)}async setWelcomeDm(e,t=!0){var s;let a=await this.listWelcomeDmRules();if(!((s=a.welcome_message_rules)===null||s===void 0)&&s.length)for(let u of a.welcome_message_rules)await this.deleteWelcomeDmRule(u.id),t&&await this.deleteWelcomeDm(u.welcome_message_id);return this.newWelcomeDmRule(e)}markDmAsRead(e,t){return this.post("direct_messages/mark_read.json",{last_read_event_id:e,recipient_id:t},{forceBodyMode:"url"})}indicateDmTyping(e){return this.post("direct_messages/indicate_typing.json",{recipient_id:e},{forceBodyMode:"url"})}async downloadDmImage(e){if(typeof e!="string"){let s=e[rn.EDirectMessageEventTypeV1.Create].message_data.attachment;if(!s)throw new Error("The given direct message doesn't contain any attachment");e=s.media.media_url_https}let t=await this.get(e,void 0,{forceParseMode:"buffer",prefix:""});if(!t.length)throw new Error("Image not found. Make sure you are logged with credentials able to access direct messages, and check the URL.");return t}};Nt.TwitterApiv1=Ss;Nt.default=Ss});var xa=w(vs=>{"use strict";Object.defineProperty(vs,"__esModule",{value:!0});vs.TwitterV2IncludesHelper=void 0;var x=class{constructor(e){this.result=e}get tweets(){return x.tweets(this.result)}static tweets(e){var t,s;return(s=(t=e.includes)===null||t===void 0?void 0:t.tweets)!==null&&s!==void 0?s:[]}tweetById(e){return x.tweetById(this.result,e)}static tweetById(e,t){return this.tweets(e).find(s=>s.id===t)}retweet(e){return x.retweet(this.result,e)}static retweet(e,t){var s;let a=((s=t.referenced_tweets)!==null&&s!==void 0?s:[]).filter(u=>u.type==="retweeted").map(u=>u.id);return this.tweets(e).find(u=>a.includes(u.id))}quote(e){return x.quote(this.result,e)}static quote(e,t){var s;let a=((s=t.referenced_tweets)!==null&&s!==void 0?s:[]).filter(u=>u.type==="quoted").map(u=>u.id);return this.tweets(e).find(u=>a.includes(u.id))}repliedTo(e){return x.repliedTo(this.result,e)}static repliedTo(e,t){var s;let a=((s=t.referenced_tweets)!==null&&s!==void 0?s:[]).filter(u=>u.type==="replied_to").map(u=>u.id);return this.tweets(e).find(u=>a.includes(u.id))}author(e){return x.author(this.result,e)}static author(e,t){let s=t.author_id;return s?this.users(e).find(a=>a.id===s):void 0}repliedToAuthor(e){return x.repliedToAuthor(this.result,e)}static repliedToAuthor(e,t){let s=t.in_reply_to_user_id;return s?this.users(e).find(a=>a.id===s):void 0}get users(){return x.users(this.result)}static users(e){var t,s;return(s=(t=e.includes)===null||t===void 0?void 0:t.users)!==null&&s!==void 0?s:[]}userById(e){return x.userById(this.result,e)}static userById(e,t){return this.users(e).find(s=>s.id===t)}pinnedTweet(e){return x.pinnedTweet(this.result,e)}static pinnedTweet(e,t){return t.pinned_tweet_id?this.tweets(e).find(s=>s.id===t.pinned_tweet_id):void 0}get media(){return x.media(this.result)}static media(e){var t,s;return(s=(t=e.includes)===null||t===void 0?void 0:t.media)!==null&&s!==void 0?s:[]}medias(e){return x.medias(this.result,e)}static medias(e,t){var s,a;let u=(a=(s=t.attachments)===null||s===void 0?void 0:s.media_keys)!==null&&a!==void 0?a:[];return this.media(e).filter(c=>u.includes(c.media_key))}get polls(){return x.polls(this.result)}static polls(e){var t,s;return(s=(t=e.includes)===null||t===void 0?void 0:t.polls)!==null&&s!==void 0?s:[]}poll(e){return x.poll(this.result,e)}static poll(e,t){var s,a;let u=(a=(s=t.attachments)===null||s===void 0?void 0:s.poll_ids)!==null&&a!==void 0?a:[];if(u.length){let c=u[0];return this.polls(e).find(f=>f.id===c)}}get places(){return x.places(this.result)}static places(e){var t,s;return(s=(t=e.includes)===null||t===void 0?void 0:t.places)!==null&&s!==void 0?s:[]}place(e){return x.place(this.result,e)}static place(e,t){var s;let a=(s=t.geo)===null||s===void 0?void 0:s.place_id;return a?this.places(e).find(u=>u.id===a):void 0}listOwner(e){return x.listOwner(this.result,e)}static listOwner(e,t){let s=t.owner_id;return s?this.users(e).find(a=>a.id===s):void 0}spaceCreator(e){return x.spaceCreator(this.result,e)}static spaceCreator(e,t){let s=t.creator_id;return s?this.users(e).find(a=>a.id===s):void 0}spaceHosts(e){return x.spaceHosts(this.result,e)}static spaceHosts(e,t){var s;let a=(s=t.host_ids)!==null&&s!==void 0?s:[];return this.users(e).filter(u=>a.includes(u.id))}spaceSpeakers(e){return x.spaceSpeakers(this.result,e)}static spaceSpeakers(e,t){var s;let a=(s=t.speaker_ids)!==null&&s!==void 0?s:[];return this.users(e).filter(u=>a.includes(u.id))}spaceInvitedUsers(e){return x.spaceInvitedUsers(this.result,e)}static spaceInvitedUsers(e,t){var s;let a=(s=t.invited_user_ids)!==null&&s!==void 0?s:[];return this.users(e).filter(u=>a.includes(u.id))}};vs.TwitterV2IncludesHelper=x});var nn=w(wr=>{"use strict";Object.defineProperty(wr,"__esModule",{value:!0});wr.TimelineV2Paginator=wr.TwitterV2Paginator=void 0;var Zc=xa(),rp=or(),Rs=class extends rp.PreviousableTwitterPaginator{updateIncludes(e){if(e.errors&&(this._realData.errors||(this._realData.errors=[]),this._realData.errors=[...this._realData.errors,...e.errors]),!e.includes)return;this._realData.includes||(this._realData.includes={});let t=this._realData.includes;for(let[s,a]of Object.entries(e.includes))t[s]||(t[s]=[]),t[s]=[...t[s],...a]}assertUsable(){if(this.unusable)throw new Error("Unable to use this paginator to fetch more data, as it does not contain any metadata. Check .errors property for more details.")}get meta(){return this._realData.meta}get includes(){var e;return!((e=this._realData)===null||e===void 0)&&e.includes?this._includesInstance?this._includesInstance:this._includesInstance=new Zc.TwitterV2IncludesHelper(this._realData):new Zc.TwitterV2IncludesHelper(this._realData)}get errors(){var e;return(e=this._realData.errors)!==null&&e!==void 0?e:[]}get unusable(){return this.errors.length>0&&!this._realData.meta&&!this._realData.data}};wr.TwitterV2Paginator=Rs;var Fa=class extends Rs{refreshInstanceFromResult(e,t){var s;let a=e.data,u=(s=a.data)!==null&&s!==void 0?s:[];this._rateLimit=e.rateLimit,this._realData.data||(this._realData.data=[]),t?(this._realData.meta.result_count+=a.meta.result_count,this._realData.meta.next_token=a.meta.next_token,this._realData.data.push(...u)):(this._realData.meta.result_count+=a.meta.result_count,this._realData.meta.previous_token=a.meta.previous_token,this._realData.data.unshift(...u)),this.updateIncludes(a)}getNextQueryParams(e){return this.assertUsable(),{...this.injectQueryParams(e),pagination_token:this._realData.meta.next_token}}getPreviousQueryParams(e){return this.assertUsable(),{...this.injectQueryParams(e),pagination_token:this._realData.meta.previous_token}}getPageLengthFromRequest(e){var t,s;return(s=(t=e.data.data)===null||t===void 0?void 0:t.length)!==null&&s!==void 0?s:0}isFetchLastOver(e){var t;return!(!((t=e.data.data)===null||t===void 0)&&t.length)||!this.canFetchNextPage(e.data)}canFetchNextPage(e){var t;return!!(!((t=e.meta)===null||t===void 0)&&t.next_token)}};wr.TimelineV2Paginator=Fa});var ed=w(H=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});H.TweetV2ListTweetsPaginator=H.TweetV2UserLikedTweetsPaginator=H.TweetBookmarksTimelineV2Paginator=H.TweetUserMentionTimelineV2Paginator=H.TweetUserTimelineV2Paginator=H.TweetHomeTimelineV2Paginator=H.QuotedTweetsTimelineV2Paginator=H.TweetSearchAllV2Paginator=H.TweetSearchRecentV2Paginator=void 0;var Qa=nn(),Ps=class extends Qa.TwitterV2Paginator{refreshInstanceFromResult(e,t){var s;let a=e.data,u=(s=a.data)!==null&&s!==void 0?s:[];this._rateLimit=e.rateLimit,this._realData.data||(this._realData.data=[]),t?(this._realData.meta.oldest_id=a.meta.oldest_id,this._realData.meta.result_count+=a.meta.result_count,this._realData.meta.next_token=a.meta.next_token,this._realData.data.push(...u)):(this._realData.meta.newest_id=a.meta.newest_id,this._realData.meta.result_count+=a.meta.result_count,this._realData.data.unshift(...u)),this.updateIncludes(a)}getNextQueryParams(e){this.assertUsable();let t={...this.injectQueryParams(e)};return this._realData.meta.next_token?t.next_token=this._realData.meta.next_token:(t.start_time&&(t.since_id=this.dateStringToSnowflakeId(t.start_time),delete t.start_time),t.end_time&&delete t.end_time,t.until_id=this._realData.meta.oldest_id),t}getPreviousQueryParams(e){return this.assertUsable(),{...this.injectQueryParams(e),since_id:this._realData.meta.newest_id}}getPageLengthFromRequest(e){var t,s;return(s=(t=e.data.data)===null||t===void 0?void 0:t.length)!==null&&s!==void 0?s:0}isFetchLastOver(e){var t;return!(!((t=e.data.data)===null||t===void 0)&&t.length)||!this.canFetchNextPage(e.data)}canFetchNextPage(e){return!!e.meta.next_token}getItemArray(){return this.tweets}dateStringToSnowflakeId(e){let t=BigInt("1288834974657"),s=new Date(e);if(isNaN(s.valueOf()))throw new Error("Unable to convert start_time/end_time to a valid date. A ISO 8601 DateTime is excepted, please check your input.");return(BigInt(s.valueOf())-t<<BigInt("22")).toString()}get tweets(){var e;return(e=this._realData.data)!==null&&e!==void 0?e:[]}get meta(){return super.meta}},Vt=class extends Qa.TimelineV2Paginator{refreshInstanceFromResult(e,t){super.refreshInstanceFromResult(e,t);let s=e.data;t?this._realData.meta.oldest_id=s.meta.oldest_id:this._realData.meta.newest_id=s.meta.newest_id}getItemArray(){return this.tweets}get tweets(){var e;return(e=this._realData.data)!==null&&e!==void 0?e:[]}get meta(){return super.meta}},ja=class extends Ps{constructor(){super(...arguments),this._endpoint="tweets/search/recent"}};H.TweetSearchRecentV2Paginator=ja;var Ba=class extends Ps{constructor(){super(...arguments),this._endpoint="tweets/search/all"}};H.TweetSearchAllV2Paginator=Ba;var Ua=class extends Vt{constructor(){super(...arguments),this._endpoint="tweets/:id/quote_tweets"}};H.QuotedTweetsTimelineV2Paginator=Ua;var Wa=class extends Vt{constructor(){super(...arguments),this._endpoint="users/:id/timelines/reverse_chronological"}};H.TweetHomeTimelineV2Paginator=Wa;var za=class extends Vt{constructor(){super(...arguments),this._endpoint="users/:id/tweets"}};H.TweetUserTimelineV2Paginator=za;var $a=class extends Vt{constructor(){super(...arguments),this._endpoint="users/:id/mentions"}};H.TweetUserMentionTimelineV2Paginator=$a;var Na=class extends Vt{constructor(){super(...arguments),this._endpoint="users/:id/bookmarks"}};H.TweetBookmarksTimelineV2Paginator=Na;var qs=class extends Qa.TimelineV2Paginator{get tweets(){var e;return(e=this._realData.data)!==null&&e!==void 0?e:[]}get meta(){return super.meta}getItemArray(){return this.tweets}},Va=class extends qs{constructor(){super(...arguments),this._endpoint="users/:id/liked_tweets"}};H.TweetV2UserLikedTweetsPaginator=Va;var Ha=class extends qs{constructor(){super(...arguments),this._endpoint="lists/:id/tweets"}};H.TweetV2ListTweetsPaginator=Ha});var ro=w(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});J.TweetRetweetersUsersV2Paginator=J.TweetLikingUsersV2Paginator=J.UserListFollowersV2Paginator=J.UserListMembersV2Paginator=J.UserFollowingV2Paginator=J.UserFollowersV2Paginator=J.UserMutingUsersV2Paginator=J.UserBlockingUsersV2Paginator=void 0;var np=nn(),Je=class extends np.TimelineV2Paginator{getItemArray(){return this.users}get users(){var e;return(e=this._realData.data)!==null&&e!==void 0?e:[]}get meta(){return super.meta}},Ya=class extends Je{constructor(){super(...arguments),this._endpoint="users/:id/blocking"}};J.UserBlockingUsersV2Paginator=Ya;var Xa=class extends Je{constructor(){super(...arguments),this._endpoint="users/:id/muting"}};J.UserMutingUsersV2Paginator=Xa;var Ka=class extends Je{constructor(){super(...arguments),this._endpoint="users/:id/followers"}};J.UserFollowersV2Paginator=Ka;var Ga=class extends Je{constructor(){super(...arguments),this._endpoint="users/:id/following"}};J.UserFollowingV2Paginator=Ga;var Ja=class extends Je{constructor(){super(...arguments),this._endpoint="lists/:id/members"}};J.UserListMembersV2Paginator=Ja;var Za=class extends Je{constructor(){super(...arguments),this._endpoint="lists/:id/followers"}};J.UserListFollowersV2Paginator=Za;var eo=class extends Je{constructor(){super(...arguments),this._endpoint="tweets/:id/liking_users"}};J.TweetLikingUsersV2Paginator=eo;var to=class extends Je{constructor(){super(...arguments),this._endpoint="tweets/:id/retweeted_by"}};J.TweetRetweetersUsersV2Paginator=to});var td=w(vt=>{"use strict";Object.defineProperty(vt,"__esModule",{value:!0});vt.UserListFollowedV2Paginator=vt.UserListMembershipsV2Paginator=vt.UserOwnedListsV2Paginator=void 0;var sp=nn(),sn=class extends sp.TimelineV2Paginator{getItemArray(){return this.lists}get lists(){var e;return(e=this._realData.data)!==null&&e!==void 0?e:[]}get meta(){return super.meta}},no=class extends sn{constructor(){super(...arguments),this._endpoint="users/:id/owned_lists"}};vt.UserOwnedListsV2Paginator=no;var so=class extends sn{constructor(){super(...arguments),this._endpoint="users/:id/list_memberships"}};vt.UserListMembershipsV2Paginator=so;var io=class extends sn{constructor(){super(...arguments),this._endpoint="users/:id/followed_lists"}};vt.UserListFollowedV2Paginator=io});var ao=w(ee=>{"use strict";var ip=ee&&ee.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,a)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),ze=ee&&ee.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ip(e,r,t)};Object.defineProperty(ee,"__esModule",{value:!0});ze(ed(),ee);ze(or(),ee);ze(zi(),ee);ze(ha(),ee);ze(ca(),ee);ze(Sa(),ee);ze(ro(),ee);ze(Da(),ee);ze(td(),ee);ze(ya(),ee);ze(_a(),ee)});var uo=w(an=>{"use strict";var ap=an&&an.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(an,"__esModule",{value:!0});var op=ap(_s()),up=Be(),oo=class extends op.default{constructor(){super(...arguments),this._prefix=up.API_V2_LABS_PREFIX}};an.default=oo});var rd=w(Ze=>{"use strict";Object.defineProperty(Ze,"__esModule",{value:!0});Ze.ConversationDMTimelineV2Paginator=Ze.OneToOneDMTimelineV2Paginator=Ze.FullDMTimelineV2Paginator=Ze.DMTimelineV2Paginator=void 0;var lp=nn(),yr=class extends lp.TimelineV2Paginator{getItemArray(){return this.events}get events(){var e;return(e=this._realData.data)!==null&&e!==void 0?e:[]}get meta(){return super.meta}};Ze.DMTimelineV2Paginator=yr;var lo=class extends yr{constructor(){super(...arguments),this._endpoint="dm_events"}};Ze.FullDMTimelineV2Paginator=lo;var co=class extends yr{constructor(){super(...arguments),this._endpoint="dm_conversations/with/:participant_id/dm_events"}};Ze.OneToOneDMTimelineV2Paginator=co;var fo=class extends yr{constructor(){super(...arguments),this._endpoint="dm_conversations/:dm_conversation_id/dm_events"}};Ze.ConversationDMTimelineV2Paginator=fo});var _o=w(on=>{"use strict";var nd=on&&on.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(on,"__esModule",{value:!0});var cp=nd(_s()),dp=Be(),Ie=ao(),fp=nd(uo()),Rt=ro(),ho=Tt(),mo=rd(),po=class extends cp.default{constructor(){super(...arguments),this._prefix=dp.API_V2_PREFIX}get labs(){return this._labs?this._labs:this._labs=new fp.default(this)}async search(e,t={}){let s=typeof e=="string"?{...t,query:e}:{...e},a=await this.get("tweets/search/recent",s,{fullResponse:!0});return new Ie.TweetSearchRecentV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:s})}async searchAll(e,t={}){let s={...t,query:e},a=await this.get("tweets/search/all",s,{fullResponse:!0});return new Ie.TweetSearchAllV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:s})}singleTweet(e,t={}){return this.get("tweets/:id",t,{params:{id:e}})}tweets(e,t={}){return this.get("tweets",{ids:e,...t})}tweetCountRecent(e,t={}){return this.get("tweets/counts/recent",{query:e,...t})}tweetCountAll(e,t={}){return this.get("tweets/counts/all",{query:e,...t})}async tweetRetweetedBy(e,t={}){let{asPaginator:s,...a}=t,u=await this.get("tweets/:id/retweeted_by",a,{fullResponse:!0,params:{id:e}});return s?new Rt.TweetRetweetersUsersV2Paginator({realData:u.data,rateLimit:u.rateLimit,instance:this,queryParams:a,sharedParams:{id:e}}):u.data}async tweetLikedBy(e,t={}){let{asPaginator:s,...a}=t,u=await this.get("tweets/:id/liking_users",a,{fullResponse:!0,params:{id:e}});return s?new Rt.TweetLikingUsersV2Paginator({realData:u.data,rateLimit:u.rateLimit,instance:this,queryParams:a,sharedParams:{id:e}}):u.data}async homeTimeline(e={}){let t=await this.getCurrentUserV2Object(),s=await this.get("users/:id/timelines/reverse_chronological",e,{fullResponse:!0,params:{id:t.data.id}});return new Ie.TweetHomeTimelineV2Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:e,sharedParams:{id:t.data.id}})}async userTimeline(e,t={}){let s=await this.get("users/:id/tweets",t,{fullResponse:!0,params:{id:e}});return new Ie.TweetUserTimelineV2Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t,sharedParams:{id:e}})}async userMentionTimeline(e,t={}){let s=await this.get("users/:id/mentions",t,{fullResponse:!0,params:{id:e}});return new Ie.TweetUserMentionTimelineV2Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t,sharedParams:{id:e}})}async quotes(e,t={}){let s=await this.get("tweets/:id/quote_tweets",t,{fullResponse:!0,params:{id:e}});return new Ie.QuotedTweetsTimelineV2Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t,sharedParams:{id:e}})}async bookmarks(e={}){let t=await this.getCurrentUserV2Object(),s=await this.get("users/:id/bookmarks",e,{fullResponse:!0,params:{id:t.data.id}});return new Ie.TweetBookmarksTimelineV2Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:e,sharedParams:{id:t.data.id}})}me(e={}){return this.get("users/me",e)}user(e,t={}){return this.get("users/:id",t,{params:{id:e}})}users(e,t={}){let s=Array.isArray(e)?e.join(","):e;return this.get("users",{...t,ids:s})}userByUsername(e,t={}){return this.get("users/by/username/:username",t,{params:{username:e}})}usersByUsernames(e,t={}){return e=Array.isArray(e)?e.join(","):e,this.get("users/by",{...t,usernames:e})}async followers(e,t={}){let{asPaginator:s,...a}=t,u={id:e};if(!s)return this.get("users/:id/followers",a,{params:u});let c=await this.get("users/:id/followers",a,{fullResponse:!0,params:u});return new Rt.UserFollowersV2Paginator({realData:c.data,rateLimit:c.rateLimit,instance:this,queryParams:a,sharedParams:u})}async following(e,t={}){let{asPaginator:s,...a}=t,u={id:e};if(!s)return this.get("users/:id/following",a,{params:u});let c=await this.get("users/:id/following",a,{fullResponse:!0,params:u});return new Rt.UserFollowingV2Paginator({realData:c.data,rateLimit:c.rateLimit,instance:this,queryParams:a,sharedParams:u})}async userLikedTweets(e,t={}){let s={id:e},a=await this.get("users/:id/liked_tweets",t,{fullResponse:!0,params:s});return new Ie.TweetV2UserLikedTweetsPaginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:{...t},sharedParams:s})}async userBlockingUsers(e,t={}){let s={id:e},a=await this.get("users/:id/blocking",t,{fullResponse:!0,params:s});return new Rt.UserBlockingUsersV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:{...t},sharedParams:s})}async userMutingUsers(e,t={}){let s={id:e},a=await this.get("users/:id/muting",t,{fullResponse:!0,params:s});return new Rt.UserMutingUsersV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:{...t},sharedParams:s})}list(e,t={}){return this.get("lists/:id",t,{params:{id:e}})}async listsOwned(e,t={}){let s={id:e},a=await this.get("users/:id/owned_lists",t,{fullResponse:!0,params:s});return new Ie.UserOwnedListsV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:{...t},sharedParams:s})}async listMemberships(e,t={}){let s={id:e},a=await this.get("users/:id/list_memberships",t,{fullResponse:!0,params:s});return new Ie.UserListMembershipsV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:{...t},sharedParams:s})}async listFollowed(e,t={}){let s={id:e},a=await this.get("users/:id/followed_lists",t,{fullResponse:!0,params:s});return new Ie.UserListFollowedV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:{...t},sharedParams:s})}async listTweets(e,t={}){let s={id:e},a=await this.get("lists/:id/tweets",t,{fullResponse:!0,params:s});return new Ie.TweetV2ListTweetsPaginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:{...t},sharedParams:s})}async listMembers(e,t={}){let s={id:e},a=await this.get("lists/:id/members",t,{fullResponse:!0,params:s});return new Rt.UserListMembersV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:{...t},sharedParams:s})}async listFollowers(e,t={}){let s={id:e},a=await this.get("lists/:id/followers",t,{fullResponse:!0,params:s});return new Rt.UserListFollowersV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:{...t},sharedParams:s})}async listDmEvents(e={}){let t=await this.get("dm_events",e,{fullResponse:!0});return new mo.FullDMTimelineV2Paginator({realData:t.data,rateLimit:t.rateLimit,instance:this,queryParams:{...e}})}async listDmEventsWithParticipant(e,t={}){let s={participant_id:e},a=await this.get("dm_conversations/with/:participant_id/dm_events",t,{fullResponse:!0,params:s});return new mo.OneToOneDMTimelineV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:{...t},sharedParams:s})}async listDmEventsOfConversation(e,t={}){let s={dm_conversation_id:e},a=await this.get("dm_conversations/:dm_conversation_id/dm_events",t,{fullResponse:!0,params:s});return new mo.ConversationDMTimelineV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:{...t},sharedParams:s})}space(e,t={}){return this.get("spaces/:id",t,{params:{id:e}})}spaces(e,t={}){return this.get("spaces",{ids:e,...t})}spacesByCreators(e,t={}){return this.get("spaces/by/creator_ids",{user_ids:e,...t})}searchSpaces(e){return this.get("spaces/search",e)}spaceBuyers(e,t={}){return this.get("spaces/:id/buyers",t,{params:{id:e}})}spaceTweets(e,t={}){return this.get("spaces/:id/tweets",t,{params:{id:e}})}searchStream({autoConnect:e,...t}={}){return this.getStream("tweets/search/stream",t,{payloadIsError:ho.isTweetStreamV2ErrorPayload,autoConnect:e})}streamRules(e={}){return this.get("tweets/search/stream/rules",e)}updateStreamRules(e,t={}){return this.post("tweets/search/stream/rules",e,{query:t})}sampleStream({autoConnect:e,...t}={}){return this.getStream("tweets/sample/stream",t,{payloadIsError:ho.isTweetStreamV2ErrorPayload,autoConnect:e})}sample10Stream({autoConnect:e,...t}={}){return this.getStream("tweets/sample10/stream",t,{payloadIsError:ho.isTweetStreamV2ErrorPayload,autoConnect:e})}complianceJobs(e){return this.get("compliance/jobs",e)}complianceJob(e){return this.get("compliance/jobs/:id",void 0,{params:{id:e}})}async sendComplianceJob(e){let t=await this.post("compliance/jobs",{type:e.type,name:e.name}),s=e.ids instanceof Buffer?e.ids:Buffer.from(e.ids.join(`
`));return await this.put(t.data.upload_url,s,{forceBodyMode:"raw",enableAuth:!1,headers:{"Content-Type":"text/plain"},prefix:""}),t}async complianceJobResult(e){let t=e;for(;t.status!=="complete";){if(t.status==="expired"||t.status==="failed")throw new Error("Job failed to be completed.");await new Promise(a=>setTimeout(a,3500)),t=(await this.complianceJob(e.id)).data}return(await this.get(e.download_url,void 0,{enableAuth:!1,prefix:""})).trim().split(`
`).filter(a=>a).map(a=>JSON.parse(a))}};on.default=po});var wo=w(un=>{"use strict";var hp=un&&un.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(un,"__esModule",{value:!0});var mp=Be(),pp=hp(uo()),go=class extends pp.default{constructor(){super(...arguments),this._prefix=mp.API_V2_LABS_PREFIX}get readOnly(){return this}};un.default=go});var bo=w(ln=>{"use strict";var sd=ln&&ln.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ln,"__esModule",{value:!0});var _p=Be(),gp=sd(_o()),wp=sd(wo()),yo=class extends gp.default{constructor(){super(...arguments),this._prefix=_p.API_V2_PREFIX}get readOnly(){return this}get labs(){return this._labs?this._labs:this._labs=new wp.default(this)}hideReply(e,t){return this.put("tweets/:id/hidden",{hidden:t},{params:{id:e}})}like(e,t){return this.post("users/:id/likes",{tweet_id:t},{params:{id:e}})}unlike(e,t){return this.delete("users/:id/likes/:tweet_id",void 0,{params:{id:e,tweet_id:t}})}retweet(e,t){return this.post("users/:id/retweets",{tweet_id:t},{params:{id:e}})}unretweet(e,t){return this.delete("users/:id/retweets/:tweet_id",void 0,{params:{id:e,tweet_id:t}})}tweet(e,t={}){return typeof e=="object"?t=e:t={text:e,...t},this.post("tweets",t)}reply(e,t,s={}){var a;let u={in_reply_to_tweet_id:t,...(a=s.reply)!==null&&a!==void 0?a:{}};return this.post("tweets",{text:e,...s,reply:u})}quote(e,t,s={}){return this.tweet(e,{...s,quote_tweet_id:t})}async tweetThread(e){var t,s;let a=[];for(let u of e){let c=a.length?a[a.length-1]:null,f={...typeof u=="string"?{text:u}:u},m=c?c.data.id:(t=f.reply)===null||t===void 0?void 0:t.in_reply_to_tweet_id,S=(s=f.text)!==null&&s!==void 0?s:"";m?a.push(await this.reply(S,m,f)):a.push(await this.tweet(S,f))}return a}deleteTweet(e){return this.delete("tweets/:id",void 0,{params:{id:e}})}async bookmark(e){let t=await this.getCurrentUserV2Object();return this.post("users/:id/bookmarks",{tweet_id:e},{params:{id:t.data.id}})}async deleteBookmark(e){let t=await this.getCurrentUserV2Object();return this.delete("users/:id/bookmarks/:tweet_id",void 0,{params:{id:t.data.id,tweet_id:e}})}follow(e,t){return this.post("users/:id/following",{target_user_id:t},{params:{id:e}})}unfollow(e,t){return this.delete("users/:source_user_id/following/:target_user_id",void 0,{params:{source_user_id:e,target_user_id:t}})}block(e,t){return this.post("users/:id/blocking",{target_user_id:t},{params:{id:e}})}unblock(e,t){return this.delete("users/:source_user_id/blocking/:target_user_id",void 0,{params:{source_user_id:e,target_user_id:t}})}mute(e,t){return this.post("users/:id/muting",{target_user_id:t},{params:{id:e}})}unmute(e,t){return this.delete("users/:source_user_id/muting/:target_user_id",void 0,{params:{source_user_id:e,target_user_id:t}})}createList(e){return this.post("lists",e)}updateList(e,t={}){return this.put("lists/:id",t,{params:{id:e}})}removeList(e){return this.delete("lists/:id",void 0,{params:{id:e}})}addListMember(e,t){return this.post("lists/:id/members",{user_id:t},{params:{id:e}})}removeListMember(e,t){return this.delete("lists/:id/members/:user_id",void 0,{params:{id:e,user_id:t}})}subscribeToList(e,t){return this.post("users/:id/followed_lists",{list_id:t},{params:{id:e}})}unsubscribeOfList(e,t){return this.delete("users/:id/followed_lists/:list_id",void 0,{params:{id:e,list_id:t}})}pinList(e,t){return this.post("users/:id/pinned_lists",{list_id:t},{params:{id:e}})}unpinList(e,t){return this.delete("users/:id/pinned_lists/:list_id",void 0,{params:{id:e,list_id:t}})}sendDmInConversation(e,t){return this.post("dm_conversations/:dm_conversation_id/messages",t,{params:{dm_conversation_id:e}})}sendDmToParticipant(e,t){return this.post("dm_conversations/with/:participant_id/messages",t,{params:{participant_id:e}})}createDmConversation(e){return this.post("dm_conversations",e)}};ln.default=yo});var To=w(Ht=>{"use strict";var yp=Ht&&Ht.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ht,"__esModule",{value:!0});Ht.TwitterApiv2Labs=void 0;var bp=Be(),Tp=yp(wo()),As=class extends Tp.default{constructor(){super(...arguments),this._prefix=bp.API_V2_LABS_PREFIX}get readWrite(){return this}};Ht.TwitterApiv2Labs=As;Ht.default=As});var So=w(Qt=>{"use strict";var id=Qt&&Qt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Qt,"__esModule",{value:!0});Qt.TwitterApiv2=void 0;var Sp=Be(),vp=id(bo()),Rp=id(To()),Ds=class extends vp.default{constructor(){super(...arguments),this._prefix=Sp.API_V2_PREFIX}get readWrite(){return this}get labs(){return this._labs?this._labs:this._labs=new Rp.default(this)}};Qt.TwitterApiv2=Ds;Qt.default=Ds});var Po=w(cn=>{"use strict";var dn=cn&&cn.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(cn,"__esModule",{value:!0});var Ls=dn(Cs()),Pp=dn(na()),qp=dn(ka()),Ap=dn(_o()),vo=ta(),Dp=dn(Zi()),Ro=class extends Pp.default{get v1(){return this._v1?this._v1:this._v1=new qp.default(this)}get v2(){return this._v2?this._v2:this._v2=new Ap.default(this)}async currentUser(e=!1){return await this.getCurrentUserObject(e)}async currentUserV2(e=!1){return await this.getCurrentUserV2Object(e)}search(e,t){return this.v2.search(e,t)}async generateAuthLink(e="oob",{authAccessType:t,linkMode:s="authenticate",forceLogin:a,screenName:u}={}){let c=await this.post("https://api.twitter.com/oauth/request_token",{oauth_callback:e,x_auth_access_type:t}),f=`https://api.twitter.com/oauth/${s}?oauth_token=${encodeURIComponent(c.oauth_token)}`;return a!==void 0&&(f+=`&force_login=${encodeURIComponent(a)}`),u!==void 0&&(f+=`&screen_name=${encodeURIComponent(u)}`),this._requestMaker.hasPlugins()&&this._requestMaker.applyPluginMethod("onOAuth1RequestToken",{client:this._requestMaker,url:f,oauthResult:c}),{url:f,...c}}async login(e){let t=this.getActiveTokens();if(t.type!=="oauth-1.0a")throw new Error("You must setup TwitterApi instance with consumer keys to accept OAuth 1.0 login");let s=await this.post("https://api.twitter.com/oauth/access_token",{oauth_token:t.accessToken,oauth_verifier:e}),a=new Ls.default({appKey:t.appKey,appSecret:t.appSecret,accessToken:s.oauth_token,accessSecret:s.oauth_token_secret},this._requestMaker.clientSettings);return{accessToken:s.oauth_token,accessSecret:s.oauth_token_secret,userId:s.user_id,screenName:s.screen_name,client:a}}async appLogin(){let e=this.getActiveTokens();if(e.type!=="oauth-1.0a")throw new Error("You must setup TwitterApi instance with consumer keys to accept app-only login");let s=await new Ls.default({username:e.appKey,password:e.appSecret},this._requestMaker.clientSettings).post("https://api.twitter.com/oauth2/token",{grant_type:"client_credentials"});return new Ls.default(s.access_token,this._requestMaker.clientSettings)}generateOAuth2AuthLink(e,t={}){var s,a;if(!this._requestMaker.clientId)throw new Error("Twitter API instance is not initialized with client ID. You can find your client ID in Twitter Developer Portal. Please build an instance with: new TwitterApi({ clientId: '<yourClientId>' })");let u=(s=t.state)!==null&&s!==void 0?s:vo.OAuth2Helper.generateRandomString(32),c=vo.OAuth2Helper.getCodeVerifier(),f=vo.OAuth2Helper.getCodeChallengeFromVerifier(c),m=(a=t.scope)!==null&&a!==void 0?a:"",S=Array.isArray(m)?m.join(" "):m,b=new URL("https://twitter.com/i/oauth2/authorize"),T={response_type:"code",client_id:this._requestMaker.clientId,redirect_uri:e,state:u,code_challenge:f,code_challenge_method:"s256",scope:S};Dp.default.addQueryParamsToUrl(b,T);let g={url:b.toString(),state:u,codeVerifier:c,codeChallenge:f};return this._requestMaker.hasPlugins()&&this._requestMaker.applyPluginMethod("onOAuth2RequestToken",{client:this._requestMaker,result:g,redirectUri:e}),g}async loginWithOAuth2({code:e,codeVerifier:t,redirectUri:s}){if(!this._requestMaker.clientId)throw new Error("Twitter API instance is not initialized with client ID. Please build an instance with: new TwitterApi({ clientId: '<yourClientId>' })");let a=await this.post("https://api.twitter.com/2/oauth2/token",{code:e,code_verifier:t,redirect_uri:s,grant_type:"authorization_code",client_id:this._requestMaker.clientId,client_secret:this._requestMaker.clientSecret});return this.parseOAuth2AccessTokenResult(a)}async refreshOAuth2Token(e){if(!this._requestMaker.clientId)throw new Error("Twitter API instance is not initialized with client ID. Please build an instance with: new TwitterApi({ clientId: '<yourClientId>' })");let t=await this.post("https://api.twitter.com/2/oauth2/token",{refresh_token:e,grant_type:"refresh_token",client_id:this._requestMaker.clientId,client_secret:this._requestMaker.clientSecret});return this.parseOAuth2AccessTokenResult(t)}async revokeOAuth2Token(e,t="access_token"){if(!this._requestMaker.clientId)throw new Error("Twitter API instance is not initialized with client ID. Please build an instance with: new TwitterApi({ clientId: '<yourClientId>' })");return await this.post("https://api.twitter.com/2/oauth2/revoke",{client_id:this._requestMaker.clientId,client_secret:this._requestMaker.clientSecret,token:e,token_type_hint:t})}parseOAuth2AccessTokenResult(e){let t=new Ls.default(e.access_token,this._requestMaker.clientSettings),s=e.scope.split(" ").filter(a=>a);return{client:t,expiresIn:e.expires_in,accessToken:e.access_token,scope:s,refreshToken:e.refresh_token}}};cn.default=Ro});var Do=w(fn=>{"use strict";var Ao=fn&&fn.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(fn,"__esModule",{value:!0});var Lp=Ao(Ma()),Cp=Ao(bo()),Ip=Ao(Po()),qo=class extends Ip.default{get v1(){return this._v1?this._v1:this._v1=new Lp.default(this)}get v2(){return this._v2?this._v2:this._v2=new Cp.default(this)}get readOnly(){return this}};fn.default=qo});var Cs=w($e=>{"use strict";var hn=$e&&$e.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty($e,"__esModule",{value:!0});$e.TwitterApiReadOnly=$e.TwitterApiReadWrite=$e.TwitterApi=void 0;var kp=hn(ys()),Ep=hn(So()),Op=hn(Do()),Is=class extends Op.default{get v1(){return this._v1?this._v1:this._v1=new kp.default(this)}get v2(){return this._v2?this._v2:this._v2=new Ep.default(this)}get readWrite(){return this}static getErrors(e){var t;return typeof e!="object"?[]:"data"in e?(t=e.data.errors)!==null&&t!==void 0?t:[]:[]}static getProfileImageInSize(e,t){let s=e.split("/").pop(),a=["normal","bigger","mini"],u=e;for(let f of a)if(s.includes(`_${f}`)){u=e.replace(`_${f}`,"");break}if(t==="original")return u;let c=u.lastIndexOf(".");if(c!==-1){let f=u.slice(c+1);return u.slice(0,c)+"_"+t+"."+f}else return u+"_"+t}};$e.TwitterApi=Is;var Mp=Do();Object.defineProperty($e,"TwitterApiReadWrite",{enumerable:!0,get:function(){return hn(Mp).default}});var xp=Po();Object.defineProperty($e,"TwitterApiReadOnly",{enumerable:!0,get:function(){return hn(xp).default}});$e.default=Is});var Lo=w(K=>{"use strict";var Fp=K&&K.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,a)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),ct=K&&K.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Fp(e,r,t)},jp=K&&K.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(K,"__esModule",{value:!0});K.default=void 0;var Bp=Cs();Object.defineProperty(K,"default",{enumerable:!0,get:function(){return jp(Bp).default}});ct(Cs(),K);ct(ys(),K);ct(So(),K);ct(xa(),K);ct(To(),K);ct(Ye(),K);ct(ao(),K);ct(cs(),K);ct(us(),K)});var d_={};mh(d_,{default:()=>xd});module.exports=ph(d_);var xl=require("@raycast/api");var zr=require("@raycast/api");var Cl=He(require("http"),1),Il=He(require("https"),1),Et=He(require("zlib"),1),be=He(require("stream"),1),kl=He(cl(),1);var qe=He(require("stream"),1),ki=require("util");var g_=He(hl(),1),ml=65536;async function*Di(r,e=!0){for(let t of r)if("stream"in t)yield*t.stream();else if(ArrayBuffer.isView(t))if(e){let s=t.byteOffset,a=t.byteOffset+t.byteLength;for(;s!==a;){let u=Math.min(a-s,ml),c=t.buffer.slice(s,s+u);s+=c.byteLength,yield new Uint8Array(c)}}else yield t;else{let s=0;for(;s!==t.size;){let u=await t.slice(s,Math.min(t.size,s+ml)).arrayBuffer();s+=u.byteLength,yield new Uint8Array(u)}}}var pl=class Li{#e=[];#r="";#t=0;constructor(e=[],t={}){let s=0,a=e.map(c=>{let f;return ArrayBuffer.isView(c)?f=new Uint8Array(c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)):c instanceof ArrayBuffer?f=new Uint8Array(c.slice(0)):c instanceof Li?f=c:f=new TextEncoder().encode(c),s+=ArrayBuffer.isView(f)?f.byteLength:f.size,f}),u=t.type===void 0?"":String(t.type);this.#r=/[^\u0020-\u007E]/.test(u)?"":u,this.#t=s,this.#e=a}get size(){return this.#t}get type(){return this.#r}async text(){let e=new TextDecoder,t="";for await(let s of Di(this.#e,!1))t+=e.decode(s,{stream:!0});return t+=e.decode(),t}async arrayBuffer(){let e=new Uint8Array(this.size),t=0;for await(let s of Di(this.#e,!1))e.set(s,t),t+=s.length;return e.buffer}stream(){let e=Di(this.#e,!0);return new ReadableStream({type:"bytes",async pull(t){let s=await e.next();s.done?t.close():t.enqueue(s.value)}})}slice(e=0,t=this.size,s=""){let{size:a}=this,u=e<0?Math.max(a+e,0):Math.min(e,a),c=t<0?Math.max(a+t,0):Math.min(t,a),f=Math.max(c-u,0),m=this.#e,S=[],b=0;for(let g of m){if(b>=f)break;let p=ArrayBuffer.isView(g)?g.byteLength:g.size;if(u&&p<=u)u-=p,c-=p;else{let D;ArrayBuffer.isView(g)?(D=g.subarray(u,Math.min(p,c)),b+=D.byteLength):(D=g.slice(u,Math.min(p,c)),b+=D.size),S.push(D),u=0}}let T=new Li([],{type:String(s).toLowerCase()});return T.#t=f,T.#e=S,T}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](e){return e&&typeof e=="object"&&typeof e.constructor=="function"&&(typeof e.stream=="function"||typeof e.arrayBuffer=="function")&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}};Object.defineProperties(pl.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});var gh=pl,_l=gh;var st=class extends Error{constructor(e,t){super(e),Error.captureStackTrace(this,this.constructor),this.type=t}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var we=class extends st{constructor(e,t,s){super(e,t),s&&(this.code=this.errno=s.code,this.erroredSysCall=s.syscall)}};var wl=require("crypto");var Br=Symbol.toStringTag,Ci=r=>typeof r=="object"&&typeof r.append=="function"&&typeof r.delete=="function"&&typeof r.get=="function"&&typeof r.getAll=="function"&&typeof r.has=="function"&&typeof r.set=="function"&&typeof r.sort=="function"&&r[Br]==="URLSearchParams",Qe=r=>typeof r=="object"&&typeof r.arrayBuffer=="function"&&typeof r.type=="string"&&typeof r.stream=="function"&&typeof r.constructor=="function"&&/^(Blob|File)$/.test(r[Br]);function Kn(r){return typeof r=="object"&&typeof r.append=="function"&&typeof r.set=="function"&&typeof r.get=="function"&&typeof r.getAll=="function"&&typeof r.delete=="function"&&typeof r.keys=="function"&&typeof r.values=="function"&&typeof r.entries=="function"&&typeof r.constructor=="function"&&r[Br]==="FormData"}var gl=r=>typeof r=="object"&&(r[Br]==="AbortSignal"||r[Br]==="EventTarget");var sr=`\r
`,Ii="-".repeat(2),wh=Buffer.byteLength(sr),yl=r=>`${Ii}${r}${Ii}${sr.repeat(2)}`;function bl(r,e,t){let s="";return s+=`${Ii}${r}${sr}`,s+=`Content-Disposition: form-data; name="${e}"`,Qe(t)&&(s+=`; filename="${t.name}"${sr}`,s+=`Content-Type: ${t.type||"application/octet-stream"}`),`${s}${sr.repeat(2)}`}var Tl=()=>(0,wl.randomBytes)(8).toString("hex");async function*Sl(r,e){for(let[t,s]of r)yield bl(e,t,s),Qe(s)?yield*s.stream():yield s,yield sr;yield yl(e)}function vl(r,e){let t=0;for(let[s,a]of r)t+=Buffer.byteLength(bl(e,s,a)),t+=Qe(a)?a.size:Buffer.byteLength(String(a)),t+=wh;return t+=Buffer.byteLength(yl(e)),t}var ye=Symbol("Body internals"),bt=class{constructor(e,{size:t=0}={}){let s=null;e===null?e=null:Ci(e)?e=Buffer.from(e.toString()):Qe(e)||Buffer.isBuffer(e)||(ki.types.isAnyArrayBuffer(e)?e=Buffer.from(e):ArrayBuffer.isView(e)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof qe.default||(Kn(e)?(s=`NodeFetchFormDataBoundary${Tl()}`,e=qe.default.Readable.from(Sl(e,s))):e=Buffer.from(String(e)))),this[ye]={body:e,boundary:s,disturbed:!1,error:null},this.size=t,e instanceof qe.default&&e.on("error",a=>{let u=a instanceof st?a:new we(`Invalid response body while trying to fetch ${this.url}: ${a.message}`,"system",a);this[ye].error=u})}get body(){return this[ye].body}get bodyUsed(){return this[ye].disturbed}async arrayBuffer(){let{buffer:e,byteOffset:t,byteLength:s}=await Gn(this);return e.slice(t,t+s)}async blob(){let e=this.headers&&this.headers.get("content-type")||this[ye].body&&this[ye].body.type||"",t=await this.buffer();return new _l([t],{type:e})}async json(){let e=await Gn(this);return JSON.parse(e.toString())}async text(){return(await Gn(this)).toString()}buffer(){return Gn(this)}};Object.defineProperties(bt.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}});async function Gn(r){if(r[ye].disturbed)throw new TypeError(`body used already for: ${r.url}`);if(r[ye].disturbed=!0,r[ye].error)throw r[ye].error;let{body:e}=r;if(e===null)return Buffer.alloc(0);if(Qe(e)&&(e=qe.default.Readable.from(e.stream())),Buffer.isBuffer(e))return e;if(!(e instanceof qe.default))return Buffer.alloc(0);let t=[],s=0;try{for await(let a of e){if(r.size>0&&s+a.length>r.size){let u=new we(`content size at ${r.url} over limit: ${r.size}`,"max-size");throw e.destroy(u),u}s+=a.length,t.push(a)}}catch(a){throw a instanceof st?a:new we(`Invalid response body while trying to fetch ${r.url}: ${a.message}`,"system",a)}if(e.readableEnded===!0||e._readableState.ended===!0)try{return t.every(a=>typeof a=="string")?Buffer.from(t.join("")):Buffer.concat(t,s)}catch(a){throw new we(`Could not create Buffer from response body for ${r.url}: ${a.message}`,"system",a)}else throw new we(`Premature close of server response while trying to fetch ${r.url}`)}var Jn=(r,e)=>{let t,s,{body:a}=r;if(r.bodyUsed)throw new Error("cannot clone body after it is used");return a instanceof qe.default&&typeof a.getBoundary!="function"&&(t=new qe.PassThrough({highWaterMark:e}),s=new qe.PassThrough({highWaterMark:e}),a.pipe(t),a.pipe(s),r[ye].body=t,a=s),a},Zn=(r,e)=>r===null?null:typeof r=="string"?"text/plain;charset=UTF-8":Ci(r)?"application/x-www-form-urlencoded;charset=UTF-8":Qe(r)?r.type||null:Buffer.isBuffer(r)||ki.types.isAnyArrayBuffer(r)||ArrayBuffer.isView(r)?null:r&&typeof r.getBoundary=="function"?`multipart/form-data;boundary=${r.getBoundary()}`:Kn(r)?`multipart/form-data; boundary=${e[ye].boundary}`:r instanceof qe.default?null:"text/plain;charset=UTF-8",Rl=r=>{let{body:e}=r;return e===null?0:Qe(e)?e.size:Buffer.isBuffer(e)?e.length:e&&typeof e.getLengthSync=="function"?e.hasKnownLength&&e.hasKnownLength()?e.getLengthSync():null:Kn(e)?vl(r[ye].boundary):null},Pl=(r,{body:e})=>{e===null?r.end():Qe(e)?qe.default.Readable.from(e.stream()).pipe(r):Buffer.isBuffer(e)?(r.write(e),r.end()):e.pipe(r)};var Ei=require("util"),Ur=He(require("http"),1),es=typeof Ur.default.validateHeaderName=="function"?Ur.default.validateHeaderName:r=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(r)){let e=new TypeError(`Header name must be a valid HTTP token [${r}]`);throw Object.defineProperty(e,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),e}},Oi=typeof Ur.default.validateHeaderValue=="function"?Ur.default.validateHeaderValue:(r,e)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(e)){let t=new TypeError(`Invalid character in header content ["${r}"]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_CHAR"}),t}},fe=class extends URLSearchParams{constructor(e){let t=[];if(e instanceof fe){let s=e.raw();for(let[a,u]of Object.entries(s))t.push(...u.map(c=>[a,c]))}else if(e!=null)if(typeof e=="object"&&!Ei.types.isBoxedPrimitive(e)){let s=e[Symbol.iterator];if(s==null)t.push(...Object.entries(e));else{if(typeof s!="function")throw new TypeError("Header pairs must be iterable");t=[...e].map(a=>{if(typeof a!="object"||Ei.types.isBoxedPrimitive(a))throw new TypeError("Each header pair must be an iterable object");return[...a]}).map(a=>{if(a.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...a]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");return t=t.length>0?t.map(([s,a])=>(es(s),Oi(s,String(a)),[String(s).toLowerCase(),String(a)])):void 0,super(t),new Proxy(this,{get(s,a,u){switch(a){case"append":case"set":return(c,f)=>(es(c),Oi(c,String(f)),URLSearchParams.prototype[a].call(s,String(c).toLowerCase(),String(f)));case"delete":case"has":case"getAll":return c=>(es(c),URLSearchParams.prototype[a].call(s,String(c).toLowerCase()));case"keys":return()=>(s.sort(),new Set(URLSearchParams.prototype.keys.call(s)).keys());default:return Reflect.get(s,a,u)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(e){let t=this.getAll(e);if(t.length===0)return null;let s=t.join(", ");return/^content-encoding$/i.test(e)&&(s=s.toLowerCase()),s}forEach(e,t=void 0){for(let s of this.keys())Reflect.apply(e,t,[this.get(s),s,this])}*values(){for(let e of this.keys())yield this.get(e)}*entries(){for(let e of this.keys())yield[e,this.get(e)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((e,t)=>(e[t]=this.getAll(t),e),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((e,t)=>{let s=this.getAll(t);return t==="host"?e[t]=s[0]:e[t]=s.length>1?s:s[0],e},{})}};Object.defineProperties(fe.prototype,["get","entries","forEach","values"].reduce((r,e)=>(r[e]={enumerable:!0},r),{}));function ql(r=[]){return new fe(r.reduce((e,t,s,a)=>(s%2===0&&e.push(a.slice(s,s+2)),e),[]).filter(([e,t])=>{try{return es(e),Oi(e,String(t)),!0}catch{return!1}}))}var yh=new Set([301,302,303,307,308]),ts=r=>yh.has(r);var je=Symbol("Response internals"),ae=class extends bt{constructor(e=null,t={}){super(e,t);let s=t.status!=null?t.status:200,a=new fe(t.headers);if(e!==null&&!a.has("Content-Type")){let u=Zn(e);u&&a.append("Content-Type",u)}this[je]={type:"default",url:t.url,status:s,statusText:t.statusText||"",headers:a,counter:t.counter,highWaterMark:t.highWaterMark}}get type(){return this[je].type}get url(){return this[je].url||""}get status(){return this[je].status}get ok(){return this[je].status>=200&&this[je].status<300}get redirected(){return this[je].counter>0}get statusText(){return this[je].statusText}get headers(){return this[je].headers}get highWaterMark(){return this[je].highWaterMark}clone(){return new ae(Jn(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size})}static redirect(e,t=302){if(!ts(t))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new ae(null,{headers:{location:new URL(e).toString()},status:t})}static error(){let e=new ae(null,{status:0,statusText:""});return e[je].type="error",e}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(ae.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var Dl=require("url");var Al=r=>{if(r.search)return r.search;let e=r.href.length-1,t=r.hash||(r.href[e]==="#"?"#":"");return r.href[e-t.length]==="?"?"?":""};var it=Symbol("Request internals"),rs=r=>typeof r=="object"&&typeof r[it]=="object",at=class extends bt{constructor(e,t={}){let s;rs(e)?s=new URL(e.url):(s=new URL(e),e={});let a=t.method||e.method||"GET";if(a=a.toUpperCase(),(t.body!=null||rs(e))&&e.body!==null&&(a==="GET"||a==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let u=t.body?t.body:rs(e)&&e.body!==null?Jn(e):null;super(u,{size:t.size||e.size||0});let c=new fe(t.headers||e.headers||{});if(u!==null&&!c.has("Content-Type")){let m=Zn(u,this);m&&c.append("Content-Type",m)}let f=rs(e)?e.signal:null;if("signal"in t&&(f=t.signal),f!=null&&!gl(f))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");this[it]={method:a,redirect:t.redirect||e.redirect||"follow",headers:c,parsedURL:s,signal:f},this.follow=t.follow===void 0?e.follow===void 0?20:e.follow:t.follow,this.compress=t.compress===void 0?e.compress===void 0?!0:e.compress:t.compress,this.counter=t.counter||e.counter||0,this.agent=t.agent||e.agent,this.highWaterMark=t.highWaterMark||e.highWaterMark||16384,this.insecureHTTPParser=t.insecureHTTPParser||e.insecureHTTPParser||!1}get method(){return this[it].method}get url(){return(0,Dl.format)(this[it].parsedURL)}get headers(){return this[it].headers}get redirect(){return this[it].redirect}get signal(){return this[it].signal}clone(){return new at(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(at.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}});var Ll=r=>{let{parsedURL:e}=r[it],t=new fe(r[it].headers);t.has("Accept")||t.set("Accept","*/*");let s=null;if(r.body===null&&/^(post|put)$/i.test(r.method)&&(s="0"),r.body!==null){let f=Rl(r);typeof f=="number"&&!Number.isNaN(f)&&(s=String(f))}s&&t.set("Content-Length",s),t.has("User-Agent")||t.set("User-Agent","node-fetch"),r.compress&&!t.has("Accept-Encoding")&&t.set("Accept-Encoding","gzip,deflate,br");let{agent:a}=r;typeof a=="function"&&(a=a(e)),!t.has("Connection")&&!a&&t.set("Connection","close");let u=Al(e);return{path:e.pathname+u,pathname:e.pathname,hostname:e.hostname,protocol:e.protocol,port:e.port,hash:e.hash,search:e.search,query:e.query,href:e.href,method:r.method,headers:t[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:r.insecureHTTPParser,agent:a}};var ns=class extends st{constructor(e,t="aborted"){super(e,t)}};var bh=new Set(["data:","http:","https:"]);async function Wr(r,e){return new Promise((t,s)=>{let a=new at(r,e),u=Ll(a);if(!bh.has(u.protocol))throw new TypeError(`node-fetch cannot load ${r}. URL scheme "${u.protocol.replace(/:$/,"")}" is not supported.`);if(u.protocol==="data:"){let p=(0,kl.default)(a.url),D=new ae(p,{headers:{"Content-Type":p.typeFull}});t(D);return}let c=(u.protocol==="https:"?Il.default:Cl.default).request,{signal:f}=a,m=null,S=()=>{let p=new ns("The operation was aborted.");s(p),a.body&&a.body instanceof be.default.Readable&&a.body.destroy(p),!(!m||!m.body)&&m.body.emit("error",p)};if(f&&f.aborted){S();return}let b=()=>{S(),g()},T=c(u);f&&f.addEventListener("abort",b);let g=()=>{T.abort(),f&&f.removeEventListener("abort",b)};T.on("error",p=>{s(new we(`request to ${a.url} failed, reason: ${p.message}`,"system",p)),g()}),Th(T,p=>{m.body.destroy(p)}),process.version<"v14"&&T.on("socket",p=>{let D;p.prependListener("end",()=>{D=p._eventsCount}),p.prependListener("close",L=>{if(m&&D<p._eventsCount&&!L){let te=new Error("Premature close");te.code="ERR_STREAM_PREMATURE_CLOSE",m.body.emit("error",te)}})}),T.on("response",p=>{T.setTimeout(0);let D=ql(p.rawHeaders);if(ts(p.statusCode)){let ie=D.get("Location"),U=ie===null?null:new URL(ie,a.url);switch(a.redirect){case"error":s(new we(`uri requested responds with a redirect, redirect mode is set to error: ${a.url}`,"no-redirect")),g();return;case"manual":U!==null&&D.set("Location",U);break;case"follow":{if(U===null)break;if(a.counter>=a.follow){s(new we(`maximum redirect reached at: ${a.url}`,"max-redirect")),g();return}let N={headers:new fe(a.headers),follow:a.follow,counter:a.counter+1,agent:a.agent,compress:a.compress,method:a.method,body:a.body,signal:a.signal,size:a.size};if(p.statusCode!==303&&a.body&&e.body instanceof be.default.Readable){s(new we("Cannot follow redirect with body being a readable stream","unsupported-redirect")),g();return}(p.statusCode===303||(p.statusCode===301||p.statusCode===302)&&a.method==="POST")&&(N.method="GET",N.body=void 0,N.headers.delete("content-length")),t(Wr(new at(U,N))),g();return}default:return s(new TypeError(`Redirect option '${a.redirect}' is not a valid value of RequestRedirect`))}}f&&p.once("end",()=>{f.removeEventListener("abort",b)});let L=(0,be.pipeline)(p,new be.PassThrough,s);process.version<"v12.10"&&p.on("aborted",b);let te={url:a.url,status:p.statusCode,statusText:p.statusMessage,headers:D,size:a.size,counter:a.counter,highWaterMark:a.highWaterMark},le=D.get("Content-Encoding");if(!a.compress||a.method==="HEAD"||le===null||p.statusCode===204||p.statusCode===304){m=new ae(L,te),t(m);return}let se={flush:Et.default.Z_SYNC_FLUSH,finishFlush:Et.default.Z_SYNC_FLUSH};if(le==="gzip"||le==="x-gzip"){L=(0,be.pipeline)(L,Et.default.createGunzip(se),s),m=new ae(L,te),t(m);return}if(le==="deflate"||le==="x-deflate"){(0,be.pipeline)(p,new be.PassThrough,s).once("data",U=>{L=(U[0]&15)===8?(0,be.pipeline)(L,Et.default.createInflate(),s):(0,be.pipeline)(L,Et.default.createInflateRaw(),s),m=new ae(L,te),t(m)});return}if(le==="br"){L=(0,be.pipeline)(L,Et.default.createBrotliDecompress(),s),m=new ae(L,te),t(m);return}m=new ae(L,te),t(m)}),Pl(T,a)})}function Th(r,e){let t=Buffer.from(`0\r
\r
`),s=!1,a=!1,u;r.on("response",c=>{let{headers:f}=c;s=f["transfer-encoding"]==="chunked"&&!f["content-length"]}),r.on("socket",c=>{let f=()=>{if(s&&!a){let m=new Error("Premature close");m.code="ERR_STREAM_PREMATURE_CLOSE",e(m)}};c.prependListener("close",f),r.on("abort",()=>{c.removeListener("close",f)}),c.on("data",m=>{a=Buffer.compare(m.slice(-5),t)===0,!a&&u&&(a=Buffer.compare(u.slice(-3),t.slice(0,3))===0&&Buffer.compare(m.slice(-2),t.slice(3))===0),u=m})})}function ir(){return{source:{light:"logo.png",dark:"logo@dark.png"}}}function $r(){return(0,zr.getPreferenceValues)().clientid||""}var Ot=new zr.OAuth.PKCEClient({redirectMethod:zr.OAuth.RedirectMethod.Web,providerName:"Twitter",providerIcon:ir(),providerId:"twitter",description:"Connect your X account"});async function El(){let r=await Ot.getTokens();if(r?.accessToken){r.refreshToken&&r.isExpired()&&await Ot.setTokens(await vh(r.refreshToken));return}let e=await Ot.authorizationRequest({endpoint:"https://twitter.com/i/oauth2/authorize",clientId:$r(),scope:"tweet.read tweet.write users.read follows.read like.read like.write offline.access"}),{authorizationCode:t}=await Ot.authorize(e);await Ot.setTokens(await Sh(e,t))}async function Sh(r,e){let t=new URLSearchParams;t.append("client_id",$r()),t.append("code",e),t.append("code_verifier",r.codeVerifier),t.append("grant_type","authorization_code"),t.append("redirect_uri",r.redirectURI);let s=await Wr("https://api.twitter.com/2/oauth2/token",{method:"POST",body:t});if(!s.ok)throw console.error("fetch tokens error:",await s.text()),new Error(s.statusText);return await s.json()}async function Ol(){return await Ot.getTokens()}async function Ml(){await Ot.removeTokens()}async function vh(r){let e=new URLSearchParams;e.append("client_id",$r()),e.append("refresh_token",r),e.append("grant_type","refresh_token");let t=await Wr("https://api.twitter.com/2/oauth2/token",{method:"POST",body:e});if(!t.ok)throw console.error("refresh tokens error:",await t.text()),new Error(t.statusText);let s=await t.json();return s.refresh_token=s.refresh_token??r,s}function Fl(){let e=(0,xl.getPreferenceValues)().listwithdetail;return e===void 0?!0:e}function jl(){return!0}function Mi(){let r=$r();return!r||r===""||r==="-"}var Ns=require("@raycast/api");var E=require("@raycast/api"),bd=require("react");function he(r){return r instanceof Error?r.message:"unknown error"}var ss=(r,e)=>String(r).padStart(e,"\u2000"),Rh=new Intl.NumberFormat("en",{notation:"compact"});function ar(r){return Rh.format(r)}function xi(r){return new Promise(e=>setTimeout(e,r))}function Fi(r,e,t){return r.replace(e,t)}var R=require("@raycast/api"),zs=require("react");var ue=require("@raycast/api");var Yt=require("react"),br=He(Lo());var ad=20,od=["public_metrics","author_id","attachments","created_at","id","entities","conversation_id"],ud=["attachments.media_keys","author_id","in_reply_to_user_id","entities.mentions.username","referenced_tweets.id"],ld=["url","type","media_key","preview_image_url"];function cd(r){return{id:r.id,name:r.name,username:r.username,profile_image_url:r.profile_image_url}}var Co=class{constructor(){this.userCache={}}async getAPI(){await El();let t=(await Ol())?.accessToken;return new br.TwitterApi(t||"")}async getUserAccount(e){if(e in this.userCache)return this.userCache[e];let s=await(await this.getAPI()).v2.user(e,{"user.fields":["profile_image_url"]}),a=cd(s.data);return this.userCache[e]=a,a}async prefetchUserAccounts(e){let t=[];for(let s of e)s.author_id&&!(s.author_id in this.userCache)&&t.push(s.author_id);if(t.length>0){let a=await(await this.getAPI()).v2.users(t,{"user.fields":["profile_image_url"]});for(let u of a.data){let c=cd(u);this.userCache[c.id]=c}}}async me(){if(this.meCache)return this.meCache;let t=await(await this.getAPI()).v2.me(),s={id:t.data.id,name:t.data.name,username:t.data.username,profile_image_url:t.data.profile_image_url};return this.meCache=s,s}async getMyTweets(){let t=await(await this.getAPI()).v2.me();return await this.getTweetsFromAuthor(t.data.id,["non_public_metrics","organic_metrics"])}async getTweetsFromAuthor(e,t){let s=await this.getAPI(),a=[...od];t&&a.push(...t);let u=await s.v2.userTimeline(e,{max_results:ad,"tweet.fields":a,"media.fields":ld,expansions:ud}),c=new br.TwitterV2IncludesHelper(u),f=[];await this.prefetchUserAccounts(u);for(let m of u)f.push(await this.tweetV2ToTweet(m,c));return f}async tweetV2ToTweet(e,t){let s=e,a=t.medias(s),u;s.non_public_metrics&&(u={impression_count:s.non_public_metrics.impression_count,url_link_clicks:s.non_public_metrics.url_link_clicks});let c;s.organic_metrics&&(c={impression_count:s.organic_metrics.impression_count,url_link_clicks:s.organic_metrics.url_link_clicks,user_profile_clicks:s.organic_metrics.user_profile_clicks,retweet_count:s.organic_metrics.retweet_count,reply_count:s.organic_metrics.reply_count,like_count:s.organic_metrics.like_count});let f;if(a&&a.length>0){let S=a[0];S.type==="animated_gif"||S.type==="video"?f=S.preview_image_url:f=S.url}if(!s.author_id)throw Error("No author ID");return{id:s.id,text:s.text,created_at:s.created_at,conversation_id:s.conversation_id,source:s.source||"",image_url:f,user:await this.getUserAccount(s.author_id),quote_count:s.public_metrics?.quote_count||0,reply_count:s.public_metrics?.reply_count||0,retweet_count:s.public_metrics?.retweet_count||0,like_count:s.public_metrics?.like_count||0,non_public_metrics:u,organic_metrics:c}}async refreshTweets(e){if(e===void 0)return;let t=()=>e.length===e.filter(b=>b.non_public_metrics!==void 0).length,s=()=>e.length===e.filter(b=>b.organic_metrics!==void 0).length,a=await this.getAPI(),u=e.map(b=>b.id),c=[...od];t()&&c.push("non_public_metrics"),s()&&c.push("organic_metrics");let f=await a.v2.tweets(u,{"tweet.fields":c,"media.fields":ld,expansions:ud}),m=new br.TwitterV2IncludesHelper(f);return await Promise.all(f.data.map(async b=>await this.tweetV2ToTweet(b,m)))}async sendTweet(e){await(await this.getAPI()).v2.tweet(e)}async sendThread(e){await(await this.getAPI()).v2.tweetThread(e)}async replyTweetID(e,t){await(await this.getAPI()).v2.reply(e,t)}async replyTweet(e,t){await this.replyTweetID(e,t.id)}async retweet(e){let t=await this.getAPI(),s=await this.me();await t.v2.retweet(s.id,e.id)}async deleteTweetID(e){await(await this.getAPI()).v2.deleteTweet(e)}async deleteTweet(e){await this.deleteTweetID(e.id)}async likeTweet(e){let t=await this.getAPI(),s=await this.me();t.v2.like(s.id,e.id)}async unlikeTweet(e){let t=await this.getAPI(),s=await this.me();t.v2.unlike(s.id,e.id)}async homeTimeline(){let t=await(await this.getAPI()).v2.homeTimeline({exclude:"replies",max_results:ad,"tweet.fields":["public_metrics","author_id","attachments","created_at","id","entities","conversation_id"],"media.fields":["url","type","media_key","preview_image_url"],expansions:["attachments.media_keys","author_id","in_reply_to_user_id","entities.mentions.username","referenced_tweets.id"]}),s=new br.TwitterV2IncludesHelper(t),a=[];await this.prefetchUserAccounts(t);for(let u of t){let c=s.medias(u),f;if(c&&c.length>0){let S=c[0];S.type==="animated_gif"||S.type==="video"?f=S.preview_image_url:f=S.url}if(!u.author_id)continue;let m={id:u.id,text:u.text,created_at:u.created_at,conversation_id:u.conversation_id,source:u.source||"",image_url:f,user:await this.getUserAccount(u.author_id),quote_count:u.public_metrics?.quote_count||0,reply_count:u.public_metrics?.reply_count||0,retweet_count:u.public_metrics?.retweet_count||0,like_count:u.public_metrics?.like_count||0};a.push(m)}return a}};function Up(){return new Co}var re=Up();function Tr(r,e){let[t,s]=(0,Yt.useState)(),[a,u]=(0,Yt.useState)(),[c,f]=(0,Yt.useState)(!0),[m,S]=(0,Yt.useState)(new Date),b=[m];if(e)for(let D of e)b.push(D);let T=!1,g={updateInline:async()=>{await p(!0)},refresh:async()=>{S(new Date)}};async function p(D=!1){if(!T){f(!0),u(void 0);try{let L=await r(D);T||s(L)}catch(L){T||u(he(L))}finally{T||f(!1)}}}return(0,Yt.useEffect)(()=>(p(),()=>{T=!0}),b),{data:t,error:a,isLoading:c,fetcher:g}}var G=require("react/jsx-runtime");function dd(r){return!!(r.text&&r.text.startsWith("RT @"))}function Wp(r){if(r.text!==void 0){if(dd(r)){let e=r.text.indexOf(":");if(e!==void 0&&e>0)return r.text.substring(e+1).trimStart()}return r.text}}function Io(r,e){let t=r,s=dd(t)?" retweeted":"",a=[`## ${t.user.name} \`@${t.user.username}\`${s}`,Wp(t)||""];if(t.image_url&&a.push(`![${t.image_url}](${t.image_url})`),e){t.created_at&&a.push(`\`${new Date(t.created_at).toLocaleString()}\``);let c=[`\u{1F4AC} ${t.reply_count||0}`,`\u{1F501} ${t.retweet_count}`,`\u2764\uFE0F ${t.like_count}`];a.push(c.join("   "))}return a.join(`

`)}function zp(r){return(0,G.jsx)(ue.Action,{title:"Refresh Tweet",shortcut:{modifiers:["cmd"],key:"r"},onAction:async()=>{await r.fetcher.updateInline()}})}function fd(r){let e=r.tweet,{data:t,error:s,isLoading:a,fetcher:u}=Tr(async()=>{if(t===void 0)return r.tweet;{let m=await re.refreshTweets([t]);if(m&&m.length>0)return m[0]}});s&&(0,ue.showToast)({style:ue.Toast.Style.Failure,title:"Error",message:s});let c=t||e,f=Io(c,!0);return(0,G.jsx)(ue.Detail,{isLoading:a,markdown:f,actions:(0,G.jsxs)(ue.ActionPanel,{children:[(0,G.jsxs)(ue.ActionPanel.Section,{title:"Tweet",children:[(0,G.jsx)(Es,{tweet:c}),(0,G.jsx)(ks,{tweet:c})]}),(0,G.jsxs)(ue.ActionPanel.Section,{children:[(0,G.jsx)(Os,{tweet:c}),(0,G.jsx)(Ms,{tweet:c}),(0,G.jsx)(xs,{tweet:c})]}),(0,G.jsxs)(ue.ActionPanel.Section,{title:"Author",children:[(0,G.jsx)(js,{tweet:c}),(0,G.jsx)(Bs,{user:c.user})]}),(0,G.jsx)(ue.ActionPanel.Section,{title:"Update",children:(0,G.jsx)(zp,{tweet:c,fetcher:u})}),(0,G.jsx)(ue.ActionPanel.Section,{title:"Destructive",children:(0,G.jsx)(Fs,{tweet:c})})]})})}var Q=require("@raycast/api"),ko=require("react");var Pt=require("react/jsx-runtime");async function $p(r,e){try{let t=r.text;if(t.length<=0)throw Error("Please enter a text");if(t.length>280)throw Error("Tweet text could not be longer than 280 characters");e&&(await re.replyTweet(t,e),await(0,Q.showToast)({style:Q.Toast.Style.Success,title:"Tweet created",message:"Reply Tweet creation successful"})),(0,Q.popToRoot)()}catch(t){await(0,Q.showToast)({style:Q.Toast.Style.Failure,title:"Error",message:he(t)})}}function Np(r){let e=r.text,t=Vp(e);return(0,Pt.jsx)(Q.Form.Description,{text:`${e.length}/280 ${t?"\u2705":"\u274C"}`})}function hd(r){let e=r.replyTweet,t=e?"Send Reply":"Send Tweet",s=e?"Reply":"Tweet",a=e?"Tweet your reply":"What's happening?",[u,c]=(0,ko.useState)("");return(0,Pt.jsxs)(Q.Form,{actions:(0,Pt.jsx)(Q.ActionPanel,{children:u.length>0&&u.length<=280&&(0,Pt.jsx)(Q.Action.SubmitForm,{title:t,onSubmit:f=>$p(f,r.replyTweet)})}),children:[(0,Pt.jsx)(Q.Form.TextArea,{id:"text",title:s,placeholder:a,onChange:c}),(0,Pt.jsx)(Np,{text:u})]})}function Vp(r){let e=r.length;return!(e<1||e>280)}var Us=require("@raycast/api");var pd=require("react/jsx-runtime");function md(r){let{data:e,error:t,isLoading:s,fetcher:a}=Tr(async()=>await re.getTweetsFromAuthor(r.authorID));return t&&(0,Us.showToast)({style:Us.Toast.Style.Failure,title:"Error",message:t}),(0,pd.jsx)(Ws,{isLoading:s,tweets:e,fetcher:a})}var ne=require("react/jsx-runtime");function _d(){let r=async()=>{await Ml(),await(0,R.popToRoot)()};return(0,ne.jsx)(R.Action,{title:"Logout",icon:{source:R.Icon.XMarkCircle},onAction:r})}function gd(r){return(0,ne.jsx)(R.Action.Push,{title:"Show Tweet",icon:R.Icon.List,target:(0,ne.jsx)(fd,{tweet:r.tweet})})}function ks(r){let e=r.tweet;return(0,ne.jsx)(R.Action.OpenInBrowser,{url:`https://twitter.com/${e.user.username}/status/${e.id}`})}function Es(r){return(0,ne.jsx)(R.Action.Push,{title:"Reply",target:(0,ne.jsx)(hd,{replyTweet:r.tweet}),icon:{source:R.Icon.Bubble,tintColor:R.Color.PrimaryText},shortcut:{modifiers:["cmd"],key:"w"}})}function Os(r){let e=async()=>{re.likeTweet(r.tweet),(0,R.showToast)({style:R.Toast.Style.Success,title:"Tweet liked"}),r.fetcher&&(await xi(1e3),await r.fetcher.updateInline())};return(0,ne.jsx)(R.Action,{title:"Like",icon:{source:"heart_full.png",tintColor:R.Color.Red},shortcut:{modifiers:["cmd"],key:"l"},onAction:e})}function Ms(r){let e=async()=>{re.unlikeTweet(r.tweet),(0,R.showToast)({style:R.Toast.Style.Success,title:"Tweet unliked"}),r.fetcher&&(await xi(1e3),r.fetcher.updateInline())};return(0,ne.jsx)(R.Action,{title:"Unlike",icon:{source:"heart_empty.png",tintColor:R.Color.PrimaryText},shortcut:{modifiers:["cmd","shift"],key:"l"},onAction:e})}function xs(r){let e=async()=>{re.retweet(r.tweet),(0,R.showToast)({style:R.Toast.Style.Success,title:"Tweet Retweeted"})};return(0,ne.jsx)(R.Action,{title:"Retweet",icon:{source:"retweet.png",tintColor:R.Color.PrimaryText},shortcut:{modifiers:["cmd"],key:"t"},onAction:e})}function Fs(r){let[e,t]=(0,zs.useState)();(0,zs.useEffect)(()=>{async function u(){try{let c=await re.me();t(c.username)}catch{}}u()},[]);let s=r.tweet,a=async()=>{try{if((await re.me()).username!==s.user.username)throw Error("You can only delete your own Tweets");await(0,R.confirmAlert)({title:"Delete the Tweet?",icon:"\u{1F5D1}\uFE0F",primaryAction:{title:"Delete",style:R.Alert.ActionStyle.Destructive}})&&(await re.deleteTweet(s),(0,R.showToast)({style:R.Toast.Style.Success,title:"Tweet deleted",message:"Tweet deletion successful"}),(0,R.popToRoot)())}catch(u){(0,R.showToast)({style:R.Toast.Style.Failure,title:"Could not delete Tweet",message:he(u)})}};return e===s.user.username?(0,ne.jsx)(R.Action,{title:"Delete Tweet",icon:{source:R.Icon.XMarkCircle,tintColor:R.Color.Red},shortcut:{modifiers:["cmd","shift"],key:"d"},onAction:a}):null}function js(r){return(0,ne.jsx)(R.Action.Push,{title:`Tweets From @${r.tweet.user.username}`,target:(0,ne.jsx)(md,{authorID:r.tweet.user.id}),icon:{source:R.Icon.Person,tintColor:R.Color.PrimaryText},shortcut:{modifiers:["cmd","shift"],key:"a"}})}function Bs(r){return(0,ne.jsx)(R.Action.OpenInBrowser,{title:"Open Author Profile",url:`https://twitter.com/${r.user.username}`})}function wd(r){let e=r.fetcher;if(!e)return null;let t=async()=>{await e.updateInline()};return(0,ne.jsx)(R.Action,{title:"Refresh Existing Tweets",icon:R.Icon.Download,shortcut:{modifiers:["cmd","shift"],key:"r"},onAction:t})}function yd(r){let e=r.fetcher;if(!e)return null;let t=async()=>{await e.refresh()};return(0,ne.jsx)(R.Action,{title:"Refresh Tweets",icon:R.Icon.Binoculars,shortcut:{modifiers:["cmd"],key:"r"},onAction:t})}var q=require("react/jsx-runtime");function Hp(r){let e=r.tweet;return(0,q.jsx)(E.List.Item.Detail.Metadata.Label,{title:"Likes",text:`\u2764\uFE0F ${e.like_count}`})}function Qp(r){let e=r.tweet;return(0,q.jsx)(E.List.Item.Detail.Metadata.Label,{title:"Retweets",text:`\u{1F501} ${e.retweet_count}`})}function Yp(r){let e=r.tweet;return(0,q.jsx)(E.List.Item.Detail.Metadata.Label,{title:"Replies",text:`\u{1F4AC} ${e.reply_count||0}`})}function Xp(r){let e=r.tweet;return e.created_at?(0,q.jsx)(E.List.Item.Detail.Metadata.Label,{title:"Tweeted",text:`${new Date(e.created_at).toLocaleString()}`}):null}function Kp(r){let e=r.tweet.non_public_metrics;return e?(0,q.jsx)(E.List.Item.Detail.Metadata.Label,{title:"Impressions",text:`\u{1F441}\uFE0F ${e.impression_count}`}):null}function Gp(r){let e=r.tweet.organic_metrics;return!e||e.user_profile_clicks===void 0?null:(0,q.jsx)(E.List.Item.Detail.Metadata.Label,{title:"User Profile Clicks",text:`\u{1F464} ${e.user_profile_clicks}`})}function Jp(r){let e=r.tweet.non_public_metrics;return!e||e.url_link_clicks===void 0?null:(0,q.jsx)(E.List.Item.Detail.Metadata.Label,{title:"Url Clicks",text:`\u{1F517} ${e.url_link_clicks}`})}function Zp(r){let e=r.showMeta;return(0,q.jsx)(E.Action,{title:e?"Hide Details":"Show Details",shortcut:{modifiers:["opt"],key:"d"},icon:e?E.Icon.EyeDisabled:E.Icon.Eye,onAction:()=>r.onStateChange(!r.showMeta)})}function e_(r){let e=r.tweet;return(0,q.jsxs)(E.List.Item.Detail.Metadata,{children:[(0,q.jsx)(Xp,{tweet:e}),(0,q.jsx)(Hp,{tweet:e}),(0,q.jsx)(Qp,{tweet:e}),(0,q.jsx)(Yp,{tweet:e}),(0,q.jsx)(Kp,{tweet:e}),(0,q.jsx)(Gp,{tweet:e}),(0,q.jsx)(Jp,{tweet:e})]})}function t_(r){let e=r.text?r.text.trim():"",t=Fi(e,/\n/g," ");return t=Fi(t,/&amp/g," "),t}function r_(r){let e=r.tweet,t=r.withDetail,s=r.fetcher,a=r.millifyState!==void 0?r.millifyState:!0,[u,c]=(0,bd.useState)(!0),f=t_(e),m=e.user.profile_image_url,S=m?{source:m,mask:E.Image.Mask.Circle}:void 0,b=!!e.image_url,T=(U,N)=>{if(U===void 0)return"0";let ke=a?ar(U):`${U}`;return ss(ke,N)},g=1,p=3,D=U=>U===void 0||U<g?g:U>p?p:U,L=D(r.maxCommentDigits),te=D(r.maxRTDigits),le=D(r.maxFavDigits),se=[`\u{1F4AC} ${T(e.reply_count||0,L)}`,`\u{1F501} ${T(e.retweet_count,te)}`,`\u2764\uFE0F ${T(e.like_count,le)}`];b&&(se=["\u{1F5BC}\uFE0F",...se]);let ie=[{text:se.join("  ")}];return(0,q.jsx)(E.List.Item,{id:e.id,title:f,icon:S,accessories:t?void 0:ie,detail:t?(0,q.jsx)(E.List.Item.Detail,{markdown:Io(e,!u),metadata:u?(0,q.jsx)(e_,{tweet:e}):null}):void 0,actions:(0,q.jsxs)(E.ActionPanel,{children:[(0,q.jsxs)(E.ActionPanel.Section,{children:[(0,q.jsx)(gd,{tweet:e}),(0,q.jsx)(ks,{tweet:e})]}),(0,q.jsxs)(E.ActionPanel.Section,{children:[(0,q.jsx)(Os,{tweet:e,fetcher:s}),(0,q.jsx)(Ms,{tweet:e,fetcher:s}),(0,q.jsx)(Es,{tweet:e}),(0,q.jsx)(xs,{tweet:e})]}),(0,q.jsxs)(E.ActionPanel.Section,{children:[(0,q.jsx)(js,{tweet:e}),(0,q.jsx)(Bs,{user:e.user})]}),(0,q.jsx)(E.ActionPanel.Section,{title:"Destructive",children:(0,q.jsx)(Fs,{tweet:e})}),(0,q.jsxs)(E.ActionPanel.Section,{title:"Update",children:[(0,q.jsx)(wd,{fetcher:s}),(0,q.jsx)(yd,{fetcher:s})]}),(0,q.jsxs)(E.ActionPanel.Section,{children:[(0,q.jsx)(Zp,{showMeta:u,onStateChange:c}),(0,q.jsx)(_d,{})]})]})},e.id)}function Ws(r){let e=r.tweets,t=r.millifyState!==void 0?r.millifyState:!0,s=1,a=1,u=1,c=f=>f===void 0?0:(t?ar(f):`${f}`).length;if(e)for(let f of e){let m=c(f.like_count);m>s&&(s=m);let S=c(f.retweet_count);S>a&&(a=S);let b=c(f.reply_count);b>u&&(u=b)}return(0,q.jsx)(E.List,{isLoading:r.isLoading,searchBarPlaceholder:"Filter Tweets by name...",isShowingDetail:!0,children:e?.map(f=>(0,q.jsx)(r_,{tweet:f,fetcher:r.fetcher,maxCommentDigits:u,maxFavDigits:s,maxRTDigits:a,millifyState:t,withDetail:!0},f.id))})}var et=require("@raycast/api"),$s=require("react/jsx-runtime");function Td(){return(0,$s.jsx)(et.Detail,{markdown:`# API Subscription Required
This functionality require a paid X API subscription - see pricing [here](https://developer.twitter.com/en/products/twitter-api).
This is required since Twitter was renamed to X and restricted the access to the API. Some features were completely removed from the API.
See [this thread](https://twitter.com/TwitterDev/status/1641222782594990080) for more infos.

\u26A0\uFE0F I, the author of this extension, don't have an paid subscription and therefore can not(!) guarantee that this will work.
Please do not buy a subscription just for this extension! \u26A0\uFE0F

Currently this extension fallback to a the web version if no API OAuth key is configured.

Working command in the no OAuth case

- Send Tweet
- Search User

## How to configure the OAuth key

If you have an paid API account you should be able to configure it in the extension settings. No Warranty!
`,actions:(0,$s.jsx)(et.ActionPanel,{children:(0,$s.jsx)(et.Action,{onAction:()=>(0,et.openExtensionPreferences)(),title:"Configure Extension",icon:et.Icon.Gear})})})}var Eo=require("react/jsx-runtime");function Sd(){if(Mi())return(0,Eo.jsx)(Td,{});let{data:r,error:e,isLoading:t,fetcher:s}=Tr(async a=>a?await re.refreshTweets(r):await re.getMyTweets());return e&&(0,Ns.showToast)({style:Ns.Toast.Style.Failure,title:"Error",message:e}),(0,Eo.jsx)(Ws,{isLoading:t,tweets:r,fetcher:s})}var Ys=require("@raycast/api");var O=require("@raycast/api");var vd=require("@raycast/api"),Xt=require("react"),Rd=He(Lo());function n_(){let r=(0,vd.getPreferenceValues)(),e=r.appkey||"",t=r.appsecret||"",s=r.accesstoken||"",a=r.accesssecret||"";return new Rd.TwitterApi({appKey:e,appSecret:t,accessToken:s,accessSecret:a})}var Oo=null;function Re(){return Oo||(Oo=n_()),Oo}var Mo;async function mn(){return Mo||(Mo=await Re().v1.accountSettings()),Mo}async function pn(r){if(r){let e=r.map(a=>a.id_str),t=await Re().v1.tweets(e),s=[];for(let a of e){let u=t.find(c=>a===c.id_str);u&&s.push(u)}return s}else return}async function Pd(r){let e=await pn([r]);if(e&&e.length===1)return e[0]}function Sr(r,e){let[t,s]=(0,Xt.useState)(),[a,u]=(0,Xt.useState)(),[c,f]=(0,Xt.useState)(!0),[m,S]=(0,Xt.useState)(new Date),b=[m];if(e)for(let D of e)b.push(D);let T=!1,g={updateInline:async()=>{await p(!0)},refresh:async()=>{S(new Date)}};async function p(D=!1){if(!T){f(!0),u(void 0);try{let L=await r(D);T||s(L)}catch(L){T||u(he(L))}finally{T||f(!1)}}}return(0,Xt.useEffect)(()=>(p(),()=>{T=!0}),b),{data:t,error:a,isLoading:c,fetcher:g}}function xo(r){let e=r.entities.media;if(e){for(let t of e)if(t.type==="photo"&&t.media_url_https)return t.media_url_https}}var A=require("@raycast/api"),Qs=require("react");var $=require("@raycast/api"),Fo=require("react");var qt=require("react/jsx-runtime");async function s_(r,e){try{let t=r.text;if(t.length<=0)throw Error("Please enter a text");if(t.length>280)throw Error("Tweet text could not be longer than 280 characters");e?(await Re().v1.reply(t,e.id_str),await(0,$.showToast)({style:$.Toast.Style.Success,title:"Tweet created",message:"Reply Tweet creation successful"})):(await Re().v1.tweet(t),await(0,$.showToast)({style:$.Toast.Style.Success,title:"Tweet created",message:"Tweet creation successful"})),(0,$.popToRoot)()}catch(t){await(0,$.showToast)({style:$.Toast.Style.Failure,title:"Error",message:he(t)})}}function i_(r){let e=r.text,t=a_(e);return(0,qt.jsx)($.Form.Description,{text:`${e.length}/280 ${t?"\u2705":"\u274C"}`})}function qd(r){let e=r.replyTweet,t=e?"Send Reply":"Send Tweet",s=e?"Reply":"Tweet",a=e?"Tweet your reply":"What's happening?",[u,c]=(0,Fo.useState)("");return(0,qt.jsxs)($.Form,{actions:(0,qt.jsx)($.ActionPanel,{children:u.length>0&&u.length<=280&&(0,qt.jsx)($.Action.SubmitForm,{title:t,onSubmit:f=>s_(f,e)})}),children:[(0,qt.jsx)($.Form.TextArea,{id:"text",title:s,placeholder:a,onChange:c}),(0,qt.jsx)(i_,{text:u})]})}function a_(r){let e=r.length;return!(e<1||e>280)}var Vs=require("@raycast/api");var Dd=require("react/jsx-runtime");function Ad(r){let e=r.username,{data:t,error:s,isLoading:a,fetcher:u}=Sr(async c=>c?await pn(t):await o_(e));return s&&(0,Vs.showToast)({style:Vs.Toast.Style.Failure,title:"Error",message:s}),(0,Dd.jsx)(Hs,{isLoading:a,tweets:t,fetcher:u})}async function o_(r){let e=await Re().v1.userTimelineByUsername(r),t=[];for(let s of e.tweets)t.push(s);return t}var Pe=require("react/jsx-runtime");function Ld(r){return(0,Pe.jsx)(A.Action.Push,{title:"Show Tweet",target:(0,Pe.jsx)(Id,{tweet:r.tweet}),icon:{source:A.Icon.List,tintColor:A.Color.PrimaryText}})}function jo(r){return(0,Pe.jsx)(A.Action.Push,{title:"Reply",target:(0,Pe.jsx)(qd,{replyTweet:r.tweet}),icon:{source:A.Icon.Bubble,tintColor:A.Color.PrimaryText},shortcut:{modifiers:["cmd"],key:"w"}})}function Bo(r){let[e,t]=(0,Qs.useState)();(0,Qs.useEffect)(()=>{async function u(){try{let c=await mn();t(c.screen_name)}catch{}}u()},[]);let s=r.tweet,a=async()=>{try{if((await mn()).screen_name!==s.user.screen_name)throw Error("You can only delete your own Tweets");await Re().v1.deleteTweet(s.id_str),(0,A.showToast)({style:A.Toast.Style.Success,title:"Tweet deleted",message:"Tweet deletion successful"})}catch(u){(0,A.showToast)({style:A.Toast.Style.Failure,title:"Could not delete Tweet",message:he(u)})}};return e===s.user.screen_name?(0,Pe.jsx)(A.Action,{title:"Delete Tweet",icon:{source:A.Icon.XMarkCircle,tintColor:A.Color.Red},onAction:a}):null}function Uo(r){let e=r.tweet,t=e.retweeted?"unretweet":"retweet",s=e.retweeted?"Unretweet":"Retweet",a=e.retweeted?{source:"retweet.png",tintColor:A.Color.Green}:{source:"retweet.png",tintColor:A.Color.PrimaryText};return(0,Pe.jsx)(A.Action,{title:s,icon:a,onAction:async()=>{try{await Re().v1.post(`statuses/${t}/${e.id_str}.json`),(0,A.showToast)({style:A.Toast.Style.Success,title:"Retweet successful",message:"Retweet creation successful"}),r.fetcher&&await r.fetcher.updateInline()}catch(c){(0,A.showToast)({style:A.Toast.Style.Failure,title:"Could not retweet",message:he(c)})}},shortcut:{modifiers:["cmd"],key:"t"}})}function Wo(r){let e=r.tweet,t=e.favorited?"destroy":"create",s=e.favorited?"Undo Like":"Like",a=e.favorited?{source:"heart_full.png",tintColor:A.Color.Red}:{source:"heart_empty.png",tintColor:A.Color.PrimaryText},u=async()=>{try{await Re().v1.post(`favorites/${t}.json`,{id:e.id_str}),(0,A.showToast)({style:A.Toast.Style.Success,title:`${s} successful`,message:`${s} operation successful`}),r.fetcher&&await r.fetcher.updateInline()}catch(c){(0,A.showToast)({style:A.Toast.Style.Failure,title:`${s} failed`,message:he(c)})}};return(0,Pe.jsx)(A.ActionPanel.Item,{title:s,shortcut:{modifiers:["cmd"],key:"l"},icon:a,onAction:u})}function zo(r){return(0,Pe.jsx)(A.Action.OpenInBrowser,{title:"Open Author Profile",url:`https://twitter.com/${r.tweet.user.screen_name}`,icon:{source:A.Icon.Person,tintColor:A.Color.PrimaryText}})}function Cd(r){let e=async()=>{r.fetcher&&await r.fetcher.updateInline()};return(0,Pe.jsx)(A.Action,{title:"Refresh Existing Tweets",shortcut:{modifiers:["cmd","shift"],key:"r"},icon:{source:A.Icon.Download,tintColor:A.Color.PrimaryText},onAction:e})}function $o(r){let e=async()=>{r.fetcher&&await r.fetcher.refresh()},t=r.title?r.title:"Refresh Tweets";return(0,Pe.jsx)(A.Action,{title:t,shortcut:{modifiers:["cmd"],key:"r"},icon:{source:A.Icon.Binoculars,tintColor:A.Color.PrimaryText},onAction:e})}function No(r){return(0,Pe.jsx)(A.Action.Push,{title:r.title||`Tweets from @${r.username}`,shortcut:{modifiers:["cmd","shift"],key:"a"},icon:ir(),target:(0,Pe.jsx)(Ad,{username:r.username})})}var C=require("react/jsx-runtime");function kd(r){return`https://twitter.com/${r.user.screen_name}/status/${r.id_str}`}function u_(r){let e=r.tweet,t=r.withDetail,s=r.fetcher,a=r.millifyState!==void 0?r.millifyState:!0,u=70,c=e.full_text?e.full_text.trim():"",f=c.slice(0,u)+(c.length>u?" ...":""),S=e.user.profile_image_url_https?{source:e.user.profile_image_url_https,mask:O.Image.Mask.Circle}:void 0,b=e.favorited&&c.startsWith("RT @")?1:0,T=!!xo(e),g=(N,ke)=>{if(N===void 0)return"0";let _n=a?ar(N):`${N}`;return ss(_n,ke)},p=1,D=3,L=N=>N===void 0||N<p?p:N>D?D:N,te=L(r.maxCommentDigits),le=L(r.maxRTDigits),se=L(r.maxFavDigits),ie=[`\u{1F4AC} ${g(e.reply_count||0,te)}`,`\u{1F501} ${g(e.retweet_count,le)}`,`\u2764\uFE0F ${g(e.favorite_count+b,se)}`];T&&(ie=["\u{1F5BC}\uFE0F",...ie]);let U=[{text:ie.join("  ")}];return(0,C.jsx)(O.List.Item,{id:e.id_str,title:f,icon:S,accessories:t?void 0:U,detail:t?(0,C.jsx)(O.List.Item.Detail,{markdown:Ed(e)}):void 0,actions:(0,C.jsxs)(O.ActionPanel,{children:[(0,C.jsxs)(O.ActionPanel.Section,{title:"Tweet",children:[(0,C.jsx)(Ld,{tweet:e}),(0,C.jsx)(O.Action.OpenInBrowser,{url:kd(e),shortcut:{modifiers:["cmd"],key:"b"}}),(0,C.jsx)(Wo,{tweet:e,fetcher:s}),(0,C.jsx)(jo,{tweet:e}),(0,C.jsx)(Uo,{tweet:e,fetcher:s}),(0,C.jsx)(No,{username:e.user.screen_name})]}),(0,C.jsx)(O.ActionPanel.Section,{title:"Info",children:(0,C.jsx)(zo,{tweet:e})}),(0,C.jsx)(O.ActionPanel.Section,{title:"Destructive",children:(0,C.jsx)(Bo,{tweet:e})}),(0,C.jsxs)(O.ActionPanel.Section,{title:"Update",children:[(0,C.jsx)(Cd,{fetcher:s}),(0,C.jsx)($o,{fetcher:s})]})]})},e.id_str)}function l_(r){if(r.full_text!==void 0){if(Vo(r)){let e=r.full_text.indexOf(":");if(e!==void 0&&e>0)return r.full_text.substring(e+1).trimStart()}return r.full_text}}function Vo(r){return!!(r.full_text&&r.full_text.startsWith("RT @"))}function Ed(r){let e=r,t=e.favorited&&Vo(e)?1:0,s=[`\u{1F4AC} ${e.reply_count||0}`,`\u{1F501} ${e.retweet_count}`,`\u2764\uFE0F ${e.favorite_count+t}`],a=xo(e),u=Vo(e)?" retweeted":"",c=[`## ${e.user.name} \`@${e.user.screen_name}\`${u}`,l_(e)||"",`\`${e.created_at}\``];return a&&c.push(`![${a}](${a})`),c.push(s.join("   ")),c.join(`

`)}function Id(r){let{data:e,error:t,isLoading:s,fetcher:a}=Sr(async()=>e===void 0?r.tweet:await Pd(e));t&&(0,O.showToast)({style:O.Toast.Style.Failure,title:"Error",message:t});let u=e||r.tweet,c=Ed(u);return(0,C.jsx)(O.Detail,{isLoading:s,markdown:c,actions:(0,C.jsxs)(O.ActionPanel,{children:[(0,C.jsxs)(O.ActionPanel.Section,{title:"Tweet",children:[(0,C.jsx)(jo,{tweet:u}),(0,C.jsx)(Wo,{tweet:u,fetcher:a}),(0,C.jsx)(Uo,{tweet:u,fetcher:a}),(0,C.jsx)(No,{username:u.user.screen_name}),(0,C.jsx)(O.Action.OpenInBrowser,{url:kd(u),shortcut:{modifiers:["cmd"],key:"b"}})]}),(0,C.jsx)(O.ActionPanel.Section,{title:"Info",children:(0,C.jsx)(zo,{tweet:u})}),(0,C.jsx)(O.ActionPanel.Section,{title:"Destructive",children:(0,C.jsx)(Bo,{tweet:u})}),(0,C.jsx)(O.ActionPanel.Section,{title:"Update",children:(0,C.jsx)($o,{title:"Refresh Tweet",fetcher:a})})]})})}function Hs(r){let e=r.tweets,t=Fl(),s=r.millifyState!==void 0?r.millifyState:!0,a=1,u=1,c=1,f=m=>m===void 0?0:(s?ar(m):`${m}`).length;if(e)for(let m of e){let S=f(m.favorite_count);S>a&&(a=S);let b=f(m.retweet_count);b>u&&(u=b);let T=f(m.reply_count);T>c&&(c=T)}return(0,C.jsx)(O.List,{isLoading:r.isLoading,searchBarPlaceholder:"Filter Tweets by name...",isShowingDetail:t,children:e?.map(m=>(0,C.jsx)(u_,{tweet:m,fetcher:r.fetcher,maxCommentDigits:c,maxFavDigits:a,maxRTDigits:u,millifyState:s,withDetail:t},m.id_str))})}var Md=require("react/jsx-runtime");function Od(){let{data:r,error:e,isLoading:t,fetcher:s}=Sr(async a=>a?await pn(r):await c_());return e&&(0,Ys.showToast)({style:Ys.Toast.Style.Failure,title:"Error",message:e}),(0,Md.jsx)(Hs,{isLoading:t,tweets:r,fetcher:s})}async function c_(){let r=await mn(),e=await Re().v1.userTimelineByUsername(r.screen_name),t=[];for(let s of e.tweets)t.push(s);return t}var Ho=require("react/jsx-runtime");function xd(){return jl()?(0,Ho.jsx)(Sd,{}):(0,Ho.jsx)(Od,{})}
