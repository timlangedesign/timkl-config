"use strict";var Yd=Object.create;var Dn=Object.defineProperty;var Kd=Object.getOwnPropertyDescriptor;var Xd=Object.getOwnPropertyNames;var Gd=Object.getPrototypeOf,Jd=Object.prototype.hasOwnProperty;var g=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports),Zd=(s,e)=>{for(var t in e)Dn(s,t,{get:e[t],enumerable:!0})},fu=(s,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of Xd(e))!Jd.call(s,a)&&a!==t&&Dn(s,a,{get:()=>e[a],enumerable:!(n=Kd(e,a))||n.enumerable});return s};var Le=(s,e,t)=>(t=s!=null?Yd(Gd(s)):{},fu(e||!s||!s.__esModule?Dn(t,"default",{value:s,enumerable:!0}):t,s)),ef=s=>fu(Dn({},"__esModule",{value:!0}),s);var mu=g((xm,hu)=>{"use strict";function tf(s){if(!/^data:/i.test(s))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');s=s.replace(/\r?\n/g,"");let e=s.indexOf(",");if(e===-1||e<=4)throw new TypeError("malformed data: URI");let t=s.substring(5,e).split(";"),n="",a=!1,u=t[0]||"text/plain",c=u;for(let S=1;S<t.length;S++)t[S]==="base64"?a=!0:(c+=`;${t[S]}`,t[S].indexOf("charset=")===0&&(n=t[S].substring(8)));!t[0]&&!n.length&&(c+=";charset=US-ASCII",n="US-ASCII");let f=a?"base64":"ascii",m=unescape(s.substring(e+1)),b=Buffer.from(m,f);return b.type=u,b.typeFull=c,b.charset=n,b}hu.exports=tf});var _u=g((An,pu)=>{(function(s,e){typeof An=="object"&&typeof pu<"u"?e(An):typeof define=="function"&&define.amd?define(["exports"],e):(s=typeof globalThis<"u"?globalThis:s||self,e(s.WebStreamsPolyfill={}))})(An,function(s){"use strict";let e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:r=>`Symbol(${r})`;function t(){}function n(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}let a=n();function u(r){return typeof r=="object"&&r!==null||typeof r=="function"}let c=t,f=Promise,m=Promise.prototype.then,b=Promise.resolve.bind(f),S=Promise.reject.bind(f);function R(r){return new f(r)}function w(r){return b(r)}function _(r){return S(r)}function A(r,i,o){return m.call(r,i,o)}function O(r,i,o){A(A(r,i,o),void 0,c)}function le(r,i){O(r,i)}function Ae(r,i){O(r,void 0,i)}function xe(r,i,o){return A(r,i,o)}function Ue(r){A(r,void 0,c)}let _e=(()=>{let r=a&&a.queueMicrotask;if(typeof r=="function")return r;let i=w(void 0);return o=>A(i,o)})();function We(r,i,o){if(typeof r!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(r,i,o)}function ft(r,i,o){try{return w(We(r,i,o))}catch(l){return _(l)}}let Ka=16384;class ge{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(i){let o=this._back,l=o;o._elements.length===Ka-1&&(l={_elements:[],_next:void 0}),o._elements.push(i),l!==o&&(this._back=l,o._next=l),++this._size}shift(){let i=this._front,o=i,l=this._cursor,d=l+1,h=i._elements,p=h[l];return d===Ka&&(o=i._next,d=0),--this._size,this._cursor=d,i!==o&&(this._front=o),h[l]=void 0,p}forEach(i){let o=this._cursor,l=this._front,d=l._elements;for(;(o!==d.length||l._next!==void 0)&&!(o===d.length&&(l=l._next,d=l._elements,o=0,d.length===0));)i(d[o]),++o}peek(){let i=this._front,o=this._cursor;return i._elements[o]}}function Xa(r,i){r._ownerReadableStream=i,i._reader=r,i._state==="readable"?ms(r):i._state==="closed"?Tc(r):Ga(r,i._storedError)}function hs(r,i){let o=r._ownerReadableStream;return we(o,i)}function ze(r){r._ownerReadableStream._state==="readable"?ps(r,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):Rc(r,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),r._ownerReadableStream._reader=void 0,r._ownerReadableStream=void 0}function It(r){return new TypeError("Cannot "+r+" a stream using a released reader")}function ms(r){r._closedPromise=R((i,o)=>{r._closedPromise_resolve=i,r._closedPromise_reject=o})}function Ga(r,i){ms(r),ps(r,i)}function Tc(r){ms(r),Ja(r)}function ps(r,i){r._closedPromise_reject!==void 0&&(Ue(r._closedPromise),r._closedPromise_reject(i),r._closedPromise_resolve=void 0,r._closedPromise_reject=void 0)}function Rc(r,i){Ga(r,i)}function Ja(r){r._closedPromise_resolve!==void 0&&(r._closedPromise_resolve(void 0),r._closedPromise_resolve=void 0,r._closedPromise_reject=void 0)}let Za=e("[[AbortSteps]]"),eo=e("[[ErrorSteps]]"),_s=e("[[CancelSteps]]"),gs=e("[[PullSteps]]"),to=Number.isFinite||function(r){return typeof r=="number"&&isFinite(r)},Pc=Math.trunc||function(r){return r<0?Math.ceil(r):Math.floor(r)};function qc(r){return typeof r=="object"||typeof r=="function"}function Ne(r,i){if(r!==void 0&&!qc(r))throw new TypeError(`${i} is not an object.`)}function ye(r,i){if(typeof r!="function")throw new TypeError(`${i} is not a function.`)}function Dc(r){return typeof r=="object"&&r!==null||typeof r=="function"}function ro(r,i){if(!Dc(r))throw new TypeError(`${i} is not an object.`)}function $e(r,i,o){if(r===void 0)throw new TypeError(`Parameter ${i} is required in '${o}'.`)}function ys(r,i,o){if(r===void 0)throw new TypeError(`${i} is required in '${o}'.`)}function bs(r){return Number(r)}function no(r){return r===0?0:r}function Ac(r){return no(Pc(r))}function so(r,i){let l=Number.MAX_SAFE_INTEGER,d=Number(r);if(d=no(d),!to(d))throw new TypeError(`${i} is not a finite number`);if(d=Ac(d),d<0||d>l)throw new TypeError(`${i} is outside the accepted range of 0 to ${l}, inclusive`);return!to(d)||d===0?0:d}function ws(r,i){if(!rt(r))throw new TypeError(`${i} is not a ReadableStream.`)}function Mt(r){return new ir(r)}function io(r,i){r._reader._readRequests.push(i)}function Ss(r,i,o){let d=r._reader._readRequests.shift();o?d._closeSteps():d._chunkSteps(i)}function Kr(r){return r._reader._readRequests.length}function ao(r){let i=r._reader;return!(i===void 0||!Je(i))}class ir{constructor(i){if($e(i,1,"ReadableStreamDefaultReader"),ws(i,"First parameter"),nt(i))throw new TypeError("This stream has already been locked for exclusive reading by another reader");Xa(this,i),this._readRequests=new ge}get closed(){return Je(this)?this._closedPromise:_(Xr("closed"))}cancel(i=void 0){return Je(this)?this._ownerReadableStream===void 0?_(It("cancel")):hs(this,i):_(Xr("cancel"))}read(){if(!Je(this))return _(Xr("read"));if(this._ownerReadableStream===void 0)return _(It("read from"));let i,o,l=R((h,p)=>{i=h,o=p});return ar(this,{_chunkSteps:h=>i({value:h,done:!1}),_closeSteps:()=>i({value:void 0,done:!0}),_errorSteps:h=>o(h)}),l}releaseLock(){if(!Je(this))throw Xr("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ze(this)}}}Object.defineProperties(ir.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(ir.prototype,e.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function Je(r){return!u(r)||!Object.prototype.hasOwnProperty.call(r,"_readRequests")?!1:r instanceof ir}function ar(r,i){let o=r._ownerReadableStream;o._disturbed=!0,o._state==="closed"?i._closeSteps():o._state==="errored"?i._errorSteps(o._storedError):o._readableStreamController[gs](i)}function Xr(r){return new TypeError(`ReadableStreamDefaultReader.prototype.${r} can only be used on a ReadableStreamDefaultReader`)}let oo=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class uo{constructor(i,o){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=i,this._preventCancel=o}next(){let i=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?xe(this._ongoingPromise,i,i):i(),this._ongoingPromise}return(i){let o=()=>this._returnSteps(i);return this._ongoingPromise?xe(this._ongoingPromise,o,o):o()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let i=this._reader;if(i._ownerReadableStream===void 0)return _(It("iterate"));let o,l,d=R((p,y)=>{o=p,l=y});return ar(i,{_chunkSteps:p=>{this._ongoingPromise=void 0,_e(()=>o({value:p,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,ze(i),o({value:void 0,done:!0})},_errorSteps:p=>{this._ongoingPromise=void 0,this._isFinished=!0,ze(i),l(p)}}),d}_returnSteps(i){if(this._isFinished)return Promise.resolve({value:i,done:!0});this._isFinished=!0;let o=this._reader;if(o._ownerReadableStream===void 0)return _(It("finish iterating"));if(!this._preventCancel){let l=hs(o,i);return ze(o),xe(l,()=>({value:i,done:!0}))}return ze(o),w({value:i,done:!0})}}let lo={next(){return co(this)?this._asyncIteratorImpl.next():_(fo("next"))},return(r){return co(this)?this._asyncIteratorImpl.return(r):_(fo("return"))}};oo!==void 0&&Object.setPrototypeOf(lo,oo);function Cc(r,i){let o=Mt(r),l=new uo(o,i),d=Object.create(lo);return d._asyncIteratorImpl=l,d}function co(r){if(!u(r)||!Object.prototype.hasOwnProperty.call(r,"_asyncIteratorImpl"))return!1;try{return r._asyncIteratorImpl instanceof uo}catch{return!1}}function fo(r){return new TypeError(`ReadableStreamAsyncIterator.${r} can only be used on a ReadableSteamAsyncIterator`)}let ho=Number.isNaN||function(r){return r!==r};function or(r){return r.slice()}function mo(r,i,o,l,d){new Uint8Array(r).set(new Uint8Array(o,l,d),i)}function Fm(r){return r}function Gr(r){return!1}function po(r,i,o){if(r.slice)return r.slice(i,o);let l=o-i,d=new ArrayBuffer(l);return mo(d,0,r,i,l),d}function Oc(r){return!(typeof r!="number"||ho(r)||r<0)}function _o(r){let i=po(r.buffer,r.byteOffset,r.byteOffset+r.byteLength);return new Uint8Array(i)}function vs(r){let i=r._queue.shift();return r._queueTotalSize-=i.size,r._queueTotalSize<0&&(r._queueTotalSize=0),i.value}function Ts(r,i,o){if(!Oc(o)||o===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");r._queue.push({value:i,size:o}),r._queueTotalSize+=o}function Lc(r){return r._queue.peek().value}function Ze(r){r._queue=new ge,r._queueTotalSize=0}class ur{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!Rs(this))throw Cs("view");return this._view}respond(i){if(!Rs(this))throw Cs("respond");if($e(i,1,"respond"),i=so(i,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");Gr(this._view.buffer),tn(this._associatedReadableByteStreamController,i)}respondWithNewView(i){if(!Rs(this))throw Cs("respondWithNewView");if($e(i,1,"respondWithNewView"),!ArrayBuffer.isView(i))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");Gr(i.buffer),rn(this._associatedReadableByteStreamController,i)}}Object.defineProperties(ur.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(ur.prototype,e.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class kt{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!ht(this))throw cr("byobRequest");return As(this)}get desiredSize(){if(!ht(this))throw cr("desiredSize");return Ro(this)}close(){if(!ht(this))throw cr("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let i=this._controlledReadableByteStream._state;if(i!=="readable")throw new TypeError(`The stream (in ${i} state) is not in the readable state and cannot be closed`);lr(this)}enqueue(i){if(!ht(this))throw cr("enqueue");if($e(i,1,"enqueue"),!ArrayBuffer.isView(i))throw new TypeError("chunk must be an array buffer view");if(i.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(i.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let o=this._controlledReadableByteStream._state;if(o!=="readable")throw new TypeError(`The stream (in ${o} state) is not in the readable state and cannot be enqueued to`);en(this,i)}error(i=void 0){if(!ht(this))throw cr("error");be(this,i)}[_s](i){go(this),Ze(this);let o=this._cancelAlgorithm(i);return Zr(this),o}[gs](i){let o=this._controlledReadableByteStream;if(this._queueTotalSize>0){let d=this._queue.shift();this._queueTotalSize-=d.byteLength,So(this);let h=new Uint8Array(d.buffer,d.byteOffset,d.byteLength);i._chunkSteps(h);return}let l=this._autoAllocateChunkSize;if(l!==void 0){let d;try{d=new ArrayBuffer(l)}catch(p){i._errorSteps(p);return}let h={buffer:d,bufferByteLength:l,byteOffset:0,byteLength:l,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(h)}io(o,i),mt(this)}}Object.defineProperties(kt.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(kt.prototype,e.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function ht(r){return!u(r)||!Object.prototype.hasOwnProperty.call(r,"_controlledReadableByteStream")?!1:r instanceof kt}function Rs(r){return!u(r)||!Object.prototype.hasOwnProperty.call(r,"_associatedReadableByteStreamController")?!1:r instanceof ur}function mt(r){if(!kc(r))return;if(r._pulling){r._pullAgain=!0;return}r._pulling=!0;let o=r._pullAlgorithm();O(o,()=>{r._pulling=!1,r._pullAgain&&(r._pullAgain=!1,mt(r))},l=>{be(r,l)})}function go(r){qs(r),r._pendingPullIntos=new ge}function Ps(r,i){let o=!1;r._state==="closed"&&(o=!0);let l=yo(i);i.readerType==="default"?Ss(r,l,o):Bc(r,l,o)}function yo(r){let i=r.bytesFilled,o=r.elementSize;return new r.viewConstructor(r.buffer,r.byteOffset,i/o)}function Jr(r,i,o,l){r._queue.push({buffer:i,byteOffset:o,byteLength:l}),r._queueTotalSize+=l}function bo(r,i){let o=i.elementSize,l=i.bytesFilled-i.bytesFilled%o,d=Math.min(r._queueTotalSize,i.byteLength-i.bytesFilled),h=i.bytesFilled+d,p=h-h%o,y=d,v=!1;p>l&&(y=p-i.bytesFilled,v=!0);let D=r._queue;for(;y>0;){let k=D.peek(),I=Math.min(y,k.byteLength),B=i.byteOffset+i.bytesFilled;mo(i.buffer,B,k.buffer,k.byteOffset,I),k.byteLength===I?D.shift():(k.byteOffset+=I,k.byteLength-=I),r._queueTotalSize-=I,wo(r,I,i),y-=I}return v}function wo(r,i,o){o.bytesFilled+=i}function So(r){r._queueTotalSize===0&&r._closeRequested?(Zr(r),yr(r._controlledReadableByteStream)):mt(r)}function qs(r){r._byobRequest!==null&&(r._byobRequest._associatedReadableByteStreamController=void 0,r._byobRequest._view=null,r._byobRequest=null)}function vo(r){for(;r._pendingPullIntos.length>0;){if(r._queueTotalSize===0)return;let i=r._pendingPullIntos.peek();bo(r,i)&&(Ds(r),Ps(r._controlledReadableByteStream,i))}}function Ec(r,i,o){let l=r._controlledReadableByteStream,d=1;i.constructor!==DataView&&(d=i.constructor.BYTES_PER_ELEMENT);let h=i.constructor,p=i.buffer,y={buffer:p,bufferByteLength:p.byteLength,byteOffset:i.byteOffset,byteLength:i.byteLength,bytesFilled:0,elementSize:d,viewConstructor:h,readerType:"byob"};if(r._pendingPullIntos.length>0){r._pendingPullIntos.push(y),Do(l,o);return}if(l._state==="closed"){let v=new h(y.buffer,y.byteOffset,0);o._closeSteps(v);return}if(r._queueTotalSize>0){if(bo(r,y)){let v=yo(y);So(r),o._chunkSteps(v);return}if(r._closeRequested){let v=new TypeError("Insufficient bytes to fill elements in the given buffer");be(r,v),o._errorSteps(v);return}}r._pendingPullIntos.push(y),Do(l,o),mt(r)}function Ic(r,i){let o=r._controlledReadableByteStream;if(Os(o))for(;Ao(o)>0;){let l=Ds(r);Ps(o,l)}}function Mc(r,i,o){if(wo(r,i,o),o.bytesFilled<o.elementSize)return;Ds(r);let l=o.bytesFilled%o.elementSize;if(l>0){let d=o.byteOffset+o.bytesFilled,h=po(o.buffer,d-l,d);Jr(r,h,0,h.byteLength)}o.bytesFilled-=l,Ps(r._controlledReadableByteStream,o),vo(r)}function To(r,i){let o=r._pendingPullIntos.peek();qs(r),r._controlledReadableByteStream._state==="closed"?Ic(r):Mc(r,i,o),mt(r)}function Ds(r){return r._pendingPullIntos.shift()}function kc(r){let i=r._controlledReadableByteStream;return i._state!=="readable"||r._closeRequested||!r._started?!1:!!(ao(i)&&Kr(i)>0||Os(i)&&Ao(i)>0||Ro(r)>0)}function Zr(r){r._pullAlgorithm=void 0,r._cancelAlgorithm=void 0}function lr(r){let i=r._controlledReadableByteStream;if(!(r._closeRequested||i._state!=="readable")){if(r._queueTotalSize>0){r._closeRequested=!0;return}if(r._pendingPullIntos.length>0&&r._pendingPullIntos.peek().bytesFilled>0){let l=new TypeError("Insufficient bytes to fill elements in the given buffer");throw be(r,l),l}Zr(r),yr(i)}}function en(r,i){let o=r._controlledReadableByteStream;if(r._closeRequested||o._state!=="readable")return;let l=i.buffer,d=i.byteOffset,h=i.byteLength,p=l;if(r._pendingPullIntos.length>0){let y=r._pendingPullIntos.peek();Gr(y.buffer),y.buffer=y.buffer}if(qs(r),ao(o))if(Kr(o)===0)Jr(r,p,d,h);else{let y=new Uint8Array(p,d,h);Ss(o,y,!1)}else Os(o)?(Jr(r,p,d,h),vo(r)):Jr(r,p,d,h);mt(r)}function be(r,i){let o=r._controlledReadableByteStream;o._state==="readable"&&(go(r),Ze(r),Zr(r),Jo(o,i))}function As(r){if(r._byobRequest===null&&r._pendingPullIntos.length>0){let i=r._pendingPullIntos.peek(),o=new Uint8Array(i.buffer,i.byteOffset+i.bytesFilled,i.byteLength-i.bytesFilled),l=Object.create(ur.prototype);Fc(l,r,o),r._byobRequest=l}return r._byobRequest}function Ro(r){let i=r._controlledReadableByteStream._state;return i==="errored"?null:i==="closed"?0:r._strategyHWM-r._queueTotalSize}function tn(r,i){let o=r._pendingPullIntos.peek();if(r._controlledReadableByteStream._state==="closed"){if(i!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(i===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(o.bytesFilled+i>o.byteLength)throw new RangeError("bytesWritten out of range")}o.buffer=o.buffer,To(r,i)}function rn(r,i){let o=r._pendingPullIntos.peek();if(r._controlledReadableByteStream._state==="closed"){if(i.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(i.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(o.byteOffset+o.bytesFilled!==i.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(o.bufferByteLength!==i.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(o.bytesFilled+i.byteLength>o.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");o.buffer=i.buffer,To(r,i.byteLength)}function Po(r,i,o,l,d,h,p){i._controlledReadableByteStream=r,i._pullAgain=!1,i._pulling=!1,i._byobRequest=null,i._queue=i._queueTotalSize=void 0,Ze(i),i._closeRequested=!1,i._started=!1,i._strategyHWM=h,i._pullAlgorithm=l,i._cancelAlgorithm=d,i._autoAllocateChunkSize=p,i._pendingPullIntos=new ge,r._readableStreamController=i;let y=o();O(w(y),()=>{i._started=!0,mt(i)},v=>{be(i,v)})}function jc(r,i,o){let l=Object.create(kt.prototype),d=()=>{},h=()=>w(void 0),p=()=>w(void 0);i.start!==void 0&&(d=()=>i.start(l)),i.pull!==void 0&&(h=()=>i.pull(l)),i.cancel!==void 0&&(p=v=>i.cancel(v));let y=i.autoAllocateChunkSize;if(y===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");Po(r,l,d,h,p,o,y)}function Fc(r,i,o){r._associatedReadableByteStreamController=i,r._view=o}function Cs(r){return new TypeError(`ReadableStreamBYOBRequest.prototype.${r} can only be used on a ReadableStreamBYOBRequest`)}function cr(r){return new TypeError(`ReadableByteStreamController.prototype.${r} can only be used on a ReadableByteStreamController`)}function qo(r){return new dr(r)}function Do(r,i){r._reader._readIntoRequests.push(i)}function Bc(r,i,o){let d=r._reader._readIntoRequests.shift();o?d._closeSteps(i):d._chunkSteps(i)}function Ao(r){return r._reader._readIntoRequests.length}function Os(r){let i=r._reader;return!(i===void 0||!pt(i))}class dr{constructor(i){if($e(i,1,"ReadableStreamBYOBReader"),ws(i,"First parameter"),nt(i))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!ht(i._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");Xa(this,i),this._readIntoRequests=new ge}get closed(){return pt(this)?this._closedPromise:_(nn("closed"))}cancel(i=void 0){return pt(this)?this._ownerReadableStream===void 0?_(It("cancel")):hs(this,i):_(nn("cancel"))}read(i){if(!pt(this))return _(nn("read"));if(!ArrayBuffer.isView(i))return _(new TypeError("view must be an array buffer view"));if(i.byteLength===0)return _(new TypeError("view must have non-zero byteLength"));if(i.buffer.byteLength===0)return _(new TypeError("view's buffer must have non-zero byteLength"));if(Gr(i.buffer),this._ownerReadableStream===void 0)return _(It("read from"));let o,l,d=R((p,y)=>{o=p,l=y});return Co(this,i,{_chunkSteps:p=>o({value:p,done:!1}),_closeSteps:p=>o({value:p,done:!0}),_errorSteps:p=>l(p)}),d}releaseLock(){if(!pt(this))throw nn("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ze(this)}}}Object.defineProperties(dr.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(dr.prototype,e.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function pt(r){return!u(r)||!Object.prototype.hasOwnProperty.call(r,"_readIntoRequests")?!1:r instanceof dr}function Co(r,i,o){let l=r._ownerReadableStream;l._disturbed=!0,l._state==="errored"?o._errorSteps(l._storedError):Ec(l._readableStreamController,i,o)}function nn(r){return new TypeError(`ReadableStreamBYOBReader.prototype.${r} can only be used on a ReadableStreamBYOBReader`)}function fr(r,i){let{highWaterMark:o}=r;if(o===void 0)return i;if(ho(o)||o<0)throw new RangeError("Invalid highWaterMark");return o}function sn(r){let{size:i}=r;return i||(()=>1)}function an(r,i){Ne(r,i);let o=r?.highWaterMark,l=r?.size;return{highWaterMark:o===void 0?void 0:bs(o),size:l===void 0?void 0:xc(l,`${i} has member 'size' that`)}}function xc(r,i){return ye(r,i),o=>bs(r(o))}function Uc(r,i){Ne(r,i);let o=r?.abort,l=r?.close,d=r?.start,h=r?.type,p=r?.write;return{abort:o===void 0?void 0:Wc(o,r,`${i} has member 'abort' that`),close:l===void 0?void 0:zc(l,r,`${i} has member 'close' that`),start:d===void 0?void 0:Nc(d,r,`${i} has member 'start' that`),write:p===void 0?void 0:$c(p,r,`${i} has member 'write' that`),type:h}}function Wc(r,i,o){return ye(r,o),l=>ft(r,i,[l])}function zc(r,i,o){return ye(r,o),()=>ft(r,i,[])}function Nc(r,i,o){return ye(r,o),l=>We(r,i,[l])}function $c(r,i,o){return ye(r,o),(l,d)=>ft(r,i,[l,d])}function Oo(r,i){if(!jt(r))throw new TypeError(`${i} is not a WritableStream.`)}function Vc(r){if(typeof r!="object"||r===null)return!1;try{return typeof r.aborted=="boolean"}catch{return!1}}let Hc=typeof AbortController=="function";function Qc(){if(Hc)return new AbortController}class hr{constructor(i={},o={}){i===void 0?i=null:ro(i,"First parameter");let l=an(o,"Second parameter"),d=Uc(i,"First parameter");if(Eo(this),d.type!==void 0)throw new RangeError("Invalid type is specified");let p=sn(l),y=fr(l,1);od(this,d,y,p)}get locked(){if(!jt(this))throw dn("locked");return Ft(this)}abort(i=void 0){return jt(this)?Ft(this)?_(new TypeError("Cannot abort a stream that already has a writer")):on(this,i):_(dn("abort"))}close(){return jt(this)?Ft(this)?_(new TypeError("Cannot close a stream that already has a writer")):Ce(this)?_(new TypeError("Cannot close an already-closing stream")):Io(this):_(dn("close"))}getWriter(){if(!jt(this))throw dn("getWriter");return Lo(this)}}Object.defineProperties(hr.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(hr.prototype,e.toStringTag,{value:"WritableStream",configurable:!0});function Lo(r){return new mr(r)}function Yc(r,i,o,l,d=1,h=()=>1){let p=Object.create(hr.prototype);Eo(p);let y=Object.create(Bt.prototype);return xo(p,y,r,i,o,l,d,h),p}function Eo(r){r._state="writable",r._storedError=void 0,r._writer=void 0,r._writableStreamController=void 0,r._writeRequests=new ge,r._inFlightWriteRequest=void 0,r._closeRequest=void 0,r._inFlightCloseRequest=void 0,r._pendingAbortRequest=void 0,r._backpressure=!1}function jt(r){return!u(r)||!Object.prototype.hasOwnProperty.call(r,"_writableStreamController")?!1:r instanceof hr}function Ft(r){return r._writer!==void 0}function on(r,i){var o;if(r._state==="closed"||r._state==="errored")return w(void 0);r._writableStreamController._abortReason=i,(o=r._writableStreamController._abortController)===null||o===void 0||o.abort();let l=r._state;if(l==="closed"||l==="errored")return w(void 0);if(r._pendingAbortRequest!==void 0)return r._pendingAbortRequest._promise;let d=!1;l==="erroring"&&(d=!0,i=void 0);let h=R((p,y)=>{r._pendingAbortRequest={_promise:void 0,_resolve:p,_reject:y,_reason:i,_wasAlreadyErroring:d}});return r._pendingAbortRequest._promise=h,d||Es(r,i),h}function Io(r){let i=r._state;if(i==="closed"||i==="errored")return _(new TypeError(`The stream (in ${i} state) is not in the writable state and cannot be closed`));let o=R((d,h)=>{let p={_resolve:d,_reject:h};r._closeRequest=p}),l=r._writer;return l!==void 0&&r._backpressure&&i==="writable"&&Ws(l),ud(r._writableStreamController),o}function Kc(r){return R((o,l)=>{let d={_resolve:o,_reject:l};r._writeRequests.push(d)})}function Ls(r,i){if(r._state==="writable"){Es(r,i);return}Is(r)}function Es(r,i){let o=r._writableStreamController;r._state="erroring",r._storedError=i;let l=r._writer;l!==void 0&&ko(l,i),!ed(r)&&o._started&&Is(r)}function Is(r){r._state="errored",r._writableStreamController[eo]();let i=r._storedError;if(r._writeRequests.forEach(d=>{d._reject(i)}),r._writeRequests=new ge,r._pendingAbortRequest===void 0){un(r);return}let o=r._pendingAbortRequest;if(r._pendingAbortRequest=void 0,o._wasAlreadyErroring){o._reject(i),un(r);return}let l=r._writableStreamController[Za](o._reason);O(l,()=>{o._resolve(),un(r)},d=>{o._reject(d),un(r)})}function Xc(r){r._inFlightWriteRequest._resolve(void 0),r._inFlightWriteRequest=void 0}function Gc(r,i){r._inFlightWriteRequest._reject(i),r._inFlightWriteRequest=void 0,Ls(r,i)}function Jc(r){r._inFlightCloseRequest._resolve(void 0),r._inFlightCloseRequest=void 0,r._state==="erroring"&&(r._storedError=void 0,r._pendingAbortRequest!==void 0&&(r._pendingAbortRequest._resolve(),r._pendingAbortRequest=void 0)),r._state="closed";let o=r._writer;o!==void 0&&No(o)}function Zc(r,i){r._inFlightCloseRequest._reject(i),r._inFlightCloseRequest=void 0,r._pendingAbortRequest!==void 0&&(r._pendingAbortRequest._reject(i),r._pendingAbortRequest=void 0),Ls(r,i)}function Ce(r){return!(r._closeRequest===void 0&&r._inFlightCloseRequest===void 0)}function ed(r){return!(r._inFlightWriteRequest===void 0&&r._inFlightCloseRequest===void 0)}function td(r){r._inFlightCloseRequest=r._closeRequest,r._closeRequest=void 0}function rd(r){r._inFlightWriteRequest=r._writeRequests.shift()}function un(r){r._closeRequest!==void 0&&(r._closeRequest._reject(r._storedError),r._closeRequest=void 0);let i=r._writer;i!==void 0&&xs(i,r._storedError)}function Ms(r,i){let o=r._writer;o!==void 0&&i!==r._backpressure&&(i?pd(o):Ws(o)),r._backpressure=i}class mr{constructor(i){if($e(i,1,"WritableStreamDefaultWriter"),Oo(i,"First parameter"),Ft(i))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=i,i._writer=this;let o=i._state;if(o==="writable")!Ce(i)&&i._backpressure?hn(this):$o(this),fn(this);else if(o==="erroring")Us(this,i._storedError),fn(this);else if(o==="closed")$o(this),hd(this);else{let l=i._storedError;Us(this,l),zo(this,l)}}get closed(){return _t(this)?this._closedPromise:_(gt("closed"))}get desiredSize(){if(!_t(this))throw gt("desiredSize");if(this._ownerWritableStream===void 0)throw pr("desiredSize");return ad(this)}get ready(){return _t(this)?this._readyPromise:_(gt("ready"))}abort(i=void 0){return _t(this)?this._ownerWritableStream===void 0?_(pr("abort")):nd(this,i):_(gt("abort"))}close(){if(!_t(this))return _(gt("close"));let i=this._ownerWritableStream;return i===void 0?_(pr("close")):Ce(i)?_(new TypeError("Cannot close an already-closing stream")):Mo(this)}releaseLock(){if(!_t(this))throw gt("releaseLock");this._ownerWritableStream!==void 0&&jo(this)}write(i=void 0){return _t(this)?this._ownerWritableStream===void 0?_(pr("write to")):Fo(this,i):_(gt("write"))}}Object.defineProperties(mr.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(mr.prototype,e.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function _t(r){return!u(r)||!Object.prototype.hasOwnProperty.call(r,"_ownerWritableStream")?!1:r instanceof mr}function nd(r,i){let o=r._ownerWritableStream;return on(o,i)}function Mo(r){let i=r._ownerWritableStream;return Io(i)}function sd(r){let i=r._ownerWritableStream,o=i._state;return Ce(i)||o==="closed"?w(void 0):o==="errored"?_(i._storedError):Mo(r)}function id(r,i){r._closedPromiseState==="pending"?xs(r,i):md(r,i)}function ko(r,i){r._readyPromiseState==="pending"?Vo(r,i):_d(r,i)}function ad(r){let i=r._ownerWritableStream,o=i._state;return o==="errored"||o==="erroring"?null:o==="closed"?0:Uo(i._writableStreamController)}function jo(r){let i=r._ownerWritableStream,o=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");ko(r,o),id(r,o),i._writer=void 0,r._ownerWritableStream=void 0}function Fo(r,i){let o=r._ownerWritableStream,l=o._writableStreamController,d=ld(l,i);if(o!==r._ownerWritableStream)return _(pr("write to"));let h=o._state;if(h==="errored")return _(o._storedError);if(Ce(o)||h==="closed")return _(new TypeError("The stream is closing or closed and cannot be written to"));if(h==="erroring")return _(o._storedError);let p=Kc(o);return cd(l,i,d),p}let Bo={};class Bt{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!ks(this))throw Bs("abortReason");return this._abortReason}get signal(){if(!ks(this))throw Bs("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(i=void 0){if(!ks(this))throw Bs("error");this._controlledWritableStream._state==="writable"&&Wo(this,i)}[Za](i){let o=this._abortAlgorithm(i);return ln(this),o}[eo](){Ze(this)}}Object.defineProperties(Bt.prototype,{error:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(Bt.prototype,e.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function ks(r){return!u(r)||!Object.prototype.hasOwnProperty.call(r,"_controlledWritableStream")?!1:r instanceof Bt}function xo(r,i,o,l,d,h,p,y){i._controlledWritableStream=r,r._writableStreamController=i,i._queue=void 0,i._queueTotalSize=void 0,Ze(i),i._abortReason=void 0,i._abortController=Qc(),i._started=!1,i._strategySizeAlgorithm=y,i._strategyHWM=p,i._writeAlgorithm=l,i._closeAlgorithm=d,i._abortAlgorithm=h;let v=Fs(i);Ms(r,v);let D=o(),k=w(D);O(k,()=>{i._started=!0,cn(i)},I=>{i._started=!0,Ls(r,I)})}function od(r,i,o,l){let d=Object.create(Bt.prototype),h=()=>{},p=()=>w(void 0),y=()=>w(void 0),v=()=>w(void 0);i.start!==void 0&&(h=()=>i.start(d)),i.write!==void 0&&(p=D=>i.write(D,d)),i.close!==void 0&&(y=()=>i.close()),i.abort!==void 0&&(v=D=>i.abort(D)),xo(r,d,h,p,y,v,o,l)}function ln(r){r._writeAlgorithm=void 0,r._closeAlgorithm=void 0,r._abortAlgorithm=void 0,r._strategySizeAlgorithm=void 0}function ud(r){Ts(r,Bo,0),cn(r)}function ld(r,i){try{return r._strategySizeAlgorithm(i)}catch(o){return js(r,o),1}}function Uo(r){return r._strategyHWM-r._queueTotalSize}function cd(r,i,o){try{Ts(r,i,o)}catch(d){js(r,d);return}let l=r._controlledWritableStream;if(!Ce(l)&&l._state==="writable"){let d=Fs(r);Ms(l,d)}cn(r)}function cn(r){let i=r._controlledWritableStream;if(!r._started||i._inFlightWriteRequest!==void 0)return;if(i._state==="erroring"){Is(i);return}if(r._queue.length===0)return;let l=Lc(r);l===Bo?dd(r):fd(r,l)}function js(r,i){r._controlledWritableStream._state==="writable"&&Wo(r,i)}function dd(r){let i=r._controlledWritableStream;td(i),vs(r);let o=r._closeAlgorithm();ln(r),O(o,()=>{Jc(i)},l=>{Zc(i,l)})}function fd(r,i){let o=r._controlledWritableStream;rd(o);let l=r._writeAlgorithm(i);O(l,()=>{Xc(o);let d=o._state;if(vs(r),!Ce(o)&&d==="writable"){let h=Fs(r);Ms(o,h)}cn(r)},d=>{o._state==="writable"&&ln(r),Gc(o,d)})}function Fs(r){return Uo(r)<=0}function Wo(r,i){let o=r._controlledWritableStream;ln(r),Es(o,i)}function dn(r){return new TypeError(`WritableStream.prototype.${r} can only be used on a WritableStream`)}function Bs(r){return new TypeError(`WritableStreamDefaultController.prototype.${r} can only be used on a WritableStreamDefaultController`)}function gt(r){return new TypeError(`WritableStreamDefaultWriter.prototype.${r} can only be used on a WritableStreamDefaultWriter`)}function pr(r){return new TypeError("Cannot "+r+" a stream using a released writer")}function fn(r){r._closedPromise=R((i,o)=>{r._closedPromise_resolve=i,r._closedPromise_reject=o,r._closedPromiseState="pending"})}function zo(r,i){fn(r),xs(r,i)}function hd(r){fn(r),No(r)}function xs(r,i){r._closedPromise_reject!==void 0&&(Ue(r._closedPromise),r._closedPromise_reject(i),r._closedPromise_resolve=void 0,r._closedPromise_reject=void 0,r._closedPromiseState="rejected")}function md(r,i){zo(r,i)}function No(r){r._closedPromise_resolve!==void 0&&(r._closedPromise_resolve(void 0),r._closedPromise_resolve=void 0,r._closedPromise_reject=void 0,r._closedPromiseState="resolved")}function hn(r){r._readyPromise=R((i,o)=>{r._readyPromise_resolve=i,r._readyPromise_reject=o}),r._readyPromiseState="pending"}function Us(r,i){hn(r),Vo(r,i)}function $o(r){hn(r),Ws(r)}function Vo(r,i){r._readyPromise_reject!==void 0&&(Ue(r._readyPromise),r._readyPromise_reject(i),r._readyPromise_resolve=void 0,r._readyPromise_reject=void 0,r._readyPromiseState="rejected")}function pd(r){hn(r)}function _d(r,i){Us(r,i)}function Ws(r){r._readyPromise_resolve!==void 0&&(r._readyPromise_resolve(void 0),r._readyPromise_resolve=void 0,r._readyPromise_reject=void 0,r._readyPromiseState="fulfilled")}let Ho=typeof DOMException<"u"?DOMException:void 0;function gd(r){if(!(typeof r=="function"||typeof r=="object"))return!1;try{return new r,!0}catch{return!1}}function yd(){let r=function(o,l){this.message=o||"",this.name=l||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return r.prototype=Object.create(Error.prototype),Object.defineProperty(r.prototype,"constructor",{value:r,writable:!0,configurable:!0}),r}let bd=gd(Ho)?Ho:yd();function Qo(r,i,o,l,d,h){let p=Mt(r),y=Lo(i);r._disturbed=!0;let v=!1,D=w(void 0);return R((k,I)=>{let B;if(h!==void 0){if(B=()=>{let T=new bd("Aborted","AbortError"),C=[];l||C.push(()=>i._state==="writable"?on(i,T):w(void 0)),d||C.push(()=>r._state==="readable"?we(r,T):w(void 0)),G(()=>Promise.all(C.map(U=>U())),!0,T)},h.aborted){B();return}h.addEventListener("abort",B)}function st(){return R((T,C)=>{function U(Se){Se?T():A(wr(),U,C)}U(!1)})}function wr(){return v?w(!0):A(y._readyPromise,()=>R((T,C)=>{ar(p,{_chunkSteps:U=>{D=A(Fo(y,U),void 0,t),T(!1)},_closeSteps:()=>T(!0),_errorSteps:C})}))}if(X(r,p._closedPromise,T=>{l?M(!0,T):G(()=>on(i,T),!0,T)}),X(i,y._closedPromise,T=>{d?M(!0,T):G(()=>we(r,T),!0,T)}),Oe(r,p._closedPromise,()=>{o?M():G(()=>sd(y))}),Ce(i)||i._state==="closed"){let T=new TypeError("the destination writable stream closed before all data could be piped to it");d?M(!0,T):G(()=>we(r,T),!0,T)}Ue(st());function it(){let T=D;return A(D,()=>T!==D?it():void 0)}function X(T,C,U){T._state==="errored"?U(T._storedError):Ae(C,U)}function Oe(T,C,U){T._state==="closed"?U():le(C,U)}function G(T,C,U){if(v)return;v=!0,i._state==="writable"&&!Ce(i)?le(it(),Se):Se();function Se(){O(T(),()=>j(C,U),at=>j(!0,at))}}function M(T,C){v||(v=!0,i._state==="writable"&&!Ce(i)?le(it(),()=>j(T,C)):j(T,C))}function j(T,C){jo(y),ze(p),h!==void 0&&h.removeEventListener("abort",B),T?I(C):k(void 0)}})}class xt{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!mn(this))throw gn("desiredSize");return zs(this)}close(){if(!mn(this))throw gn("close");if(!Ut(this))throw new TypeError("The stream is not in a state that permits close");gr(this)}enqueue(i=void 0){if(!mn(this))throw gn("enqueue");if(!Ut(this))throw new TypeError("The stream is not in a state that permits enqueue");return _n(this,i)}error(i=void 0){if(!mn(this))throw gn("error");et(this,i)}[_s](i){Ze(this);let o=this._cancelAlgorithm(i);return pn(this),o}[gs](i){let o=this._controlledReadableStream;if(this._queue.length>0){let l=vs(this);this._closeRequested&&this._queue.length===0?(pn(this),yr(o)):_r(this),i._chunkSteps(l)}else io(o,i),_r(this)}}Object.defineProperties(xt.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(xt.prototype,e.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function mn(r){return!u(r)||!Object.prototype.hasOwnProperty.call(r,"_controlledReadableStream")?!1:r instanceof xt}function _r(r){if(!Yo(r))return;if(r._pulling){r._pullAgain=!0;return}r._pulling=!0;let o=r._pullAlgorithm();O(o,()=>{r._pulling=!1,r._pullAgain&&(r._pullAgain=!1,_r(r))},l=>{et(r,l)})}function Yo(r){let i=r._controlledReadableStream;return!Ut(r)||!r._started?!1:!!(nt(i)&&Kr(i)>0||zs(r)>0)}function pn(r){r._pullAlgorithm=void 0,r._cancelAlgorithm=void 0,r._strategySizeAlgorithm=void 0}function gr(r){if(!Ut(r))return;let i=r._controlledReadableStream;r._closeRequested=!0,r._queue.length===0&&(pn(r),yr(i))}function _n(r,i){if(!Ut(r))return;let o=r._controlledReadableStream;if(nt(o)&&Kr(o)>0)Ss(o,i,!1);else{let l;try{l=r._strategySizeAlgorithm(i)}catch(d){throw et(r,d),d}try{Ts(r,i,l)}catch(d){throw et(r,d),d}}_r(r)}function et(r,i){let o=r._controlledReadableStream;o._state==="readable"&&(Ze(r),pn(r),Jo(o,i))}function zs(r){let i=r._controlledReadableStream._state;return i==="errored"?null:i==="closed"?0:r._strategyHWM-r._queueTotalSize}function wd(r){return!Yo(r)}function Ut(r){let i=r._controlledReadableStream._state;return!r._closeRequested&&i==="readable"}function Ko(r,i,o,l,d,h,p){i._controlledReadableStream=r,i._queue=void 0,i._queueTotalSize=void 0,Ze(i),i._started=!1,i._closeRequested=!1,i._pullAgain=!1,i._pulling=!1,i._strategySizeAlgorithm=p,i._strategyHWM=h,i._pullAlgorithm=l,i._cancelAlgorithm=d,r._readableStreamController=i;let y=o();O(w(y),()=>{i._started=!0,_r(i)},v=>{et(i,v)})}function Sd(r,i,o,l){let d=Object.create(xt.prototype),h=()=>{},p=()=>w(void 0),y=()=>w(void 0);i.start!==void 0&&(h=()=>i.start(d)),i.pull!==void 0&&(p=()=>i.pull(d)),i.cancel!==void 0&&(y=v=>i.cancel(v)),Ko(r,d,h,p,y,o,l)}function gn(r){return new TypeError(`ReadableStreamDefaultController.prototype.${r} can only be used on a ReadableStreamDefaultController`)}function vd(r,i){return ht(r._readableStreamController)?Rd(r):Td(r)}function Td(r,i){let o=Mt(r),l=!1,d=!1,h=!1,p,y,v,D,k,I=R(X=>{k=X});function B(){return l||(l=!0,ar(o,{_chunkSteps:Oe=>{_e(()=>{l=!1;let G=Oe,M=Oe;d||_n(v._readableStreamController,G),h||_n(D._readableStreamController,M)})},_closeSteps:()=>{l=!1,d||gr(v._readableStreamController),h||gr(D._readableStreamController),(!d||!h)&&k(void 0)},_errorSteps:()=>{l=!1}})),w(void 0)}function st(X){if(d=!0,p=X,h){let Oe=or([p,y]),G=we(r,Oe);k(G)}return I}function wr(X){if(h=!0,y=X,d){let Oe=or([p,y]),G=we(r,Oe);k(G)}return I}function it(){}return v=Ns(it,B,st),D=Ns(it,B,wr),Ae(o._closedPromise,X=>{et(v._readableStreamController,X),et(D._readableStreamController,X),(!d||!h)&&k(void 0)}),[v,D]}function Rd(r){let i=Mt(r),o=!1,l=!1,d=!1,h,p,y,v,D,k=R(M=>{D=M});function I(M){Ae(M._closedPromise,j=>{M===i&&(be(y._readableStreamController,j),be(v._readableStreamController,j),(!l||!d)&&D(void 0))})}function B(){pt(i)&&(ze(i),i=Mt(r),I(i)),ar(i,{_chunkSteps:j=>{_e(()=>{o=!1;let T=j,C=j;if(!l&&!d)try{C=_o(j)}catch(U){be(y._readableStreamController,U),be(v._readableStreamController,U),D(we(r,U));return}l||en(y._readableStreamController,T),d||en(v._readableStreamController,C)})},_closeSteps:()=>{o=!1,l||lr(y._readableStreamController),d||lr(v._readableStreamController),y._readableStreamController._pendingPullIntos.length>0&&tn(y._readableStreamController,0),v._readableStreamController._pendingPullIntos.length>0&&tn(v._readableStreamController,0),(!l||!d)&&D(void 0)},_errorSteps:()=>{o=!1}})}function st(M,j){Je(i)&&(ze(i),i=qo(r),I(i));let T=j?v:y,C=j?y:v;Co(i,M,{_chunkSteps:Se=>{_e(()=>{o=!1;let at=j?d:l;if(j?l:d)at||rn(T._readableStreamController,Se);else{let du;try{du=_o(Se)}catch(Vs){be(T._readableStreamController,Vs),be(C._readableStreamController,Vs),D(we(r,Vs));return}at||rn(T._readableStreamController,Se),en(C._readableStreamController,du)}})},_closeSteps:Se=>{o=!1;let at=j?d:l,qn=j?l:d;at||lr(T._readableStreamController),qn||lr(C._readableStreamController),Se!==void 0&&(at||rn(T._readableStreamController,Se),!qn&&C._readableStreamController._pendingPullIntos.length>0&&tn(C._readableStreamController,0)),(!at||!qn)&&D(void 0)},_errorSteps:()=>{o=!1}})}function wr(){if(o)return w(void 0);o=!0;let M=As(y._readableStreamController);return M===null?B():st(M._view,!1),w(void 0)}function it(){if(o)return w(void 0);o=!0;let M=As(v._readableStreamController);return M===null?B():st(M._view,!0),w(void 0)}function X(M){if(l=!0,h=M,d){let j=or([h,p]),T=we(r,j);D(T)}return k}function Oe(M){if(d=!0,p=M,l){let j=or([h,p]),T=we(r,j);D(T)}return k}function G(){}return y=Go(G,wr,X),v=Go(G,it,Oe),I(i),[y,v]}function Pd(r,i){Ne(r,i);let o=r,l=o?.autoAllocateChunkSize,d=o?.cancel,h=o?.pull,p=o?.start,y=o?.type;return{autoAllocateChunkSize:l===void 0?void 0:so(l,`${i} has member 'autoAllocateChunkSize' that`),cancel:d===void 0?void 0:qd(d,o,`${i} has member 'cancel' that`),pull:h===void 0?void 0:Dd(h,o,`${i} has member 'pull' that`),start:p===void 0?void 0:Ad(p,o,`${i} has member 'start' that`),type:y===void 0?void 0:Cd(y,`${i} has member 'type' that`)}}function qd(r,i,o){return ye(r,o),l=>ft(r,i,[l])}function Dd(r,i,o){return ye(r,o),l=>ft(r,i,[l])}function Ad(r,i,o){return ye(r,o),l=>We(r,i,[l])}function Cd(r,i){if(r=`${r}`,r!=="bytes")throw new TypeError(`${i} '${r}' is not a valid enumeration value for ReadableStreamType`);return r}function Od(r,i){Ne(r,i);let o=r?.mode;return{mode:o===void 0?void 0:Ld(o,`${i} has member 'mode' that`)}}function Ld(r,i){if(r=`${r}`,r!=="byob")throw new TypeError(`${i} '${r}' is not a valid enumeration value for ReadableStreamReaderMode`);return r}function Ed(r,i){return Ne(r,i),{preventCancel:!!r?.preventCancel}}function Xo(r,i){Ne(r,i);let o=r?.preventAbort,l=r?.preventCancel,d=r?.preventClose,h=r?.signal;return h!==void 0&&Id(h,`${i} has member 'signal' that`),{preventAbort:!!o,preventCancel:!!l,preventClose:!!d,signal:h}}function Id(r,i){if(!Vc(r))throw new TypeError(`${i} is not an AbortSignal.`)}function Md(r,i){Ne(r,i);let o=r?.readable;ys(o,"readable","ReadableWritablePair"),ws(o,`${i} has member 'readable' that`);let l=r?.writable;return ys(l,"writable","ReadableWritablePair"),Oo(l,`${i} has member 'writable' that`),{readable:o,writable:l}}class tt{constructor(i={},o={}){i===void 0?i=null:ro(i,"First parameter");let l=an(o,"Second parameter"),d=Pd(i,"First parameter");if($s(this),d.type==="bytes"){if(l.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let h=fr(l,0);jc(this,d,h)}else{let h=sn(l),p=fr(l,1);Sd(this,d,p,h)}}get locked(){if(!rt(this))throw yt("locked");return nt(this)}cancel(i=void 0){return rt(this)?nt(this)?_(new TypeError("Cannot cancel a stream that already has a reader")):we(this,i):_(yt("cancel"))}getReader(i=void 0){if(!rt(this))throw yt("getReader");return Od(i,"First parameter").mode===void 0?Mt(this):qo(this)}pipeThrough(i,o={}){if(!rt(this))throw yt("pipeThrough");$e(i,1,"pipeThrough");let l=Md(i,"First parameter"),d=Xo(o,"Second parameter");if(nt(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(Ft(l.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let h=Qo(this,l.writable,d.preventClose,d.preventAbort,d.preventCancel,d.signal);return Ue(h),l.readable}pipeTo(i,o={}){if(!rt(this))return _(yt("pipeTo"));if(i===void 0)return _("Parameter 1 is required in 'pipeTo'.");if(!jt(i))return _(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let l;try{l=Xo(o,"Second parameter")}catch(d){return _(d)}return nt(this)?_(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):Ft(i)?_(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):Qo(this,i,l.preventClose,l.preventAbort,l.preventCancel,l.signal)}tee(){if(!rt(this))throw yt("tee");let i=vd(this);return or(i)}values(i=void 0){if(!rt(this))throw yt("values");let o=Ed(i,"First parameter");return Cc(this,o.preventCancel)}}Object.defineProperties(tt.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(tt.prototype,e.toStringTag,{value:"ReadableStream",configurable:!0}),typeof e.asyncIterator=="symbol"&&Object.defineProperty(tt.prototype,e.asyncIterator,{value:tt.prototype.values,writable:!0,configurable:!0});function Ns(r,i,o,l=1,d=()=>1){let h=Object.create(tt.prototype);$s(h);let p=Object.create(xt.prototype);return Ko(h,p,r,i,o,l,d),h}function Go(r,i,o){let l=Object.create(tt.prototype);$s(l);let d=Object.create(kt.prototype);return Po(l,d,r,i,o,0,void 0),l}function $s(r){r._state="readable",r._reader=void 0,r._storedError=void 0,r._disturbed=!1}function rt(r){return!u(r)||!Object.prototype.hasOwnProperty.call(r,"_readableStreamController")?!1:r instanceof tt}function nt(r){return r._reader!==void 0}function we(r,i){if(r._disturbed=!0,r._state==="closed")return w(void 0);if(r._state==="errored")return _(r._storedError);yr(r);let o=r._reader;o!==void 0&&pt(o)&&(o._readIntoRequests.forEach(d=>{d._closeSteps(void 0)}),o._readIntoRequests=new ge);let l=r._readableStreamController[_s](i);return xe(l,t)}function yr(r){r._state="closed";let i=r._reader;i!==void 0&&(Ja(i),Je(i)&&(i._readRequests.forEach(o=>{o._closeSteps()}),i._readRequests=new ge))}function Jo(r,i){r._state="errored",r._storedError=i;let o=r._reader;o!==void 0&&(ps(o,i),Je(o)?(o._readRequests.forEach(l=>{l._errorSteps(i)}),o._readRequests=new ge):(o._readIntoRequests.forEach(l=>{l._errorSteps(i)}),o._readIntoRequests=new ge))}function yt(r){return new TypeError(`ReadableStream.prototype.${r} can only be used on a ReadableStream`)}function Zo(r,i){Ne(r,i);let o=r?.highWaterMark;return ys(o,"highWaterMark","QueuingStrategyInit"),{highWaterMark:bs(o)}}let eu=r=>r.byteLength;Object.defineProperty(eu,"name",{value:"size",configurable:!0});class yn{constructor(i){$e(i,1,"ByteLengthQueuingStrategy"),i=Zo(i,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=i.highWaterMark}get highWaterMark(){if(!ru(this))throw tu("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!ru(this))throw tu("size");return eu}}Object.defineProperties(yn.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(yn.prototype,e.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function tu(r){return new TypeError(`ByteLengthQueuingStrategy.prototype.${r} can only be used on a ByteLengthQueuingStrategy`)}function ru(r){return!u(r)||!Object.prototype.hasOwnProperty.call(r,"_byteLengthQueuingStrategyHighWaterMark")?!1:r instanceof yn}let nu=()=>1;Object.defineProperty(nu,"name",{value:"size",configurable:!0});class bn{constructor(i){$e(i,1,"CountQueuingStrategy"),i=Zo(i,"First parameter"),this._countQueuingStrategyHighWaterMark=i.highWaterMark}get highWaterMark(){if(!iu(this))throw su("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!iu(this))throw su("size");return nu}}Object.defineProperties(bn.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(bn.prototype,e.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function su(r){return new TypeError(`CountQueuingStrategy.prototype.${r} can only be used on a CountQueuingStrategy`)}function iu(r){return!u(r)||!Object.prototype.hasOwnProperty.call(r,"_countQueuingStrategyHighWaterMark")?!1:r instanceof bn}function kd(r,i){Ne(r,i);let o=r?.flush,l=r?.readableType,d=r?.start,h=r?.transform,p=r?.writableType;return{flush:o===void 0?void 0:jd(o,r,`${i} has member 'flush' that`),readableType:l,start:d===void 0?void 0:Fd(d,r,`${i} has member 'start' that`),transform:h===void 0?void 0:Bd(h,r,`${i} has member 'transform' that`),writableType:p}}function jd(r,i,o){return ye(r,o),l=>ft(r,i,[l])}function Fd(r,i,o){return ye(r,o),l=>We(r,i,[l])}function Bd(r,i,o){return ye(r,o),(l,d)=>ft(r,i,[l,d])}class wn{constructor(i={},o={},l={}){i===void 0&&(i=null);let d=an(o,"Second parameter"),h=an(l,"Third parameter"),p=kd(i,"First parameter");if(p.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(p.writableType!==void 0)throw new RangeError("Invalid writableType specified");let y=fr(h,0),v=sn(h),D=fr(d,1),k=sn(d),I,B=R(st=>{I=st});xd(this,B,D,k,y,v),Wd(this,p),p.start!==void 0?I(p.start(this._transformStreamController)):I(void 0)}get readable(){if(!au(this))throw cu("readable");return this._readable}get writable(){if(!au(this))throw cu("writable");return this._writable}}Object.defineProperties(wn.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(wn.prototype,e.toStringTag,{value:"TransformStream",configurable:!0});function xd(r,i,o,l,d,h){function p(){return i}function y(B){return $d(r,B)}function v(B){return Vd(r,B)}function D(){return Hd(r)}r._writable=Yc(p,y,D,v,o,l);function k(){return Qd(r)}function I(B){return vn(r,B),w(void 0)}r._readable=Ns(p,k,I,d,h),r._backpressure=void 0,r._backpressureChangePromise=void 0,r._backpressureChangePromise_resolve=void 0,Tn(r,!0),r._transformStreamController=void 0}function au(r){return!u(r)||!Object.prototype.hasOwnProperty.call(r,"_transformStreamController")?!1:r instanceof wn}function Sn(r,i){et(r._readable._readableStreamController,i),vn(r,i)}function vn(r,i){ou(r._transformStreamController),js(r._writable._writableStreamController,i),r._backpressure&&Tn(r,!1)}function Tn(r,i){r._backpressureChangePromise!==void 0&&r._backpressureChangePromise_resolve(),r._backpressureChangePromise=R(o=>{r._backpressureChangePromise_resolve=o}),r._backpressure=i}class br{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Rn(this))throw Pn("desiredSize");let i=this._controlledTransformStream._readable._readableStreamController;return zs(i)}enqueue(i=void 0){if(!Rn(this))throw Pn("enqueue");uu(this,i)}error(i=void 0){if(!Rn(this))throw Pn("error");zd(this,i)}terminate(){if(!Rn(this))throw Pn("terminate");Nd(this)}}Object.defineProperties(br.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof e.toStringTag=="symbol"&&Object.defineProperty(br.prototype,e.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function Rn(r){return!u(r)||!Object.prototype.hasOwnProperty.call(r,"_controlledTransformStream")?!1:r instanceof br}function Ud(r,i,o,l){i._controlledTransformStream=r,r._transformStreamController=i,i._transformAlgorithm=o,i._flushAlgorithm=l}function Wd(r,i){let o=Object.create(br.prototype),l=h=>{try{return uu(o,h),w(void 0)}catch(p){return _(p)}},d=()=>w(void 0);i.transform!==void 0&&(l=h=>i.transform(h,o)),i.flush!==void 0&&(d=()=>i.flush(o)),Ud(r,o,l,d)}function ou(r){r._transformAlgorithm=void 0,r._flushAlgorithm=void 0}function uu(r,i){let o=r._controlledTransformStream,l=o._readable._readableStreamController;if(!Ut(l))throw new TypeError("Readable side is not in a state that permits enqueue");try{_n(l,i)}catch(h){throw vn(o,h),o._readable._storedError}wd(l)!==o._backpressure&&Tn(o,!0)}function zd(r,i){Sn(r._controlledTransformStream,i)}function lu(r,i){let o=r._transformAlgorithm(i);return xe(o,void 0,l=>{throw Sn(r._controlledTransformStream,l),l})}function Nd(r){let i=r._controlledTransformStream,o=i._readable._readableStreamController;gr(o);let l=new TypeError("TransformStream terminated");vn(i,l)}function $d(r,i){let o=r._transformStreamController;if(r._backpressure){let l=r._backpressureChangePromise;return xe(l,()=>{let d=r._writable;if(d._state==="erroring")throw d._storedError;return lu(o,i)})}return lu(o,i)}function Vd(r,i){return Sn(r,i),w(void 0)}function Hd(r){let i=r._readable,o=r._transformStreamController,l=o._flushAlgorithm();return ou(o),xe(l,()=>{if(i._state==="errored")throw i._storedError;gr(i._readableStreamController)},d=>{throw Sn(r,d),i._storedError})}function Qd(r){return Tn(r,!1),r._backpressureChangePromise}function Pn(r){return new TypeError(`TransformStreamDefaultController.prototype.${r} can only be used on a TransformStreamDefaultController`)}function cu(r){return new TypeError(`TransformStream.prototype.${r} can only be used on a TransformStream`)}s.ByteLengthQueuingStrategy=yn,s.CountQueuingStrategy=bn,s.ReadableByteStreamController=kt,s.ReadableStream=tt,s.ReadableStreamBYOBReader=dr,s.ReadableStreamBYOBRequest=ur,s.ReadableStreamDefaultController=xt,s.ReadableStreamDefaultReader=ir,s.TransformStream=wn,s.TransformStreamDefaultController=br,s.WritableStream=hr,s.WritableStreamDefaultController=Bt,s.WritableStreamDefaultWriter=mr,Object.defineProperty(s,"__esModule",{value:!0})})});var gu=g(()=>{if(!globalThis.ReadableStream)try{Object.assign(globalThis,require("stream/web"))}catch{Object.assign(globalThis,_u())}try{let{Blob:s}=require("buffer");s&&!s.prototype.stream&&(s.prototype.stream=function(t){let n=0,a=this;return new ReadableStream({type:"bytes",async pull(u){let f=await a.slice(n,Math.min(a.size,n+65536)).arrayBuffer();n+=f.byteLength,u.enqueue(new Uint8Array(f)),n===a.size&&u.close()}})})}catch{}});var Te=g(de=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});de.API_V1_1_STREAM_PREFIX=de.API_V1_1_UPLOAD_PREFIX=de.API_V1_1_PREFIX=de.API_V2_LABS_PREFIX=de.API_V2_PREFIX=void 0;de.API_V2_PREFIX="https://api.twitter.com/2/";de.API_V2_LABS_PREFIX="https://api.twitter.com/labs/2/";de.API_V1_1_PREFIX="https://api.twitter.com/1.1/";de.API_V1_1_UPLOAD_PREFIX="https://upload.twitter.com/1.1/";de.API_V1_1_STREAM_PREFIX="https://stream.twitter.com/1.1/"});var $t=g(wt=>{"use strict";Object.defineProperty(wt,"__esModule",{value:!0});wt.PreviousableTwitterPaginator=wt.TwitterPaginator=void 0;var qr=class{constructor({realData:e,rateLimit:t,instance:n,queryParams:a,sharedParams:u}){this._maxResultsWhenFetchLast=100,this._realData=e,this._rateLimit=t,this._instance=n,this._queryParams=a,this._sharedParams=u}get _isRateLimitOk(){return!this._rateLimit||this._rateLimit.reset*1e3<Date.now()?!0:this._rateLimit.remaining>0}makeRequest(e){return this._instance.get(this.getEndpoint(),e,{fullResponse:!0,params:this._sharedParams})}makeNewInstanceFromResult(e,t){return new this.constructor({realData:e.data,rateLimit:e.rateLimit,instance:this._instance,queryParams:t,sharedParams:this._sharedParams})}getEndpoint(){return this._endpoint}injectQueryParams(e){return{...e?{max_results:e}:{},...this._queryParams}}async next(e){let t=this.getNextQueryParams(e),n=await this.makeRequest(t);return this.makeNewInstanceFromResult(n,t)}async fetchNext(e){let t=this.getNextQueryParams(e),n=await this.makeRequest(t);return await this.refreshInstanceFromResult(n,!0),this}async fetchLast(e=1/0){let t=this.getNextQueryParams(this._maxResultsWhenFetchLast),n=0;for(;n<e&&this._isRateLimitOk;){let a=await this.makeRequest(t);if(await this.refreshInstanceFromResult(a,!0),n+=this.getPageLengthFromRequest(a),this.isFetchLastOver(a))break;t=this.getNextQueryParams(this._maxResultsWhenFetchLast)}return this}get rateLimit(){var e;return{...(e=this._rateLimit)!==null&&e!==void 0?e:{}}}get data(){return this._realData}get done(){return!this.canFetchNextPage(this._realData)}*[Symbol.iterator](){yield*this.getItemArray()}async*[Symbol.asyncIterator](){yield*this.getItemArray();let e=this,t=this.canFetchNextPage(this._realData);for(;t&&this._isRateLimitOk&&e.getItemArray().length>0;){let n=await e.next(this._maxResultsWhenFetchLast);this.refreshInstanceFromResult({data:n._realData,headers:{},rateLimit:n._rateLimit},!0),t=this.canFetchNextPage(n._realData),yield*n.getItemArray(),e=n}}async*fetchAndIterate(){for(let n of this.getItemArray())yield[n,this];let e=this,t=this.canFetchNextPage(this._realData);for(;t&&this._isRateLimitOk&&e.getItemArray().length>0;){let n=await e.next(this._maxResultsWhenFetchLast);this.refreshInstanceFromResult({data:n._realData,headers:{},rateLimit:n._rateLimit},!0),t=this.canFetchNextPage(n._realData);for(let a of n.getItemArray())yield[a,n];this._rateLimit=n._rateLimit,e=n}}};wt.TwitterPaginator=qr;var Zs=class extends qr{async previous(e){let t=this.getPreviousQueryParams(e),n=await this.makeRequest(t);return this.makeNewInstanceFromResult(n,t)}async fetchPrevious(e){let t=this.getPreviousQueryParams(e),n=await this.makeRequest(t);return await this.refreshInstanceFromResult(n,!1),this}};wt.PreviousableTwitterPaginator=Zs;wt.default=qr});var St=g(Vt=>{"use strict";var df=Vt&&Vt.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Vt,"__esModule",{value:!0});Vt.CursoredV1Paginator=void 0;var ff=df($t()),ei=class extends ff.default{getNextQueryParams(e){var t;return{...this._queryParams,cursor:(t=this._realData.next_cursor_str)!==null&&t!==void 0?t:this._realData.next_cursor,...e?{count:e}:{}}}isFetchLastOver(e){return!this.canFetchNextPage(e.data)}canFetchNextPage(e){return!this.isNextCursorInvalid(e.next_cursor)||!this.isNextCursorInvalid(e.next_cursor_str)}isNextCursorInvalid(e){return e===void 0||e===0||e===-1||e==="0"||e==="-1"}};Vt.CursoredV1Paginator=ei});var ni=g(Ht=>{"use strict";Object.defineProperty(Ht,"__esModule",{value:!0});Ht.WelcomeDmV1Paginator=Ht.DmEventsV1Paginator=void 0;var Uu=St(),ti=class extends Uu.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="direct_messages/events/list.json"}refreshInstanceFromResult(e,t){let n=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.events.push(...n.events),this._realData.next_cursor=n.next_cursor)}getPageLengthFromRequest(e){return e.data.events.length}getItemArray(){return this.events}get events(){return this._realData.events}};Ht.DmEventsV1Paginator=ti;var ri=class extends Uu.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="direct_messages/welcome_messages/list.json"}refreshInstanceFromResult(e,t){let n=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.welcome_messages.push(...n.welcome_messages),this._realData.next_cursor=n.next_cursor)}getPageLengthFromRequest(e){return e.data.welcome_messages.length}getItemArray(){return this.welcomeMessages}get welcomeMessages(){return this._realData.welcome_messages}};Ht.WelcomeDmV1Paginator=ri});var zu=g(Wu=>{"use strict";Object.defineProperty(Wu,"__esModule",{value:!0})});var Nu=g(Dr=>{"use strict";Object.defineProperty(Dr,"__esModule",{value:!0});Dr.EUploadMimeType=void 0;var hf;(function(s){s.Jpeg="image/jpeg",s.Mp4="video/mp4",s.Mov="video/quicktime",s.Gif="image/gif",s.Png="image/png",s.Srt="text/plain",s.Webp="image/webp"})(hf=Dr.EUploadMimeType||(Dr.EUploadMimeType={}))});var Vu=g($u=>{"use strict";Object.defineProperty($u,"__esModule",{value:!0})});var Qu=g(Hu=>{"use strict";Object.defineProperty(Hu,"__esModule",{value:!0})});var Ku=g(Yu=>{"use strict";Object.defineProperty(Yu,"__esModule",{value:!0})});var Gu=g(Xu=>{"use strict";Object.defineProperty(Xu,"__esModule",{value:!0})});var Zu=g(Ju=>{"use strict";Object.defineProperty(Ju,"__esModule",{value:!0})});var el=g(Ar=>{"use strict";Object.defineProperty(Ar,"__esModule",{value:!0});Ar.EDirectMessageEventTypeV1=void 0;var mf;(function(s){s.Create="message_create",s.WelcomeCreate="welcome_message"})(mf=Ar.EDirectMessageEventTypeV1||(Ar.EDirectMessageEventTypeV1={}))});var rl=g(tl=>{"use strict";Object.defineProperty(tl,"__esModule",{value:!0})});var nl=g(Q=>{"use strict";var pf=Q&&Q.__createBinding||(Object.create?function(s,e,t,n){n===void 0&&(n=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,n,a)}:function(s,e,t,n){n===void 0&&(n=t),s[n]=e[t]}),Ye=Q&&Q.__exportStar||function(s,e){for(var t in s)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&pf(e,s,t)};Object.defineProperty(Q,"__esModule",{value:!0});Ye(zu(),Q);Ye(Nu(),Q);Ye(Vu(),Q);Ye(Qu(),Q);Ye(Ku(),Q);Ye(Gu(),Q);Ye(Zu(),Q);Ye(el(),Q);Ye(rl(),Q)});var il=g(sl=>{"use strict";Object.defineProperty(sl,"__esModule",{value:!0})});var ol=g(al=>{"use strict";Object.defineProperty(al,"__esModule",{value:!0})});var ll=g(ul=>{"use strict";Object.defineProperty(ul,"__esModule",{value:!0})});var dl=g(cl=>{"use strict";Object.defineProperty(cl,"__esModule",{value:!0})});var hl=g(fl=>{"use strict";Object.defineProperty(fl,"__esModule",{value:!0})});var pl=g(ml=>{"use strict";Object.defineProperty(ml,"__esModule",{value:!0})});var _l=g(fe=>{"use strict";var _f=fe&&fe.__createBinding||(Object.create?function(s,e,t,n){n===void 0&&(n=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,n,a)}:function(s,e,t,n){n===void 0&&(n=t),s[n]=e[t]}),Qt=fe&&fe.__exportStar||function(s,e){for(var t in s)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&_f(e,s,t)};Object.defineProperty(fe,"__esModule",{value:!0});Qt(il(),fe);Qt(ol(),fe);Qt(ll(),fe);Qt(dl(),fe);Qt(hl(),fe);Qt(pl(),fe)});var gl=g($=>{"use strict";Object.defineProperty($,"__esModule",{value:!0});$.EApiV2ErrorCode=$.EApiV1ErrorCode=$.ApiResponseError=$.ApiPartialResponseError=$.ApiRequestError=$.ETwitterApiError=void 0;var Bn;(function(s){s.Request="request",s.PartialResponse="partial-response",s.Response="response"})(Bn=$.ETwitterApiError||($.ETwitterApiError={}));var Cr=class extends Error{constructor(){super(...arguments),this.error=!0}},si=class extends Cr{constructor(e,t){super(e),this.type=Bn.Request,Error.captureStackTrace(this,this.constructor),Object.defineProperty(this,"_options",{value:t})}get request(){return this._options.request}get requestError(){return this._options.requestError}toJSON(){return{type:this.type,error:this.requestError}}};$.ApiRequestError=si;var ii=class extends Cr{constructor(e,t){super(e),this.type=Bn.PartialResponse,Error.captureStackTrace(this,this.constructor),Object.defineProperty(this,"_options",{value:t})}get request(){return this._options.request}get response(){return this._options.response}get responseError(){return this._options.responseError}get rawContent(){return this._options.rawContent}toJSON(){return{type:this.type,error:this.responseError}}};$.ApiPartialResponseError=ii;var ai=class extends Cr{constructor(e,t){if(super(e),this.type=Bn.Response,Error.captureStackTrace(this,this.constructor),Object.defineProperty(this,"_options",{value:t}),this.code=t.code,this.headers=t.headers,this.rateLimit=t.rateLimit,t.data&&typeof t.data=="object"&&"error"in t.data&&!t.data.errors){let n={...t.data};n.errors=[{code:Yt.InternalError,message:n.error}],this.data=n}else this.data=t.data}get request(){return this._options.request}get response(){return this._options.response}hasErrorCode(...e){let t=this.errors;if(!t?.length)return!1;if("code"in t[0])return t.some(u=>e.includes(u.code));let n=this.data;return e.includes(n.type)}get errors(){var e;return(e=this.data)===null||e===void 0?void 0:e.errors}get rateLimitError(){return this.code===420||this.code===429}get isAuthError(){return this.code===401?!0:this.hasErrorCode(Yt.AuthTimestampInvalid,Yt.AuthenticationFail,Yt.BadAuthenticationData,Yt.InvalidOrExpiredToken)}toJSON(){return{type:this.type,code:this.code,error:this.data,rateLimit:this.rateLimit,headers:this.headers}}};$.ApiResponseError=ai;var Yt;(function(s){s[s.InvalidCoordinates=3]="InvalidCoordinates",s[s.NoLocationFound=13]="NoLocationFound",s[s.AuthenticationFail=32]="AuthenticationFail",s[s.InvalidOrExpiredToken=89]="InvalidOrExpiredToken",s[s.UnableToVerifyCredentials=99]="UnableToVerifyCredentials",s[s.AuthTimestampInvalid=135]="AuthTimestampInvalid",s[s.BadAuthenticationData=215]="BadAuthenticationData",s[s.NoUserMatch=17]="NoUserMatch",s[s.UserNotFound=50]="UserNotFound",s[s.ResourceNotFound=34]="ResourceNotFound",s[s.TweetNotFound=144]="TweetNotFound",s[s.TweetNotVisible=179]="TweetNotVisible",s[s.NotAllowedResource=220]="NotAllowedResource",s[s.MediaIdNotFound=325]="MediaIdNotFound",s[s.TweetNoLongerAvailable=421]="TweetNoLongerAvailable",s[s.TweetViolatedRules=422]="TweetViolatedRules",s[s.TargetUserSuspended=63]="TargetUserSuspended",s[s.YouAreSuspended=64]="YouAreSuspended",s[s.AccountUpdateFailed=120]="AccountUpdateFailed",s[s.NoSelfSpamReport=36]="NoSelfSpamReport",s[s.NoSelfMute=271]="NoSelfMute",s[s.AccountLocked=326]="AccountLocked",s[s.RateLimitExceeded=88]="RateLimitExceeded",s[s.NoDMRightForApp=93]="NoDMRightForApp",s[s.OverCapacity=130]="OverCapacity",s[s.InternalError=131]="InternalError",s[s.TooManyFollowings=161]="TooManyFollowings",s[s.TweetLimitExceeded=185]="TweetLimitExceeded",s[s.DuplicatedTweet=187]="DuplicatedTweet",s[s.TooManySpamReports=205]="TooManySpamReports",s[s.RequestLooksLikeSpam=226]="RequestLooksLikeSpam",s[s.NoWriteRightForApp=261]="NoWriteRightForApp",s[s.TweetActionsDisabled=425]="TweetActionsDisabled",s[s.TweetRepliesRestricted=433]="TweetRepliesRestricted",s[s.NamedParameterMissing=38]="NamedParameterMissing",s[s.InvalidAttachmentUrl=44]="InvalidAttachmentUrl",s[s.TweetTextTooLong=186]="TweetTextTooLong",s[s.MissingUrlParameter=195]="MissingUrlParameter",s[s.NoMultipleGifs=323]="NoMultipleGifs",s[s.InvalidMediaIds=324]="InvalidMediaIds",s[s.InvalidUrl=407]="InvalidUrl",s[s.TooManyTweetAttachments=386]="TooManyTweetAttachments",s[s.StatusAlreadyFavorited=139]="StatusAlreadyFavorited",s[s.FollowRequestAlreadySent=160]="FollowRequestAlreadySent",s[s.CannotUnmuteANonMutedAccount=272]="CannotUnmuteANonMutedAccount",s[s.TweetAlreadyRetweeted=327]="TweetAlreadyRetweeted",s[s.ReplyToDeletedTweet=385]="ReplyToDeletedTweet",s[s.DMReceiverNotFollowingYou=150]="DMReceiverNotFollowingYou",s[s.UnableToSendDM=151]="UnableToSendDM",s[s.MustAllowDMFromAnyone=214]="MustAllowDMFromAnyone",s[s.CannotSendDMToThisUser=349]="CannotSendDMToThisUser",s[s.DMTextTooLong=354]="DMTextTooLong",s[s.SubscriptionAlreadyExists=355]="SubscriptionAlreadyExists",s[s.CallbackUrlNotApproved=415]="CallbackUrlNotApproved",s[s.SuspendedApplication=416]="SuspendedApplication",s[s.OobOauthIsNotAllowed=417]="OobOauthIsNotAllowed"})(Yt=$.EApiV1ErrorCode||($.EApiV1ErrorCode={}));var gf;(function(s){s.InvalidRequest="https://api.twitter.com/2/problems/invalid-request",s.ClientForbidden="https://api.twitter.com/2/problems/client-forbidden",s.UnsupportedAuthentication="https://api.twitter.com/2/problems/unsupported-authentication",s.InvalidRules="https://api.twitter.com/2/problems/invalid-rules",s.TooManyRules="https://api.twitter.com/2/problems/rule-cap",s.DuplicatedRules="https://api.twitter.com/2/problems/duplicate-rules",s.RateLimitExceeded="https://api.twitter.com/2/problems/usage-capped",s.ConnectionError="https://api.twitter.com/2/problems/streaming-connection",s.ClientDisconnected="https://api.twitter.com/2/problems/client-disconnected",s.TwitterDisconnectedYou="https://api.twitter.com/2/problems/operational-disconnect",s.ResourceNotFound="https://api.twitter.com/2/problems/resource-not-found",s.ResourceUnauthorized="https://api.twitter.com/2/problems/not-authorized-for-resource",s.DisallowedResource="https://api.twitter.com/2/problems/disallowed-resource"})(gf=$.EApiV2ErrorCode||($.EApiV2ErrorCode={}))});var bl=g(yl=>{"use strict";Object.defineProperty(yl,"__esModule",{value:!0})});var wl=g(Or=>{"use strict";Object.defineProperty(Or,"__esModule",{value:!0});Or.ETwitterStreamEvent=void 0;var yf;(function(s){s.Connected="connected",s.ConnectError="connect error",s.ConnectionError="connection error",s.ConnectionClosed="connection closed",s.ConnectionLost="connection lost",s.ReconnectAttempt="reconnect attempt",s.Reconnected="reconnected",s.ReconnectError="reconnect error",s.ReconnectLimitExceeded="reconnect limit exceeded",s.DataKeepAlive="data keep-alive",s.Data="data event content",s.DataError="data twitter error",s.TweetParseError="data tweet parse error",s.Error="stream error"})(yf=Or.ETwitterStreamEvent||(Or.ETwitterStreamEvent={}))});var vl=g(Sl=>{"use strict";Object.defineProperty(Sl,"__esModule",{value:!0})});var Tl=g(xn=>{"use strict";Object.defineProperty(xn,"__esModule",{value:!0});xn.TwitterApiPluginResponseOverride=void 0;var oi=class{constructor(e){this.value=e}};xn.TwitterApiPluginResponseOverride=oi});var Rl=g(vt=>{"use strict";var bf=vt&&vt.__createBinding||(Object.create?function(s,e,t,n){n===void 0&&(n=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,n,a)}:function(s,e,t,n){n===void 0&&(n=t),s[n]=e[t]}),wf=vt&&vt.__exportStar||function(s,e){for(var t in s)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&bf(e,s,t)};Object.defineProperty(vt,"__esModule",{value:!0});wf(Tl(),vt)});var Ie=g(ae=>{"use strict";var Sf=ae&&ae.__createBinding||(Object.create?function(s,e,t,n){n===void 0&&(n=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,n,a)}:function(s,e,t,n){n===void 0&&(n=t),s[n]=e[t]}),Tt=ae&&ae.__exportStar||function(s,e){for(var t in s)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Sf(e,s,t)};Object.defineProperty(ae,"__esModule",{value:!0});Tt(nl(),ae);Tt(_l(),ae);Tt(gl(),ae);Tt(bl(),ae);Tt(wl(),ae);Tt(vl(),ae);Tt(Rl(),ae)});var Wn=g(Un=>{"use strict";Object.defineProperty(Un,"__esModule",{value:!0});Un.TwitterApiV2Settings=void 0;Un.TwitterApiV2Settings={debug:!1,deprecationWarnings:!0,logger:{log:console.log.bind(console)}}});var ut=g(Z=>{"use strict";Object.defineProperty(Z,"__esModule",{value:!0});Z.safeDeprecationWarning=Z.hasMultipleItems=Z.isTweetStreamV2ErrorPayload=Z.trimUndefinedProperties=Z.arrayWrap=Z.sharedPromise=void 0;var vf=Wn();function Tf(s){let e={value:void 0,promise:s().then(t=>(e.value=t,t))};return e}Z.sharedPromise=Tf;function Rf(s){return Array.isArray(s)?s:[s]}Z.arrayWrap=Rf;function Pf(s){for(let e in s)s[e]===void 0&&delete s[e]}Z.trimUndefinedProperties=Pf;function qf(s){return typeof s=="object"&&"errors"in s&&!("data"in s)}Z.isTweetStreamV2ErrorPayload=qf;function Df(s){return Array.isArray(s)&&s.length>1?!0:s.toString().includes(",")}Z.hasMultipleItems=Df;var Pl=new Set;function Af(s){if(typeof console>"u"||!console.warn||!vf.TwitterApiV2Settings.deprecationWarnings)return;let e=`${s.instance}-${s.method}-${s.problem}`;if(Pl.has(e))return;let t=`[twitter-api-v2] Deprecation warning: In ${s.instance}.${s.method}() call, ${s.problem}.
${s.resolution}.`;console.warn(t),console.warn("To disable this message, import variable TwitterApiV2Settings from twitter-api-v2 and set TwitterApiV2Settings.deprecationWarnings to false."),Pl.add(e)}Z.safeDeprecationWarning=Af});var li=g(oe=>{"use strict";var Cf=oe&&oe.__createBinding||(Object.create?function(s,e,t,n){n===void 0&&(n=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,n,a)}:function(s,e,t,n){n===void 0&&(n=t),s[n]=e[t]}),Of=oe&&oe.__setModuleDefault||(Object.create?function(s,e){Object.defineProperty(s,"default",{enumerable:!0,value:e})}:function(s,e){s.default=e}),Lf=oe&&oe.__importStar||function(s){if(s&&s.__esModule)return s;var e={};if(s!=null)for(var t in s)t!=="default"&&Object.prototype.hasOwnProperty.call(s,t)&&Cf(e,s,t);return Of(e,s),e},Ef=oe&&oe.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(oe,"__esModule",{value:!0});oe.RequestHandlerHelper=void 0;var If=require("https"),ee=Wn(),Mf=Ef(Nn()),ui=Ie(),Ke=Lf(require("zlib")),kf=require("events"),zn=class{constructor(e){this.requestData=e,this.requestErrorHandled=!1,this.responseData=[]}get hrefPathname(){let e=this.requestData.url;return e.hostname+e.pathname}isCompressionDisabled(){return!this.requestData.compression||this.requestData.compression==="identity"}isFormEncodedEndpoint(){return this.requestData.url.href.startsWith("https://api.twitter.com/oauth/")}createRequestError(e){return ee.TwitterApiV2Settings.debug&&ee.TwitterApiV2Settings.logger.log("Request error:",e),new ui.ApiRequestError("Request failed.",{request:this.req,error:e})}createPartialResponseError(e,t){let a=`Request failed with partial response with HTTP code ${this.res.statusCode}`;return t?a+=" (connection abruptly closed)":a+=" (parse error)",new ui.ApiPartialResponseError(a,{request:this.req,response:this.res,responseError:e,rawContent:Buffer.concat(this.responseData).toString()})}formatV1Errors(e){return e.map(({code:t,message:n})=>`${n} (Twitter code ${t})`).join(", ")}formatV2Error(e){return`${e.title}: ${e.detail} (see ${e.type})`}createResponseError({res:e,data:t,rateLimit:n,code:a}){var u;ee.TwitterApiV2Settings.debug&&(ee.TwitterApiV2Settings.logger.log(`Request failed with code ${a}, data:`,t),ee.TwitterApiV2Settings.logger.log("Response headers:",e.headers));let c=`Request failed with code ${a}`;if(!((u=t?.errors)===null||u===void 0)&&u.length){let f=t.errors;"code"in f[0]?c+=" - "+this.formatV1Errors(f):c+=" - "+this.formatV2Error(t)}return new ui.ApiResponseError(c,{code:a,data:t,headers:e.headers,request:this.req,response:e,rateLimit:n})}getResponseDataStream(e){if(this.isCompressionDisabled())return e;let t=(e.headers["content-encoding"]||"identity").trim().toLowerCase();if(t==="br"){let n=Ke.createBrotliDecompress({flush:Ke.constants.BROTLI_OPERATION_FLUSH,finishFlush:Ke.constants.BROTLI_OPERATION_FLUSH});return e.pipe(n),n}if(t==="gzip"){let n=Ke.createGunzip({flush:Ke.constants.Z_SYNC_FLUSH,finishFlush:Ke.constants.Z_SYNC_FLUSH});return e.pipe(n),n}if(t==="deflate"){let n=Ke.createInflate({flush:Ke.constants.Z_SYNC_FLUSH,finishFlush:Ke.constants.Z_SYNC_FLUSH});return e.pipe(n),n}return e}detectResponseType(e){var t,n;return!((t=e.headers["content-type"])===null||t===void 0)&&t.includes("application/json")||!((n=e.headers["content-type"])===null||n===void 0)&&n.includes("application/problem+json")?"json":this.isFormEncodedEndpoint()?"url":"text"}getParsedResponse(e){let t=this.responseData,n=this.requestData.forceParseMode||this.detectResponseType(e);if(n==="buffer")return Buffer.concat(t);if(n==="text")return Buffer.concat(t).toString();if(n==="json"){let a=Buffer.concat(t).toString();return a.length?JSON.parse(a):void 0}else if(n==="url"){let a=Buffer.concat(t).toString(),u={};for(let[c,f]of new URLSearchParams(a))u[c]=f;return u}else return}getRateLimitFromResponse(e){let t;return e.headers["x-rate-limit-limit"]&&(t={limit:Number(e.headers["x-rate-limit-limit"]),remaining:Number(e.headers["x-rate-limit-remaining"]),reset:Number(e.headers["x-rate-limit-reset"])},e.headers["x-app-limit-24hour-limit"]&&(t.day={limit:Number(e.headers["x-app-limit-24hour-limit"]),remaining:Number(e.headers["x-app-limit-24hour-remaining"]),reset:Number(e.headers["x-app-limit-24hour-reset"])}),this.requestData.rateLimitSaver&&this.requestData.rateLimitSaver(t)),t}onSocketEventHandler(e,t,n){let a=this.onSocketCloseHandler.bind(this,e);n.on("close",a),t.on("complete",()=>n.off("close",a))}onSocketCloseHandler(e){if(this.req.removeAllListeners("timeout"),!this.res&&!this.requestErrorHandled)return e(this.createRequestError(new Error("Socket closed without any information.")))}requestErrorHandler(e,t){var n,a;(a=(n=this.requestData).requestEventDebugHandler)===null||a===void 0||a.call(n,"request-error",{requestError:t}),this.requestErrorHandled=!0,e(this.createRequestError(t))}timeoutErrorHandler(){this.requestErrorHandled=!0,this.req.destroy(new Error("Request timeout."))}classicResponseHandler(e,t,n){this.res=n;let a=this.getResponseDataStream(n);a.on("data",u=>this.responseData.push(u)),a.on("end",this.onResponseEndHandler.bind(this,e,t)),a.on("close",this.onResponseCloseHandler.bind(this,e,t)),this.requestData.requestEventDebugHandler&&(this.requestData.requestEventDebugHandler("response",{res:n}),n.on("aborted",u=>this.requestData.requestEventDebugHandler("response-aborted",{error:u})),n.on("error",u=>this.requestData.requestEventDebugHandler("response-error",{error:u})),n.on("close",()=>this.requestData.requestEventDebugHandler("response-close",{data:this.responseData})),n.on("end",()=>this.requestData.requestEventDebugHandler("response-end")))}onResponseEndHandler(e,t){let n=this.getRateLimitFromResponse(this.res),a;try{a=this.getParsedResponse(this.res)}catch(c){t(this.createPartialResponseError(c,!1));return}let u=this.res.statusCode;if(u>=400){t(this.createResponseError({data:a,res:this.res,rateLimit:n,code:u}));return}ee.TwitterApiV2Settings.debug&&(ee.TwitterApiV2Settings.logger.log(`[${this.requestData.options.method} ${this.hrefPathname}]: Request succeeds with code ${this.res.statusCode}`),ee.TwitterApiV2Settings.logger.log("Response body:",a)),e({data:a,headers:this.res.headers,rateLimit:n})}onResponseCloseHandler(e,t){let n=this.res;if(n.aborted)try{return this.getParsedResponse(this.res),this.onResponseEndHandler(e,t)}catch(a){return t(this.createPartialResponseError(a,!0))}if(!n.complete)return t(this.createPartialResponseError(new Error("Response has been interrupted before response could be parsed."),!0))}streamResponseHandler(e,t,n){if(n.statusCode<400){ee.TwitterApiV2Settings.debug&&ee.TwitterApiV2Settings.logger.log(`[${this.requestData.options.method} ${this.hrefPathname}]: Request succeeds with code ${n.statusCode} (starting stream)`);let u=this.getResponseDataStream(n);e({req:this.req,res:u,originalResponse:n,requestData:this.requestData})}else this.classicResponseHandler(()=>{},t,n)}debugRequest(){let e=this.requestData.url;ee.TwitterApiV2Settings.logger.log(`[${this.requestData.options.method} ${this.hrefPathname}]`,this.requestData.options),e.search&&ee.TwitterApiV2Settings.logger.log("Request parameters:",[...e.searchParams.entries()].map(([t,n])=>`${t}: ${n}`)),this.requestData.body&&ee.TwitterApiV2Settings.logger.log("Request body:",this.requestData.body)}buildRequest(){var e;let t=this.requestData.url,n=t.username?`${t.username}:${t.password}`:void 0,a=(e=this.requestData.options.headers)!==null&&e!==void 0?e:{};this.requestData.compression===!0||this.requestData.compression==="brotli"?a["accept-encoding"]="br;q=1.0, gzip;q=0.8, deflate;q=0.5, *;q=0.1":this.requestData.compression==="gzip"?a["accept-encoding"]="gzip;q=1, deflate;q=0.5, *;q=0.1":this.requestData.compression==="deflate"&&(a["accept-encoding"]="deflate;q=1, *;q=0.1"),ee.TwitterApiV2Settings.debug&&this.debugRequest(),this.req=(0,If.request)({...this.requestData.options,host:t.hostname,port:t.port||void 0,path:t.pathname+t.search,protocol:t.protocol,auth:n,headers:a})}registerRequestEventDebugHandlers(e){e.on("close",()=>this.requestData.requestEventDebugHandler("close")),e.on("abort",()=>this.requestData.requestEventDebugHandler("abort")),e.on("socket",t=>{this.requestData.requestEventDebugHandler("socket",{socket:t}),t.on("error",n=>this.requestData.requestEventDebugHandler("socket-error",{socket:t,error:n})),t.on("connect",()=>this.requestData.requestEventDebugHandler("socket-connect",{socket:t})),t.on("close",n=>this.requestData.requestEventDebugHandler("socket-close",{socket:t,withError:n})),t.on("end",()=>this.requestData.requestEventDebugHandler("socket-end",{socket:t})),t.on("lookup",(...n)=>this.requestData.requestEventDebugHandler("socket-lookup",{socket:t,data:n})),t.on("timeout",()=>this.requestData.requestEventDebugHandler("socket-timeout",{socket:t}))})}makeRequest(){return this.buildRequest(),new Promise((e,t)=>{let n=f=>{u.emit("complete"),e(f)},a=f=>{u.emit("complete"),t(f)},u=new kf.EventEmitter,c=this.req;c.on("error",this.requestErrorHandler.bind(this,a)),c.on("socket",this.onSocketEventHandler.bind(this,a,u)),c.on("response",this.classicResponseHandler.bind(this,n,a)),this.requestData.options.timeout&&c.on("timeout",this.timeoutErrorHandler.bind(this)),this.requestData.requestEventDebugHandler&&this.registerRequestEventDebugHandlers(c),this.requestData.body&&c.write(this.requestData.body),c.end()})}async makeRequestAsStream(){let{req:e,res:t,requestData:n,originalResponse:a}=await this.makeRequestAndResolveWhenReady();return new Mf.default(n,{req:e,res:t,originalResponse:a})}makeRequestAndResolveWhenReady(){return this.buildRequest(),new Promise((e,t)=>{let n=this.req;n.on("error",this.requestErrorHandler.bind(this,t)),n.on("response",this.streamResponseHandler.bind(this,e,t)),this.requestData.body&&n.write(this.requestData.body),n.end()})}};oe.RequestHandlerHelper=zn;oe.default=zn});var ql=g(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0});Lr.TweetStreamEventCombiner=void 0;var jf=require("events"),lt=Ie(),$n=class extends jf.EventEmitter{constructor(e){super(),this.stream=e,this.stack=[],this.onStreamData=this.onStreamData.bind(this),this.onStreamError=this.onStreamError.bind(this),this.onceNewEvent=this.once.bind(this,"event"),e.on(lt.ETwitterStreamEvent.Data,this.onStreamData),e.on(lt.ETwitterStreamEvent.ConnectionError,this.onStreamError),e.on(lt.ETwitterStreamEvent.TweetParseError,this.onStreamError),e.on(lt.ETwitterStreamEvent.ConnectionClosed,this.onStreamError)}nextEvent(){return new Promise(this.onceNewEvent)}hasStack(){return this.stack.length>0}popStack(){let e=this.stack;return this.stack=[],e}destroy(){this.removeAllListeners(),this.stream.off(lt.ETwitterStreamEvent.Data,this.onStreamData),this.stream.off(lt.ETwitterStreamEvent.ConnectionError,this.onStreamError),this.stream.off(lt.ETwitterStreamEvent.TweetParseError,this.onStreamError),this.stream.off(lt.ETwitterStreamEvent.ConnectionClosed,this.onStreamError)}emitEvent(e,t){this.emit("event",{type:e,payload:t})}onStreamError(e){this.emitEvent("error",e)}onStreamData(e){this.stack.push(e),this.emitEvent("data",e)}};Lr.TweetStreamEventCombiner=$n;Lr.default=$n});var Dl=g(Kt=>{"use strict";Object.defineProperty(Kt,"__esModule",{value:!0});Kt.EStreamParserEvent=void 0;var Ff=require("events"),ci=class extends Ff.EventEmitter{constructor(){super(...arguments),this.currentMessage=""}push(e){this.currentMessage+=e,e=this.currentMessage;let t=e.length,n=0,a=0;for(;a<t;){if(e.slice(a,a+2)===`\r
`){let u=e.slice(n,a);if(n=a+=2,!u.length)continue;try{let c=JSON.parse(u);if(c){this.emit(di.ParsedData,c);continue}}catch(c){this.emit(di.ParseError,c)}}a++}this.currentMessage=e.slice(n,t)}reset(){this.currentMessage=""}};Kt.default=ci;var di;(function(s){s.ParsedData="parsed data",s.ParseError="parse error"})(di=Kt.EStreamParserEvent||(Kt.EStreamParserEvent={}))});var Nn=g(ue=>{"use strict";var Bf=ue&&ue.__createBinding||(Object.create?function(s,e,t,n){n===void 0&&(n=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,n,a)}:function(s,e,t,n){n===void 0&&(n=t),s[n]=e[t]}),xf=ue&&ue.__setModuleDefault||(Object.create?function(s,e){Object.defineProperty(s,"default",{enumerable:!0,value:e})}:function(s,e){s.default=e}),Uf=ue&&ue.__importStar||function(s){if(s&&s.__esModule)return s;var e={};if(s!=null)for(var t in s)t!=="default"&&Object.prototype.hasOwnProperty.call(s,t)&&Bf(e,s,t);return xf(e,s),e},Ol=ue&&ue.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ue,"__esModule",{value:!0});ue.TweetStream=void 0;var Wf=require("events"),Al=Ol(li()),L=Ie(),zf=Ol(ql()),fi=Uf(Dl()),Cl=[5,15,30,60,90,120,180,300,600,900],Nf=s=>s>Cl.length?901e3:Cl[s-1]*1e3,Vn=class extends Wf.EventEmitter{constructor(e,t){super(),this.requestData=e,this.autoReconnect=!1,this.autoReconnectRetries=5,this.keepAliveTimeoutMs=1e3*120,this.nextRetryTimeout=Nf,this.parser=new fi.default,this.connectionProcessRunning=!1,this.onKeepAliveTimeout=this.onKeepAliveTimeout.bind(this),this.initEventsFromParser(),t&&(this.req=t.req,this.res=t.res,this.originalResponse=t.originalResponse,this.initEventsFromRequest())}on(e,t){return super.on(e,t)}initEventsFromRequest(){if(!this.req||!this.res)throw new Error("TweetStream error: You cannot init TweetStream without a request and response object.");let e=t=>{this.emit(L.ETwitterStreamEvent.ConnectionError,t),this.emit(L.ETwitterStreamEvent.Error,{type:L.ETwitterStreamEvent.ConnectionError,error:t,message:"Connection lost or closed by Twitter."}),this.onConnectionError()};this.req.on("error",e),this.res.on("error",e),this.res.on("close",()=>e(new Error("Connection closed by Twitter."))),this.res.on("data",t=>{if(this.resetKeepAliveTimeout(),t.toString()===`\r
`)return this.emit(L.ETwitterStreamEvent.DataKeepAlive);this.parser.push(t.toString())}),this.resetKeepAliveTimeout()}initEventsFromParser(){let e=this.requestData.payloadIsError;this.parser.on(fi.EStreamParserEvent.ParsedData,t=>{e&&e(t)?(this.emit(L.ETwitterStreamEvent.DataError,t),this.emit(L.ETwitterStreamEvent.Error,{type:L.ETwitterStreamEvent.DataError,error:t,message:"Twitter sent a payload that is detected as an error payload."})):this.emit(L.ETwitterStreamEvent.Data,t)}),this.parser.on(fi.EStreamParserEvent.ParseError,t=>{this.emit(L.ETwitterStreamEvent.TweetParseError,t),this.emit(L.ETwitterStreamEvent.Error,{type:L.ETwitterStreamEvent.TweetParseError,error:t,message:"Failed to parse stream data."})})}resetKeepAliveTimeout(){this.unbindKeepAliveTimeout(),this.keepAliveTimeoutMs!==1/0&&(this.keepAliveTimeout=setTimeout(this.onKeepAliveTimeout,this.keepAliveTimeoutMs))}onKeepAliveTimeout(){this.emit(L.ETwitterStreamEvent.ConnectionLost),this.onConnectionError()}unbindTimeouts(){this.unbindRetryTimeout(),this.unbindKeepAliveTimeout()}unbindKeepAliveTimeout(){this.keepAliveTimeout&&(clearTimeout(this.keepAliveTimeout),this.keepAliveTimeout=void 0)}unbindRetryTimeout(){this.retryTimeout&&(clearTimeout(this.retryTimeout),this.retryTimeout=void 0)}closeWithoutEmit(){this.unbindTimeouts(),this.res&&(this.res.removeAllListeners(),this.res.destroy()),this.req&&(this.req.removeAllListeners(),this.req.destroy())}close(){this.emit(L.ETwitterStreamEvent.ConnectionClosed),this.closeWithoutEmit()}destroy(){this.removeAllListeners(),this.close()}async clone(){let t=await new Al.default(this.requestData).makeRequestAsStream(),n=this.eventNames();for(let a of n){let u=this.listeners(a);for(let c of u)t.on(a,c)}return t}async connect(e={}){typeof e.autoReconnect<"u"&&(this.autoReconnect=e.autoReconnect),typeof e.autoReconnectRetries<"u"&&(this.autoReconnectRetries=e.autoReconnectRetries==="unlimited"?1/0:e.autoReconnectRetries),typeof e.keepAliveTimeout<"u"&&(this.keepAliveTimeoutMs=e.keepAliveTimeout==="disable"?1/0:e.keepAliveTimeout),typeof e.nextRetryTimeout<"u"&&(this.nextRetryTimeout=e.nextRetryTimeout),this.unbindTimeouts();try{await this.reconnect()}catch(t){if(this.emit(L.ETwitterStreamEvent.ConnectError,0),this.emit(L.ETwitterStreamEvent.Error,{type:L.ETwitterStreamEvent.ConnectError,error:t,message:"Connect error - Initial connection just failed."}),this.autoReconnect)this.makeAutoReconnectRetry(0,t);else throw t}return this}async reconnect(){if(this.connectionProcessRunning)throw new Error("Connection process is already running.");this.connectionProcessRunning=!0;try{let e=!0;this.req&&(e=!1,this.closeWithoutEmit());let{req:t,res:n,originalResponse:a}=await new Al.default(this.requestData).makeRequestAndResolveWhenReady();this.req=t,this.res=n,this.originalResponse=a,this.emit(e?L.ETwitterStreamEvent.Connected:L.ETwitterStreamEvent.Reconnected),this.parser.reset(),this.initEventsFromRequest()}finally{this.connectionProcessRunning=!1}}async onConnectionError(e=0){if(this.unbindTimeouts(),this.closeWithoutEmit(),!this.autoReconnect){this.emit(L.ETwitterStreamEvent.ConnectionClosed);return}if(e>=this.autoReconnectRetries){this.emit(L.ETwitterStreamEvent.ReconnectLimitExceeded),this.emit(L.ETwitterStreamEvent.ConnectionClosed);return}try{this.emit(L.ETwitterStreamEvent.ReconnectAttempt,e),await this.reconnect()}catch(t){this.emit(L.ETwitterStreamEvent.ReconnectError,e),this.emit(L.ETwitterStreamEvent.Error,{type:L.ETwitterStreamEvent.ReconnectError,error:t,message:`Reconnect error - ${e+1} attempts made yet.`}),this.makeAutoReconnectRetry(e,t)}}makeAutoReconnectRetry(e,t){let n=this.nextRetryTimeout(e+1,t);this.retryTimeout=setTimeout(()=>{this.onConnectionError(e+1)},n)}async*[Symbol.asyncIterator](){let e=new zf.default(this);try{for(;;){if(!this.req||this.req.aborted)throw new Error("Connection closed");e.hasStack()&&(yield*e.popStack());let{type:t,payload:n}=await e.nextEvent();if(t==="error")throw n}}finally{e.destroy()}}};ue.TweetStream=Vn;ue.default=Vn});var Ll=g(Xt=>{"use strict";Object.defineProperty(Xt,"__esModule",{value:!0});Xt.applyResponseHooks=Xt.hasRequestErrorPlugins=void 0;var Hn=Ie();function $f(s){var e;if(!(!((e=s.clientSettings.plugins)===null||e===void 0)&&e.length))return!1;for(let t of s.clientSettings.plugins)if(t.onRequestError||t.onResponseError)return!0;return!1}Xt.hasRequestErrorPlugins=$f;async function Vf(s,e,t,n){let a;return n instanceof Hn.ApiRequestError||n instanceof Hn.ApiPartialResponseError?a=await this.applyPluginMethod("onRequestError",{client:this,url:this.getUrlObjectFromUrlString(s.url),params:s,computedParams:e,requestOptions:t,error:n}):n instanceof Hn.ApiResponseError&&(a=await this.applyPluginMethod("onResponseError",{client:this,url:this.getUrlObjectFromUrlString(s.url),params:s,computedParams:e,requestOptions:t,error:n})),a&&a instanceof Hn.TwitterApiPluginResponseOverride?a.value:Promise.reject(n)}Xt.applyResponseHooks=Vf});var hi=g(Re=>{"use strict";var Hf=Re&&Re.__createBinding||(Object.create?function(s,e,t,n){n===void 0&&(n=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,n,a)}:function(s,e,t,n){n===void 0&&(n=t),s[n]=e[t]}),Qf=Re&&Re.__setModuleDefault||(Object.create?function(s,e){Object.defineProperty(s,"default",{enumerable:!0,value:e})}:function(s,e){s.default=e}),Yf=Re&&Re.__importStar||function(s){if(s&&s.__esModule)return s;var e={};if(s!=null)for(var t in s)t!=="default"&&Object.prototype.hasOwnProperty.call(s,t)&&Hf(e,s,t);return Qf(e,s),e};Object.defineProperty(Re,"__esModule",{value:!0});Re.OAuth1Helper=void 0;var Kf=Yf(require("crypto")),te=class{constructor(e){this.nonceLength=32,this.consumerKeys=e.consumerKeys}static percentEncode(e){return encodeURIComponent(e).replace(/!/g,"%21").replace(/\*/g,"%2A").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29")}hash(e,t){return Kf.createHmac("sha1",t).update(e).digest("base64")}authorize(e,t={}){let n={oauth_consumer_key:this.consumerKeys.key,oauth_nonce:this.getNonce(),oauth_signature_method:"HMAC-SHA1",oauth_timestamp:this.getTimestamp(),oauth_version:"1.0"};return t.key!==void 0&&(n.oauth_token=t.key),e.data||(e.data={}),n.oauth_signature=this.getSignature(e,t.secret,n),n}toHeader(e){let t=Il(e),n="OAuth ";for(let a of t)a.key.indexOf("oauth_")===0&&(n+=te.percentEncode(a.key)+'="'+te.percentEncode(a.value)+'",');return{Authorization:n.slice(0,n.length-1)}}getNonce(){let e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",t="";for(let n=0;n<this.nonceLength;n++)t+=e[Math.trunc(Math.random()*e.length)];return t}getTimestamp(){return Math.trunc(new Date().getTime()/1e3)}getSignature(e,t,n){return this.hash(this.getBaseString(e,n),this.getSigningKey(t))}getSigningKey(e){return te.percentEncode(this.consumerKeys.secret)+"&"+te.percentEncode(e||"")}getBaseString(e,t){return e.method.toUpperCase()+"&"+te.percentEncode(this.getBaseUrl(e.url))+"&"+te.percentEncode(this.getParameterString(e,t))}getParameterString(e,t){let n=Il(Jf(El(t,El(e.data,Gf(e.url))))),a="";for(let{key:u,value:c}of n)if(c&&Array.isArray(c)){c.sort();let f="";c.forEach((m,b)=>{f+=u+"="+m,b<c.length&&(f+="&")}),a+=f}else a+=u+"="+c+"&";return a.slice(0,a.length-1)}getBaseUrl(e){return e.split("?")[0]}};Re.OAuth1Helper=te;Re.default=te;function El(s,e){return{...s||{},...e||{}}}function Il(s){return Object.keys(s).sort().map(e=>({key:e,value:s[e]}))}function Xf(s){let e=s.split("&"),t={};for(let n of e){let[a,u=""]=n.split("=");t[a]?(Array.isArray(t[a])||(t[a]=[t[a]]),t[a].push(decodeURIComponent(u))):t[a]=decodeURIComponent(u)}return t}function Gf(s){let e=s.split("?");return e.length===1?{}:Xf(e[1])}function Jf(s){let e={};for(let t in s){let n=s[t];n&&Array.isArray(n)?n=n.map(a=>te.percentEncode(a)):n=te.percentEncode(n),e[te.percentEncode(t)]=n}return e}});var Ml=g(Qn=>{"use strict";Object.defineProperty(Qn,"__esModule",{value:!0});Qn.FormDataHelper=void 0;var Zf=ut(),he=class{constructor(){this._boundary="",this._chunks=[]}bodyAppend(...e){let t=e.map(n=>n instanceof Buffer?n:Buffer.from(n));this._chunks.push(...t)}append(e,t,n){let a=t instanceof Buffer?t:t.toString(),u=this.getMultipartHeader(e,a,n);this.bodyAppend(u,a,he.LINE_BREAK)}getHeaders(){return{"content-type":"multipart/form-data; boundary="+this.getBoundary()}}getLength(){return this._chunks.reduce((e,t)=>e+t.length,this.getMultipartFooter().length)}getBuffer(){let e=[...this._chunks,this.getMultipartFooter()],t=Buffer.alloc(this.getLength()),n=0;for(let a of e)for(let u=0;u<a.length;n++,u++)t[n]=a[u];return t}getBoundary(){return this._boundary||this.generateBoundary(),this._boundary}generateBoundary(){let e="--------------------------";for(let t=0;t<24;t++)e+=Math.floor(Math.random()*10).toString(16);this._boundary=e}getMultipartHeader(e,t,n){n||(n=t instanceof Buffer?he.DEFAULT_CONTENT_TYPE:"");let a={"Content-Disposition":["form-data",`name="${e}"`],"Content-Type":n},u="";for(let[c,f]of Object.entries(a))f.length&&(u+=c+": "+(0,Zf.arrayWrap)(f).join("; ")+he.LINE_BREAK);return"--"+this.getBoundary()+he.LINE_BREAK+u+he.LINE_BREAK}getMultipartFooter(){return this._footerChunk?this._footerChunk:this._footerChunk=Buffer.from("--"+this.getBoundary()+"--"+he.LINE_BREAK)}};Qn.FormDataHelper=he;he.LINE_BREAK=`\r
`;he.DEFAULT_CONTENT_TYPE="application/octet-stream"});var mi=g(Rt=>{"use strict";var eh=Rt&&Rt.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Rt,"__esModule",{value:!0});Rt.RequestParamHelpers=void 0;var th=Ml(),kl=eh(hi()),Er=class{static formatQueryToString(e){let t={};for(let n in e)typeof e[n]=="string"?t[n]=e[n]:typeof e[n]<"u"&&(t[n]=String(e[n]));return t}static autoDetectBodyType(e){if(e.pathname.startsWith("/2/")||e.pathname.startsWith("/labs/2/"))return e.password.startsWith("/2/oauth2")?"url":"json";if(e.hostname==="upload.twitter.com")return e.pathname==="/1.1/media/upload.json"?"form-data":"json";let t=e.pathname.split("/1.1/",2)[1];return this.JSON_1_1_ENDPOINTS.has(t)?"json":"url"}static addQueryParamsToUrl(e,t){let n=Object.entries(t);if(n.length){let a="";for(let[u,c]of n)a+=(a.length?"&":"?")+`${kl.default.percentEncode(u)}=${kl.default.percentEncode(c)}`;e.search=a}}static constructBodyParams(e,t,n){if(e instanceof Buffer)return e;if(n==="json")return t["content-type"]||(t["content-type"]="application/json;charset=UTF-8"),JSON.stringify(e);if(n==="url")return t["content-type"]||(t["content-type"]="application/x-www-form-urlencoded;charset=UTF-8"),Object.keys(e).length?new URLSearchParams(e).toString().replace(/\*/g,"%2A"):"";if(n==="raw")throw new Error("You can only use raw body mode with Buffers. To give a string, use Buffer.from(str).");{let a=new th.FormDataHelper;for(let u in e)a.append(u,e[u]);if(!t["content-type"]){let u=a.getHeaders();t["content-type"]=u["content-type"]}return a.getBuffer()}}static setBodyLengthHeader(e,t){var n;e.headers=(n=e.headers)!==null&&n!==void 0?n:{},typeof t=="string"?e.headers["content-length"]=Buffer.byteLength(t):e.headers["content-length"]=t.length}static isOAuthSerializable(e){return!(e instanceof Buffer)}static mergeQueryAndBodyForOAuth(e,t){let n={};for(let a in e)n[a]=e[a];if(this.isOAuthSerializable(t))for(let a in t){let u=t[a];this.isOAuthSerializable(u)&&(n[a]=typeof u=="object"&&u!==null&&"toString"in u?u.toString():u)}return n}static moveUrlQueryParamsIntoObject(e,t){for(let[n,a]of e.searchParams)t[n]=a;return e.search="",e}static applyRequestParametersToUrl(e,t){return e.pathname=e.pathname.replace(/:([A-Z_-]+)/ig,(n,a)=>t[a]!==void 0?String(t[a]):n),e}};Rt.RequestParamHelpers=Er;Er.JSON_1_1_ENDPOINTS=new Set(["direct_messages/events/new.json","direct_messages/welcome_messages/new.json","direct_messages/welcome_messages/rules/new.json","media/metadata/create.json","collections/entries/curate.json"]);Rt.default=Er});var _i=g(Me=>{"use strict";var rh=Me&&Me.__createBinding||(Object.create?function(s,e,t,n){n===void 0&&(n=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,n,a)}:function(s,e,t,n){n===void 0&&(n=t),s[n]=e[t]}),nh=Me&&Me.__setModuleDefault||(Object.create?function(s,e){Object.defineProperty(s,"default",{enumerable:!0,value:e})}:function(s,e){s.default=e}),sh=Me&&Me.__importStar||function(s){if(s&&s.__esModule)return s;var e={};if(s!=null)for(var t in s)t!=="default"&&Object.prototype.hasOwnProperty.call(s,t)&&rh(e,s,t);return nh(e,s),e};Object.defineProperty(Me,"__esModule",{value:!0});Me.OAuth2Helper=void 0;var ih=sh(require("crypto")),pi=class{static getCodeVerifier(){return this.generateRandomString(128)}static getCodeChallengeFromVerifier(e){return this.escapeBase64Url(ih.createHash("sha256").update(e).digest("base64"))}static getAuthHeader(e,t){let n=encodeURIComponent(e)+":"+encodeURIComponent(t);return Buffer.from(n).toString("base64")}static generateRandomString(e){let t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~";for(let a=0;a<e;a++)t+=n[Math.floor(Math.random()*n.length)];return t}static escapeBase64Url(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}};Me.OAuth2Helper=pi});var Fl=g(Gt=>{"use strict";var Yn=Gt&&Gt.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Gt,"__esModule",{value:!0});Gt.ClientRequestMaker=void 0;var ah=Ie(),oh=Yn(Nn()),jl=Ll(),uh=ut(),lh=Yn(hi()),ch=Yn(li()),Xe=Yn(mi()),dh=_i(),Pt=class{constructor(e){this.rateLimits={},this.clientSettings={},e&&(this.clientSettings=e)}getRateLimits(){return this.rateLimits}saveRateLimit(e,t){this.rateLimits[e]=t}async send(e){var t,n,a,u,c;if(!((t=this.clientSettings.plugins)===null||t===void 0)&&t.length){let w=await this.applyPreRequestConfigHooks(e);if(w)return w}let f=this.getHttpRequestArgs(e),m={method:f.method,headers:f.headers,timeout:e.timeout,agent:this.clientSettings.httpAgent},b=e.enableRateLimitSave!==!1;f.body&&Xe.default.setBodyLengthHeader(m,f.body),!((n=this.clientSettings.plugins)===null||n===void 0)&&n.length&&await this.applyPreRequestHooks(e,f,m);let S=new ch.default({url:f.url,options:m,body:f.body,rateLimitSaver:b?this.saveRateLimit.bind(this,f.rawUrl):void 0,requestEventDebugHandler:e.requestEventDebugHandler,compression:(u=(a=e.compression)!==null&&a!==void 0?a:this.clientSettings.compression)!==null&&u!==void 0?u:!0,forceParseMode:e.forceParseMode}).makeRequest();(0,jl.hasRequestErrorPlugins)(this)&&(S=this.applyResponseErrorHooks(e,f,m,S));let R=await S;if(!((c=this.clientSettings.plugins)===null||c===void 0)&&c.length){let w=await this.applyPostRequestHooks(e,f,m,R);if(w)return w.value}return R}sendStream(e){var t,n;this.clientSettings.plugins&&this.applyPreStreamRequestConfigHooks(e);let a=this.getHttpRequestArgs(e),u={method:a.method,headers:a.headers,agent:this.clientSettings.httpAgent},c=e.enableRateLimitSave!==!1,f=e.autoConnect!==!1;a.body&&Xe.default.setBodyLengthHeader(u,a.body);let m={url:a.url,options:u,body:a.body,rateLimitSaver:c?this.saveRateLimit.bind(this,a.rawUrl):void 0,payloadIsError:e.payloadIsError,compression:(n=(t=e.compression)!==null&&t!==void 0?t:this.clientSettings.compression)!==null&&n!==void 0?n:!0},b=new oh.default(m);return f?b.connect():b}initializeToken(e){if(typeof e=="string")this.bearerToken=e;else if(typeof e=="object"&&"appKey"in e)this.consumerToken=e.appKey,this.consumerSecret=e.appSecret,e.accessToken&&e.accessSecret&&(this.accessToken=e.accessToken,this.accessSecret=e.accessSecret),this._oauth=this.buildOAuth();else if(typeof e=="object"&&"username"in e){let t=encodeURIComponent(e.username)+":"+encodeURIComponent(e.password);this.basicToken=Buffer.from(t).toString("base64")}else typeof e=="object"&&"clientId"in e&&(this.clientId=e.clientId,this.clientSecret=e.clientSecret)}getActiveTokens(){return this.bearerToken?{type:"oauth2",bearerToken:this.bearerToken}:this.basicToken?{type:"basic",token:this.basicToken}:this.consumerSecret&&this._oauth?{type:"oauth-1.0a",appKey:this.consumerToken,appSecret:this.consumerSecret,accessToken:this.accessToken,accessSecret:this.accessSecret}:this.clientId?{type:"oauth2-user",clientId:this.clientId}:{type:"none"}}buildOAuth(){if(!this.consumerSecret||!this.consumerToken)throw new Error("Invalid consumer tokens");return new lh.default({consumerKeys:{key:this.consumerToken,secret:this.consumerSecret}})}getOAuthAccessTokens(){if(!(!this.accessSecret||!this.accessToken))return{key:this.accessToken,secret:this.accessSecret}}getPlugins(){var e;return(e=this.clientSettings.plugins)!==null&&e!==void 0?e:[]}hasPlugins(){var e;return!!(!((e=this.clientSettings.plugins)===null||e===void 0)&&e.length)}async applyPluginMethod(e,t){var n;let a;for(let u of this.getPlugins()){let c=await((n=u[e])===null||n===void 0?void 0:n.call(u,t));c&&c instanceof ah.TwitterApiPluginResponseOverride&&(a=c)}return a}writeAuthHeaders({headers:e,bodyInSignature:t,url:n,method:a,query:u,body:c}){if(e={...e},this.bearerToken)e.Authorization="Bearer "+this.bearerToken;else if(this.basicToken)e.Authorization="Basic "+this.basicToken;else if(this.clientId&&this.clientSecret)e.Authorization="Basic "+dh.OAuth2Helper.getAuthHeader(this.clientId,this.clientSecret);else if(this.consumerSecret&&this._oauth){let f=t?Xe.default.mergeQueryAndBodyForOAuth(u,c):u,m=this._oauth.authorize({url:n.toString(),method:a,data:f},this.getOAuthAccessTokens());e={...e,...this._oauth.toHeader(m)}}return e}getUrlObjectFromUrlString(e){return e.startsWith("http")||(e="https://"+e),new URL(e)}getHttpRequestArgs({url:e,method:t,query:n={},body:a={},headers:u,forceBodyMode:c,enableAuth:f,params:m}){let b;t=t.toUpperCase(),u=u??{},u["x-user-agent"]||(u["x-user-agent"]="Node.twitter-api-v2");let S=this.getUrlObjectFromUrlString(e),R=S.origin+S.pathname;m&&Xe.default.applyRequestParametersToUrl(S,m);let w=Xe.default.formatQueryToString(n);Xe.default.moveUrlQueryParamsIntoObject(S,w),a instanceof Buffer||(0,uh.trimUndefinedProperties)(a);let _=c??Xe.default.autoDetectBodyType(S);if(f!==!1){let A=Pt.BODY_METHODS.has(t)&&_==="url";u=this.writeAuthHeaders({headers:u,bodyInSignature:A,method:t,query:w,url:S,body:a})}return Pt.BODY_METHODS.has(t)&&(b=Xe.default.constructBodyParams(a,u,_)||void 0),Xe.default.addQueryParamsToUrl(S,w),{rawUrl:R,url:S,method:t,headers:u,body:b}}async applyPreRequestConfigHooks(e){var t;let n=this.getUrlObjectFromUrlString(e.url);for(let a of this.getPlugins()){let u=await((t=a.onBeforeRequestConfig)===null||t===void 0?void 0:t.call(a,{client:this,url:n,params:e}));if(u)return u}}applyPreStreamRequestConfigHooks(e){var t;let n=this.getUrlObjectFromUrlString(e.url);for(let a of this.getPlugins())(t=a.onBeforeStreamRequestConfig)===null||t===void 0||t.call(a,{client:this,url:n,params:e})}async applyPreRequestHooks(e,t,n){await this.applyPluginMethod("onBeforeRequest",{client:this,url:this.getUrlObjectFromUrlString(e.url),params:e,computedParams:t,requestOptions:n})}async applyPostRequestHooks(e,t,n,a){return await this.applyPluginMethod("onAfterRequest",{client:this,url:this.getUrlObjectFromUrlString(e.url),params:e,computedParams:t,requestOptions:n,response:a})}applyResponseErrorHooks(e,t,n,a){return a.catch(jl.applyResponseHooks.bind(this,e,t,n))}};Gt.ClientRequestMaker=Pt;Pt.BODY_METHODS=new Set(["POST","PUT","PATCH"])});var yi=g(gi=>{"use strict";Object.defineProperty(gi,"__esModule",{value:!0});var fh=Fl(),Bl=ut(),xl=Te(),Ir=class{constructor(e,t={}){this._currentUser=null,this._currentUserV2=null,e instanceof Ir?this._requestMaker=e._requestMaker:(this._requestMaker=new fh.ClientRequestMaker(t),this._requestMaker.initializeToken(e))}setPrefix(e){this._prefix=e}cloneWithPrefix(e){let t=this.constructor(this);return t.setPrefix(e),t}getActiveTokens(){return this._requestMaker.getActiveTokens()}getPlugins(){return this._requestMaker.getPlugins()}getPluginOfType(e){return this.getPlugins().find(t=>t instanceof e)}hasHitRateLimit(e){var t;return this.isRateLimitStatusObsolete(e)?!1:((t=this.getLastRateLimitStatus(e))===null||t===void 0?void 0:t.remaining)===0}isRateLimitStatusObsolete(e){let t=this.getLastRateLimitStatus(e);return t===void 0?!0:t.reset*1e3<Date.now()}getLastRateLimitStatus(e){let t=e.match(/^https?:\/\//)?e:this._prefix+e;return this._requestMaker.getRateLimits()[t]}getCurrentUserObject(e=!1){return!e&&this._currentUser?this._currentUser.value?Promise.resolve(this._currentUser.value):this._currentUser.promise:(this._currentUser=(0,Bl.sharedPromise)(()=>this.get("account/verify_credentials.json",{tweet_mode:"extended"},{prefix:xl.API_V1_1_PREFIX})),this._currentUser.promise)}getCurrentUserV2Object(e=!1){return!e&&this._currentUserV2?this._currentUserV2.value?Promise.resolve(this._currentUserV2.value):this._currentUserV2.promise:(this._currentUserV2=(0,Bl.sharedPromise)(()=>this.get("users/me",void 0,{prefix:xl.API_V2_PREFIX})),this._currentUserV2.promise)}async get(e,t={},{fullResponse:n,prefix:a=this._prefix,...u}={}){a&&(e=a+e);let c=await this._requestMaker.send({url:e,method:"GET",query:t,...u});return n?c:c.data}async delete(e,t={},{fullResponse:n,prefix:a=this._prefix,...u}={}){a&&(e=a+e);let c=await this._requestMaker.send({url:e,method:"DELETE",query:t,...u});return n?c:c.data}async post(e,t,{fullResponse:n,prefix:a=this._prefix,...u}={}){a&&(e=a+e);let c=await this._requestMaker.send({url:e,method:"POST",body:t,...u});return n?c:c.data}async put(e,t,{fullResponse:n,prefix:a=this._prefix,...u}={}){a&&(e=a+e);let c=await this._requestMaker.send({url:e,method:"PUT",body:t,...u});return n?c:c.data}async patch(e,t,{fullResponse:n,prefix:a=this._prefix,...u}={}){a&&(e=a+e);let c=await this._requestMaker.send({url:e,method:"PATCH",body:t,...u});return n?c:c.data}getStream(e,t,{prefix:n=this._prefix,...a}={}){return this._requestMaker.sendStream({url:n?n+e:e,method:"GET",query:t,...a})}postStream(e,t,{prefix:n=this._prefix,...a}={}){return this._requestMaker.sendStream({url:n?n+e:e,method:"POST",body:t,...a})}};gi.default=Ir});var Kn=g(Mr=>{"use strict";var hh=Mr&&Mr.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Mr,"__esModule",{value:!0});var Ul=hh(yi()),bi=class extends Ul.default{constructor(e){if(!(e instanceof Ul.default))throw new Error("You must instance SubTwitterApi instance from existing TwitterApi instance.");super(e)}};Mr.default=bi});var Pi=g(re=>{"use strict";var mh=re&&re.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(re,"__esModule",{value:!0});re.UserFavoritesV1Paginator=re.ListTimelineV1Paginator=re.UserTimelineV1Paginator=re.MentionTimelineV1Paginator=re.HomeTimelineV1Paginator=void 0;var ph=mh($t()),qt=class extends ph.default{constructor(){super(...arguments),this.hasFinishedFetch=!1}refreshInstanceFromResult(e,t){let n=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.push(...n),this.hasFinishedFetch=n.length===0)}getNextQueryParams(e){let t=BigInt(this._realData[this._realData.length-1].id_str);return{...this.injectQueryParams(e),max_id:(t-BigInt(1)).toString()}}getPageLengthFromRequest(e){return e.data.length}isFetchLastOver(e){return!e.data.length}canFetchNextPage(e){return e.length>0}getItemArray(){return this.tweets}get tweets(){return this._realData}get done(){return super.done||this.hasFinishedFetch}},wi=class extends qt{constructor(){super(...arguments),this._endpoint="statuses/home_timeline.json"}};re.HomeTimelineV1Paginator=wi;var Si=class extends qt{constructor(){super(...arguments),this._endpoint="statuses/mentions_timeline.json"}};re.MentionTimelineV1Paginator=Si;var vi=class extends qt{constructor(){super(...arguments),this._endpoint="statuses/user_timeline.json"}};re.UserTimelineV1Paginator=vi;var Ti=class extends qt{constructor(){super(...arguments),this._endpoint="lists/statuses.json"}};re.ListTimelineV1Paginator=Ti;var Ri=class extends qt{constructor(){super(...arguments),this._endpoint="favorites/list.json"}};re.UserFavoritesV1Paginator=Ri});var Ai=g(Jt=>{"use strict";Object.defineProperty(Jt,"__esModule",{value:!0});Jt.MuteUserIdsV1Paginator=Jt.MuteUserListV1Paginator=void 0;var Wl=St(),qi=class extends Wl.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="mutes/users/list.json"}refreshInstanceFromResult(e,t){let n=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.users.push(...n.users),this._realData.next_cursor=n.next_cursor)}getPageLengthFromRequest(e){return e.data.users.length}getItemArray(){return this.users}get users(){return this._realData.users}};Jt.MuteUserListV1Paginator=qi;var Di=class extends Wl.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="mutes/users/ids.json",this._maxResultsWhenFetchLast=5e3}refreshInstanceFromResult(e,t){let n=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.ids.push(...n.ids),this._realData.next_cursor=n.next_cursor)}getPageLengthFromRequest(e){return e.data.ids.length}getItemArray(){return this.ids}get ids(){return this._realData.ids}};Jt.MuteUserIdsV1Paginator=Di});var Li=g(Zt=>{"use strict";Object.defineProperty(Zt,"__esModule",{value:!0});Zt.UserFollowerIdsV1Paginator=Zt.UserFollowerListV1Paginator=void 0;var zl=St(),Ci=class extends zl.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="followers/list.json"}refreshInstanceFromResult(e,t){let n=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.users.push(...n.users),this._realData.next_cursor=n.next_cursor)}getPageLengthFromRequest(e){return e.data.users.length}getItemArray(){return this.users}get users(){return this._realData.users}};Zt.UserFollowerListV1Paginator=Ci;var Oi=class extends zl.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="followers/ids.json",this._maxResultsWhenFetchLast=5e3}refreshInstanceFromResult(e,t){let n=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.ids.push(...n.ids),this._realData.next_cursor=n.next_cursor)}getPageLengthFromRequest(e){return e.data.ids.length}getItemArray(){return this.ids}get ids(){return this._realData.ids}};Zt.UserFollowerIdsV1Paginator=Oi});var Mi=g(er=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0});er.UserFollowersIdsV1Paginator=er.UserFriendListV1Paginator=void 0;var Nl=St(),Ei=class extends Nl.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="friends/list.json"}refreshInstanceFromResult(e,t){let n=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.users.push(...n.users),this._realData.next_cursor=n.next_cursor)}getPageLengthFromRequest(e){return e.data.users.length}getItemArray(){return this.users}get users(){return this._realData.users}};er.UserFriendListV1Paginator=Ei;var Ii=class extends Nl.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="friends/ids.json",this._maxResultsWhenFetchLast=5e3}refreshInstanceFromResult(e,t){let n=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.ids.push(...n.ids),this._realData.next_cursor=n.next_cursor)}getPageLengthFromRequest(e){return e.data.ids.length}getItemArray(){return this.ids}get ids(){return this._realData.ids}};er.UserFollowersIdsV1Paginator=Ii});var Fi=g(ke=>{"use strict";var _h=ke&&ke.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ke,"__esModule",{value:!0});ke.FriendshipsOutgoingV1Paginator=ke.FriendshipsIncomingV1Paginator=ke.UserSearchV1Paginator=void 0;var gh=_h($t()),yh=St(),ki=class extends gh.default{constructor(){super(...arguments),this._endpoint="users/search.json"}refreshInstanceFromResult(e,t){let n=e.data;this._rateLimit=e.rateLimit,t&&this._realData.push(...n)}getNextQueryParams(e){var t;let n=Number((t=this._queryParams.page)!==null&&t!==void 0?t:"1");return{...this._queryParams,page:n+1,...e?{count:e}:{}}}getPageLengthFromRequest(e){return e.data.length}isFetchLastOver(e){return!e.data.length}canFetchNextPage(e){return e.length>0}getItemArray(){return this.users}get users(){return this._realData}};ke.UserSearchV1Paginator=ki;var Xn=class extends yh.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="friendships/incoming.json",this._maxResultsWhenFetchLast=5e3}refreshInstanceFromResult(e,t){let n=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.ids.push(...n.ids),this._realData.next_cursor=n.next_cursor)}getPageLengthFromRequest(e){return e.data.ids.length}getItemArray(){return this.ids}get ids(){return this._realData.ids}};ke.FriendshipsIncomingV1Paginator=Xn;var ji=class extends Xn{constructor(){super(...arguments),this._endpoint="friendships/outgoing.json"}};ke.FriendshipsOutgoingV1Paginator=ji});var Ni=g(me=>{"use strict";Object.defineProperty(me,"__esModule",{value:!0});me.ListSubscribersV1Paginator=me.ListMembersV1Paginator=me.ListSubscriptionsV1Paginator=me.ListOwnershipsV1Paginator=me.ListMembershipsV1Paginator=void 0;var $l=St(),kr=class extends $l.CursoredV1Paginator{refreshInstanceFromResult(e,t){let n=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.lists.push(...n.lists),this._realData.next_cursor=n.next_cursor)}getPageLengthFromRequest(e){return e.data.lists.length}getItemArray(){return this.lists}get lists(){return this._realData.lists}},Bi=class extends kr{constructor(){super(...arguments),this._endpoint="lists/memberships.json"}};me.ListMembershipsV1Paginator=Bi;var xi=class extends kr{constructor(){super(...arguments),this._endpoint="lists/ownerships.json"}};me.ListOwnershipsV1Paginator=xi;var Ui=class extends kr{constructor(){super(...arguments),this._endpoint="lists/subscriptions.json"}};me.ListSubscriptionsV1Paginator=Ui;var Gn=class extends $l.CursoredV1Paginator{refreshInstanceFromResult(e,t){let n=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.users.push(...n.users),this._realData.next_cursor=n.next_cursor)}getPageLengthFromRequest(e){return e.data.users.length}getItemArray(){return this.users}get users(){return this._realData.users}},Wi=class extends Gn{constructor(){super(...arguments),this._endpoint="lists/members.json"}};me.ListMembersV1Paginator=Wi;var zi=class extends Gn{constructor(){super(...arguments),this._endpoint="lists/subscribers.json"}};me.ListSubscribersV1Paginator=zi});var Qi=g(Fr=>{"use strict";var Yl=Fr&&Fr.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Fr,"__esModule",{value:!0});var bh=Yl(Kn()),$i=Te(),wh=ut(),Sh=Yl(Jn()),Dt=Pi(),Vl=Ai(),Hl=Li(),Ql=Mi(),Vi=Fi(),jr=Ni(),Hi=class extends bh.default{constructor(){super(...arguments),this._prefix=$i.API_V1_1_PREFIX}singleTweet(e,t={}){return this.get("statuses/show.json",{tweet_mode:"extended",id:e,...t})}tweets(e,t={}){return this.post("statuses/lookup.json",{tweet_mode:"extended",id:e,...t})}oembedTweet(e,t={}){return this.get("oembed",{url:`https://twitter.com/i/statuses/${e}`,...t},{prefix:"https://publish.twitter.com/"})}async homeTimeline(e={}){let t={tweet_mode:"extended",...e},n=await this.get("statuses/home_timeline.json",t,{fullResponse:!0});return new Dt.HomeTimelineV1Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:t})}async mentionTimeline(e={}){let t={tweet_mode:"extended",...e},n=await this.get("statuses/mentions_timeline.json",t,{fullResponse:!0});return new Dt.MentionTimelineV1Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:t})}async userTimeline(e,t={}){let n={tweet_mode:"extended",user_id:e,...t},a=await this.get("statuses/user_timeline.json",n,{fullResponse:!0});return new Dt.UserTimelineV1Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:n})}async userTimelineByUsername(e,t={}){let n={tweet_mode:"extended",screen_name:e,...t},a=await this.get("statuses/user_timeline.json",n,{fullResponse:!0});return new Dt.UserTimelineV1Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:n})}async favoriteTimeline(e,t={}){let n={tweet_mode:"extended",user_id:e,...t},a=await this.get("favorites/list.json",n,{fullResponse:!0});return new Dt.UserFavoritesV1Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:n})}async favoriteTimelineByUsername(e,t={}){let n={tweet_mode:"extended",screen_name:e,...t},a=await this.get("favorites/list.json",n,{fullResponse:!0});return new Dt.UserFavoritesV1Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:n})}user(e){return this.get("users/show.json",{tweet_mode:"extended",...e})}users(e){return this.get("users/lookup.json",{tweet_mode:"extended",...e})}verifyCredentials(e={}){return this.get("account/verify_credentials.json",e)}async listMutedUsers(e={}){let t={tweet_mode:"extended",...e},n=await this.get("mutes/users/list.json",t,{fullResponse:!0});return new Vl.MuteUserListV1Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:t})}async listMutedUserIds(e={}){let t={stringify_ids:!0,...e},n=await this.get("mutes/users/ids.json",t,{fullResponse:!0});return new Vl.MuteUserIdsV1Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:t})}async userFriendList(e={}){let t={...e},n=await this.get("friends/list.json",t,{fullResponse:!0});return new Ql.UserFriendListV1Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:t})}async userFollowerList(e={}){let t={...e},n=await this.get("followers/list.json",t,{fullResponse:!0});return new Hl.UserFollowerListV1Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:t})}async userFollowerIds(e={}){let t={stringify_ids:!0,...e},n=await this.get("followers/ids.json",t,{fullResponse:!0});return new Hl.UserFollowerIdsV1Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:t})}async userFollowingIds(e={}){let t={stringify_ids:!0,...e},n=await this.get("friends/ids.json",t,{fullResponse:!0});return new Ql.UserFollowersIdsV1Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:t})}async searchUsers(e,t={}){let n={q:e,tweet_mode:"extended",page:1,...t},a=await this.get("users/search.json",n,{fullResponse:!0});return new Vi.UserSearchV1Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:n})}friendship(e){return this.get("friendships/show.json",e)}friendships(e){return this.get("friendships/lookup.json",e)}friendshipsNoRetweets(){return this.get("friendships/no_retweets/ids.json",{stringify_ids:!0})}async friendshipsIncoming(e={}){let t={stringify_ids:!0,...e},n=await this.get("friendships/incoming.json",t,{fullResponse:!0});return new Vi.FriendshipsIncomingV1Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:t})}async friendshipsOutgoing(e={}){let t={stringify_ids:!0,...e},n=await this.get("friendships/outgoing.json",t,{fullResponse:!0});return new Vi.FriendshipsOutgoingV1Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:t})}accountSettings(){return this.get("account/settings.json")}userProfileBannerSizes(e){return this.get("users/profile_banner.json",e)}list(e){return this.get("lists/show.json",{tweet_mode:"extended",...e})}lists(e={}){return this.get("lists/list.json",{tweet_mode:"extended",...e})}async listMembers(e={}){let t={tweet_mode:"extended",...e},n=await this.get("lists/members.json",t,{fullResponse:!0});return new jr.ListMembersV1Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:t})}listGetMember(e){return this.get("lists/members/show.json",{tweet_mode:"extended",...e})}async listMemberships(e={}){let t={tweet_mode:"extended",...e},n=await this.get("lists/memberships.json",t,{fullResponse:!0});return new jr.ListMembershipsV1Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:t})}async listOwnerships(e={}){let t={tweet_mode:"extended",...e},n=await this.get("lists/ownerships.json",t,{fullResponse:!0});return new jr.ListOwnershipsV1Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:t})}async listStatuses(e){let t={tweet_mode:"extended",...e},n=await this.get("lists/statuses.json",t,{fullResponse:!0});return new Dt.ListTimelineV1Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:t})}async listSubscribers(e={}){let t={tweet_mode:"extended",...e},n=await this.get("lists/subscribers.json",t,{fullResponse:!0});return new jr.ListSubscribersV1Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:t})}listGetSubscriber(e){return this.get("lists/subscribers/show.json",{tweet_mode:"extended",...e})}async listSubscriptions(e={}){let t={tweet_mode:"extended",...e},n=await this.get("lists/subscriptions.json",t,{fullResponse:!0});return new jr.ListSubscriptionsV1Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:t})}mediaInfo(e){return this.get("media/upload.json",{command:"STATUS",media_id:e},{prefix:$i.API_V1_1_UPLOAD_PREFIX})}filterStream({autoConnect:e,...t}={}){let n={};for(let[u,c]of Object.entries(t))if(u==="follow"||u==="track")n[u]=c.toString();else if(u==="locations"){let f=c;n.locations=(0,wh.arrayWrap)(f).map(m=>`${m.lng},${m.lat}`).join(",")}else n[u]=c;return this.stream.postStream("statuses/filter.json",n,{autoConnect:e})}sampleStream({autoConnect:e,...t}={}){return this.stream.getStream("statuses/sample.json",t,{autoConnect:e})}get stream(){let e=new Sh.default(this);return e.setPrefix($i.API_V1_1_STREAM_PREFIX),e}trendsByPlace(e,t={}){return this.get("trends/place.json",{id:e,...t})}trendsAvailable(){return this.get("trends/available.json")}trendsClosest(e,t){return this.get("trends/closest.json",{lat:e,long:t})}geoPlace(e){return this.get("geo/id/:place_id.json",void 0,{params:{place_id:e}})}geoSearch(e){return this.get("geo/search.json",e)}geoReverseGeoCode(e){return this.get("geo/reverse_geocode.json",e)}rateLimitStatuses(...e){return this.get("application/rate_limit_status.json",{resources:e})}supportedLanguages(){return this.get("help/languages.json")}};Fr.default=Hi});var Gl=g(F=>{"use strict";var vh=F&&F.__createBinding||(Object.create?function(s,e,t,n){n===void 0&&(n=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,n,a)}:function(s,e,t,n){n===void 0&&(n=t),s[n]=e[t]}),Th=F&&F.__setModuleDefault||(Object.create?function(s,e){Object.defineProperty(s,"default",{enumerable:!0,value:e})}:function(s,e){s.default=e}),Rh=F&&F.__importStar||function(s){if(s&&s.__esModule)return s;var e={};if(s!=null)for(var t in s)t!=="default"&&Object.prototype.hasOwnProperty.call(s,t)&&vh(e,s,t);return Th(e,s),e};Object.defineProperty(F,"__esModule",{value:!0});F.readNextPartOf=F.sleepSecs=F.getMediaCategoryByMime=F.getMimeType=F.getFileSizeFromFileHandle=F.getFileHandle=F.readFileIntoBuffer=void 0;var Zn=Rh(require("fs")),Kl=ut(),W=Ie();async function Ph(s){let e=await Xl(s);return typeof e=="number"?new Promise((t,n)=>{Zn.readFile(e,(a,u)=>{if(a)return n(a);t(u)})}):e instanceof Buffer?e:e.readFile()}F.readFileIntoBuffer=Ph;function Xl(s){if(typeof s=="string")return Zn.promises.open(s,"r");if(typeof s=="number")return s;if(typeof s=="object"&&!(s instanceof Buffer))return s;if(s instanceof Buffer)return s;throw new Error("Given file is not valid, please check its type.")}F.getFileHandle=Xl;async function qh(s){return typeof s=="number"?(await new Promise((t,n)=>{Zn.fstat(s,(a,u)=>{a&&n(a),t(u)})})).size:s instanceof Buffer?s.length:(await s.stat()).size}F.getFileSizeFromFileHandle=qh;function Dh(s,e,t){if(typeof t=="string")return t;if(typeof s=="string"&&!e)return Ah(s);if(typeof e=="string")return Ch(e);throw new Error("You must specify type if file is a file handle or Buffer.")}F.getMimeType=Dh;function Ah(s){return s.endsWith(".jpeg")||s.endsWith(".jpg")?W.EUploadMimeType.Jpeg:s.endsWith(".png")?W.EUploadMimeType.Png:s.endsWith(".webp")?W.EUploadMimeType.Webp:s.endsWith(".gif")?W.EUploadMimeType.Gif:s.endsWith(".mpeg4")||s.endsWith(".mp4")?W.EUploadMimeType.Mp4:s.endsWith(".mov")||s.endsWith(".mov")?W.EUploadMimeType.Mov:s.endsWith(".srt")?W.EUploadMimeType.Srt:((0,Kl.safeDeprecationWarning)({instance:"TwitterApiv1ReadWrite",method:"uploadMedia",problem:"options.mimeType is missing and filename couldn't help to resolve MIME type, so it will fallback to image/jpeg",resolution:"If you except to give filenames without extensions, please specify explicitlty the MIME type using options.mimeType"}),W.EUploadMimeType.Jpeg)}function Ch(s){return(0,Kl.safeDeprecationWarning)({instance:"TwitterApiv1ReadWrite",method:"uploadMedia",problem:"you're using options.type",resolution:"Remove options.type argument and migrate to options.mimeType which takes the real MIME type. If you're using type=longmp4, add options.longVideo alongside of mimeType=EUploadMimeType.Mp4"}),s==="gif"?W.EUploadMimeType.Gif:s==="jpg"?W.EUploadMimeType.Jpeg:s==="png"?W.EUploadMimeType.Png:s==="webp"?W.EUploadMimeType.Webp:s==="srt"?W.EUploadMimeType.Srt:s==="mp4"||s==="longmp4"?W.EUploadMimeType.Mp4:s==="mov"?W.EUploadMimeType.Mov:s}function Oh(s,e){return s===W.EUploadMimeType.Mp4||s===W.EUploadMimeType.Mov?e==="tweet"?"TweetVideo":"DmVideo":s===W.EUploadMimeType.Gif?e==="tweet"?"TweetGif":"DmGif":s===W.EUploadMimeType.Srt?"Subtitles":e==="tweet"?"TweetImage":"DmImage"}F.getMediaCategoryByMime=Oh;function Lh(s){return new Promise(e=>setTimeout(e,s*1e3))}F.sleepSecs=Lh;async function Eh(s,e,t=0,n){if(s instanceof Buffer){let u=s.slice(t,t+e);return[u,u.length]}if(!n)throw new Error("Well, we will need a buffer to store file content.");let a;return typeof s=="number"?a=await new Promise((u,c)=>{Zn.read(s,n,0,e,t,(f,m)=>{f&&c(f),u(m)})}):a=(await s.read(n,0,e,t)).bytesRead,[n,a]}F.readNextPartOf=Eh});var Xi=g(Pe=>{"use strict";var Ih=Pe&&Pe.__createBinding||(Object.create?function(s,e,t,n){n===void 0&&(n=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,n,a)}:function(s,e,t,n){n===void 0&&(n=t),s[n]=e[t]}),Mh=Pe&&Pe.__setModuleDefault||(Object.create?function(s,e){Object.defineProperty(s,"default",{enumerable:!0,value:e})}:function(s,e){s.default=e}),kh=Pe&&Pe.__importStar||function(s){if(s&&s.__esModule)return s;var e={};if(s!=null)for(var t in s)t!=="default"&&Object.prototype.hasOwnProperty.call(s,t)&&Ih(e,s,t);return Mh(e,s),e},jh=Pe&&Pe.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Pe,"__esModule",{value:!0});var Jl=kh(require("fs")),At=Te(),es=ut(),Fh=Ie(),Bh=jh(Qi()),je=Gl(),Yi="media/upload.json",Ki=class extends Bh.default{constructor(){super(...arguments),this._prefix=At.API_V1_1_PREFIX}get readOnly(){return this}tweet(e,t={}){let n={status:e,tweet_mode:"extended",...t};return this.post("statuses/update.json",n)}async quote(e,t,n={}){let a="https://twitter.com/i/statuses/"+t;return this.tweet(e,{...n,attachment_url:a})}async tweetThread(e){let t=[];for(let n of e){let a=t.length?t[t.length-1]:null,u={...typeof n=="string"?{status:n}:n},c=a?a.id_str:u.in_reply_to_status_id,f=u.status;c?t.push(await this.reply(f,c,u)):t.push(await this.tweet(f,u))}return t}reply(e,t,n={}){return this.tweet(e,{auto_populate_reply_metadata:!0,in_reply_to_status_id:t,...n})}deleteTweet(e){return this.post("statuses/destroy/:id.json",{tweet_mode:"extended"},{params:{id:e}})}reportUserAsSpam(e){return this.post("users/report_spam.json",{tweet_mode:"extended",...e})}updateFriendship(e){return this.post("friendships/update.json",e)}createFriendship(e){return this.post("friendships/create.json",e)}destroyFriendship(e){return this.post("friendships/destroy.json",e)}updateAccountSettings(e){return this.post("account/settings.json",e)}updateAccountProfile(e){return this.post("account/update_profile.json",e)}async updateAccountProfileBanner(e,t={}){let n={banner:await(0,je.readFileIntoBuffer)(e),...t};return this.post("account/update_profile_banner.json",n,{forceBodyMode:"form-data"})}async updateAccountProfileImage(e,t={}){let n={tweet_mode:"extended",image:await(0,je.readFileIntoBuffer)(e),...t};return this.post("account/update_profile_image.json",n,{forceBodyMode:"form-data"})}removeAccountProfileBanner(){return this.post("account/remove_profile_banner.json")}createList(e){return this.post("lists/create.json",{tweet_mode:"extended",...e})}updateList(e){return this.post("lists/update.json",{tweet_mode:"extended",...e})}removeList(e){return this.post("lists/destroy.json",{tweet_mode:"extended",...e})}addListMembers(e){let n=e.user_id&&(0,es.hasMultipleItems)(e.user_id)||e.screen_name&&(0,es.hasMultipleItems)(e.screen_name)?"lists/members/create_all.json":"lists/members/create.json";return this.post(n,e)}removeListMembers(e){let n=e.user_id&&(0,es.hasMultipleItems)(e.user_id)||e.screen_name&&(0,es.hasMultipleItems)(e.screen_name)?"lists/members/destroy_all.json":"lists/members/destroy.json";return this.post(n,e)}subscribeToList(e){return this.post("lists/subscribers/create.json",{tweet_mode:"extended",...e})}unsubscribeOfList(e){return this.post("lists/subscribers/destroy.json",{tweet_mode:"extended",...e})}createMediaMetadata(e,t){return this.post("media/metadata/create.json",{media_id:e,...t},{prefix:At.API_V1_1_UPLOAD_PREFIX,forceBodyMode:"json"})}createMediaSubtitles(e,t){return this.post("media/subtitles/create.json",{media_id:e,media_category:"TweetVideo",subtitle_info:{subtitles:t}},{prefix:At.API_V1_1_UPLOAD_PREFIX,forceBodyMode:"json"})}deleteMediaSubtitles(e,...t){return this.post("media/subtitles/delete.json",{media_id:e,media_category:"TweetVideo",subtitle_info:{subtitles:t.map(n=>({language_code:n}))}},{prefix:At.API_V1_1_UPLOAD_PREFIX,forceBodyMode:"json"})}async uploadMedia(e,t={},n=!1){var a;let u=(a=t.chunkLength)!==null&&a!==void 0?a:1048576,{fileHandle:c,mediaCategory:f,fileSize:m,mimeType:b}=await this.getUploadMediaRequirements(e,t);try{let S=await this.post(Yi,{command:"INIT",total_bytes:m,media_type:b,media_category:f,additional_owners:t.additionalOwners,shared:t.shared?!0:void 0},{prefix:At.API_V1_1_UPLOAD_PREFIX});await this.mediaChunkedUpload(c,u,S.media_id_string,t.maxConcurrentUploads);let R=await this.post(Yi,{command:"FINALIZE",media_id:S.media_id_string},{prefix:At.API_V1_1_UPLOAD_PREFIX});return R.processing_info&&R.processing_info.state!=="succeeded"&&await this.awaitForMediaProcessingCompletion(R),n?R:R.media_id_string}finally{typeof e=="number"?Jl.close(e,()=>{}):typeof c=="object"&&!(c instanceof Buffer)&&c.close()}}async awaitForMediaProcessingCompletion(e){for(var t;;){e=await this.mediaInfo(e.media_id_string);let{processing_info:n}=e;if(!n||n.state==="succeeded")return;if(!((t=n.error)===null||t===void 0)&&t.code){let{name:a,message:u}=n.error;throw new Error(`Failed to process media: ${a} - ${u}.`)}if(n.state==="failed")throw new Error("Failed to process the media.");n.check_after_secs?await(0,je.sleepSecs)(n.check_after_secs):await(0,je.sleepSecs)(5)}}async getUploadMediaRequirements(e,{mimeType:t,type:n,target:a,longVideo:u}={}){let c;try{c=await(0,je.getFileHandle)(e);let f=(0,je.getMimeType)(e,n,t),m;return f===Fh.EUploadMimeType.Mp4&&(!t&&!n&&a!=="dm"||u)?m="amplify_video":m=(0,je.getMediaCategoryByMime)(f,a??"tweet"),{fileHandle:c,mediaCategory:m,fileSize:await(0,je.getFileSizeFromFileHandle)(c),mimeType:f}}catch(f){throw typeof e=="number"?Jl.close(e,()=>{}):typeof c=="object"&&!(c instanceof Buffer)&&c.close(),f}}async mediaChunkedUpload(e,t,n,a=3){let u=0;if(a<1)throw new RangeError("Bad maxConcurrentUploads parameter.");let c=e instanceof Buffer?void 0:Buffer.alloc(t),f,m,b=0;[f,m]=await(0,je.readNextPartOf)(e,t,b,c),b+=m;let S=new Set;for(;m;){let R=f.slice(0,m);if(R.length){let w=this.post(Yi,{command:"APPEND",media_id:n,segment_index:u,media:R},{prefix:At.API_V1_1_UPLOAD_PREFIX});S.add(w),w.then(()=>{S.delete(w)}),u++}S.size>=a&&await Promise.race(S),[f,m]=await(0,je.readNextPartOf)(e,t,b,c),b+=m}await Promise.all([...S])}};Pe.default=Ki});var Jn=g(Ct=>{"use strict";var xh=Ct&&Ct.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ct,"__esModule",{value:!0});Ct.TwitterApiv1=void 0;var Uh=Te(),Zl=ni(),Br=Ie(),Wh=xh(Xi()),ts=class extends Wh.default{constructor(){super(...arguments),this._prefix=Uh.API_V1_1_PREFIX}get readWrite(){return this}sendDm({recipient_id:e,custom_profile_id:t,...n}){let a={event:{type:Br.EDirectMessageEventTypeV1.Create,[Br.EDirectMessageEventTypeV1.Create]:{target:{recipient_id:e},message_data:n}}};return t&&(a.event[Br.EDirectMessageEventTypeV1.Create].custom_profile_id=t),this.post("direct_messages/events/new.json",a,{forceBodyMode:"json"})}getDmEvent(e){return this.get("direct_messages/events/show.json",{id:e})}deleteDm(e){return this.delete("direct_messages/events/destroy.json",{id:e})}async listDmEvents(e={}){let t={...e},n=await this.get("direct_messages/events/list.json",t,{fullResponse:!0});return new Zl.DmEventsV1Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:t})}newWelcomeDm(e,t){let n={[Br.EDirectMessageEventTypeV1.WelcomeCreate]:{name:e,message_data:t}};return this.post("direct_messages/welcome_messages/new.json",n,{forceBodyMode:"json"})}getWelcomeDm(e){return this.get("direct_messages/welcome_messages/show.json",{id:e})}deleteWelcomeDm(e){return this.delete("direct_messages/welcome_messages/destroy.json",{id:e})}updateWelcomeDm(e,t){let n={message_data:t};return this.put("direct_messages/welcome_messages/update.json",n,{forceBodyMode:"json",query:{id:e}})}async listWelcomeDms(e={}){let t={...e},n=await this.get("direct_messages/welcome_messages/list.json",t,{fullResponse:!0});return new Zl.WelcomeDmV1Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:t})}newWelcomeDmRule(e){return this.post("direct_messages/welcome_messages/rules/new.json",{welcome_message_rule:{welcome_message_id:e}},{forceBodyMode:"json"})}getWelcomeDmRule(e){return this.get("direct_messages/welcome_messages/rules/show.json",{id:e})}deleteWelcomeDmRule(e){return this.delete("direct_messages/welcome_messages/rules/destroy.json",{id:e})}async listWelcomeDmRules(e={}){let t={...e};return this.get("direct_messages/welcome_messages/rules/list.json",t)}async setWelcomeDm(e,t=!0){var n;let a=await this.listWelcomeDmRules();if(!((n=a.welcome_message_rules)===null||n===void 0)&&n.length)for(let u of a.welcome_message_rules)await this.deleteWelcomeDmRule(u.id),t&&await this.deleteWelcomeDm(u.welcome_message_id);return this.newWelcomeDmRule(e)}markDmAsRead(e,t){return this.post("direct_messages/mark_read.json",{last_read_event_id:e,recipient_id:t},{forceBodyMode:"url"})}indicateDmTyping(e){return this.post("direct_messages/indicate_typing.json",{recipient_id:e},{forceBodyMode:"url"})}async downloadDmImage(e){if(typeof e!="string"){let n=e[Br.EDirectMessageEventTypeV1.Create].message_data.attachment;if(!n)throw new Error("The given direct message doesn't contain any attachment");e=n.media.media_url_https}let t=await this.get(e,void 0,{forceParseMode:"buffer",prefix:""});if(!t.length)throw new Error("Image not found. Make sure you are logged with credentials able to access direct messages, and check the URL.");return t}};Ct.TwitterApiv1=ts;Ct.default=ts});var Gi=g(rs=>{"use strict";Object.defineProperty(rs,"__esModule",{value:!0});rs.TwitterV2IncludesHelper=void 0;var E=class{constructor(e){this.result=e}get tweets(){return E.tweets(this.result)}static tweets(e){var t,n;return(n=(t=e.includes)===null||t===void 0?void 0:t.tweets)!==null&&n!==void 0?n:[]}tweetById(e){return E.tweetById(this.result,e)}static tweetById(e,t){return this.tweets(e).find(n=>n.id===t)}retweet(e){return E.retweet(this.result,e)}static retweet(e,t){var n;let a=((n=t.referenced_tweets)!==null&&n!==void 0?n:[]).filter(u=>u.type==="retweeted").map(u=>u.id);return this.tweets(e).find(u=>a.includes(u.id))}quote(e){return E.quote(this.result,e)}static quote(e,t){var n;let a=((n=t.referenced_tweets)!==null&&n!==void 0?n:[]).filter(u=>u.type==="quoted").map(u=>u.id);return this.tweets(e).find(u=>a.includes(u.id))}repliedTo(e){return E.repliedTo(this.result,e)}static repliedTo(e,t){var n;let a=((n=t.referenced_tweets)!==null&&n!==void 0?n:[]).filter(u=>u.type==="replied_to").map(u=>u.id);return this.tweets(e).find(u=>a.includes(u.id))}author(e){return E.author(this.result,e)}static author(e,t){let n=t.author_id;return n?this.users(e).find(a=>a.id===n):void 0}repliedToAuthor(e){return E.repliedToAuthor(this.result,e)}static repliedToAuthor(e,t){let n=t.in_reply_to_user_id;return n?this.users(e).find(a=>a.id===n):void 0}get users(){return E.users(this.result)}static users(e){var t,n;return(n=(t=e.includes)===null||t===void 0?void 0:t.users)!==null&&n!==void 0?n:[]}userById(e){return E.userById(this.result,e)}static userById(e,t){return this.users(e).find(n=>n.id===t)}pinnedTweet(e){return E.pinnedTweet(this.result,e)}static pinnedTweet(e,t){return t.pinned_tweet_id?this.tweets(e).find(n=>n.id===t.pinned_tweet_id):void 0}get media(){return E.media(this.result)}static media(e){var t,n;return(n=(t=e.includes)===null||t===void 0?void 0:t.media)!==null&&n!==void 0?n:[]}medias(e){return E.medias(this.result,e)}static medias(e,t){var n,a;let u=(a=(n=t.attachments)===null||n===void 0?void 0:n.media_keys)!==null&&a!==void 0?a:[];return this.media(e).filter(c=>u.includes(c.media_key))}get polls(){return E.polls(this.result)}static polls(e){var t,n;return(n=(t=e.includes)===null||t===void 0?void 0:t.polls)!==null&&n!==void 0?n:[]}poll(e){return E.poll(this.result,e)}static poll(e,t){var n,a;let u=(a=(n=t.attachments)===null||n===void 0?void 0:n.poll_ids)!==null&&a!==void 0?a:[];if(u.length){let c=u[0];return this.polls(e).find(f=>f.id===c)}}get places(){return E.places(this.result)}static places(e){var t,n;return(n=(t=e.includes)===null||t===void 0?void 0:t.places)!==null&&n!==void 0?n:[]}place(e){return E.place(this.result,e)}static place(e,t){var n;let a=(n=t.geo)===null||n===void 0?void 0:n.place_id;return a?this.places(e).find(u=>u.id===a):void 0}listOwner(e){return E.listOwner(this.result,e)}static listOwner(e,t){let n=t.owner_id;return n?this.users(e).find(a=>a.id===n):void 0}spaceCreator(e){return E.spaceCreator(this.result,e)}static spaceCreator(e,t){let n=t.creator_id;return n?this.users(e).find(a=>a.id===n):void 0}spaceHosts(e){return E.spaceHosts(this.result,e)}static spaceHosts(e,t){var n;let a=(n=t.host_ids)!==null&&n!==void 0?n:[];return this.users(e).filter(u=>a.includes(u.id))}spaceSpeakers(e){return E.spaceSpeakers(this.result,e)}static spaceSpeakers(e,t){var n;let a=(n=t.speaker_ids)!==null&&n!==void 0?n:[];return this.users(e).filter(u=>a.includes(u.id))}spaceInvitedUsers(e){return E.spaceInvitedUsers(this.result,e)}static spaceInvitedUsers(e,t){var n;let a=(n=t.invited_user_ids)!==null&&n!==void 0?n:[];return this.users(e).filter(u=>a.includes(u.id))}};rs.TwitterV2IncludesHelper=E});var xr=g(tr=>{"use strict";Object.defineProperty(tr,"__esModule",{value:!0});tr.TimelineV2Paginator=tr.TwitterV2Paginator=void 0;var ec=Gi(),zh=$t(),ns=class extends zh.PreviousableTwitterPaginator{updateIncludes(e){if(e.errors&&(this._realData.errors||(this._realData.errors=[]),this._realData.errors=[...this._realData.errors,...e.errors]),!e.includes)return;this._realData.includes||(this._realData.includes={});let t=this._realData.includes;for(let[n,a]of Object.entries(e.includes))t[n]||(t[n]=[]),t[n]=[...t[n],...a]}assertUsable(){if(this.unusable)throw new Error("Unable to use this paginator to fetch more data, as it does not contain any metadata. Check .errors property for more details.")}get meta(){return this._realData.meta}get includes(){var e;return!((e=this._realData)===null||e===void 0)&&e.includes?this._includesInstance?this._includesInstance:this._includesInstance=new ec.TwitterV2IncludesHelper(this._realData):new ec.TwitterV2IncludesHelper(this._realData)}get errors(){var e;return(e=this._realData.errors)!==null&&e!==void 0?e:[]}get unusable(){return this.errors.length>0&&!this._realData.meta&&!this._realData.data}};tr.TwitterV2Paginator=ns;var Ji=class extends ns{refreshInstanceFromResult(e,t){var n;let a=e.data,u=(n=a.data)!==null&&n!==void 0?n:[];this._rateLimit=e.rateLimit,this._realData.data||(this._realData.data=[]),t?(this._realData.meta.result_count+=a.meta.result_count,this._realData.meta.next_token=a.meta.next_token,this._realData.data.push(...u)):(this._realData.meta.result_count+=a.meta.result_count,this._realData.meta.previous_token=a.meta.previous_token,this._realData.data.unshift(...u)),this.updateIncludes(a)}getNextQueryParams(e){return this.assertUsable(),{...this.injectQueryParams(e),pagination_token:this._realData.meta.next_token}}getPreviousQueryParams(e){return this.assertUsable(),{...this.injectQueryParams(e),pagination_token:this._realData.meta.previous_token}}getPageLengthFromRequest(e){var t,n;return(n=(t=e.data.data)===null||t===void 0?void 0:t.length)!==null&&n!==void 0?n:0}isFetchLastOver(e){var t;return!(!((t=e.data.data)===null||t===void 0)&&t.length)||!this.canFetchNextPage(e.data)}canFetchNextPage(e){var t;return!!(!((t=e.meta)===null||t===void 0)&&t.next_token)}};tr.TimelineV2Paginator=Ji});var tc=g(x=>{"use strict";Object.defineProperty(x,"__esModule",{value:!0});x.TweetV2ListTweetsPaginator=x.TweetV2UserLikedTweetsPaginator=x.TweetBookmarksTimelineV2Paginator=x.TweetUserMentionTimelineV2Paginator=x.TweetUserTimelineV2Paginator=x.TweetHomeTimelineV2Paginator=x.QuotedTweetsTimelineV2Paginator=x.TweetSearchAllV2Paginator=x.TweetSearchRecentV2Paginator=void 0;var ua=xr(),ss=class extends ua.TwitterV2Paginator{refreshInstanceFromResult(e,t){var n;let a=e.data,u=(n=a.data)!==null&&n!==void 0?n:[];this._rateLimit=e.rateLimit,this._realData.data||(this._realData.data=[]),t?(this._realData.meta.oldest_id=a.meta.oldest_id,this._realData.meta.result_count+=a.meta.result_count,this._realData.meta.next_token=a.meta.next_token,this._realData.data.push(...u)):(this._realData.meta.newest_id=a.meta.newest_id,this._realData.meta.result_count+=a.meta.result_count,this._realData.data.unshift(...u)),this.updateIncludes(a)}getNextQueryParams(e){this.assertUsable();let t={...this.injectQueryParams(e)};return this._realData.meta.next_token?t.next_token=this._realData.meta.next_token:(t.start_time&&(t.since_id=this.dateStringToSnowflakeId(t.start_time),delete t.start_time),t.end_time&&delete t.end_time,t.until_id=this._realData.meta.oldest_id),t}getPreviousQueryParams(e){return this.assertUsable(),{...this.injectQueryParams(e),since_id:this._realData.meta.newest_id}}getPageLengthFromRequest(e){var t,n;return(n=(t=e.data.data)===null||t===void 0?void 0:t.length)!==null&&n!==void 0?n:0}isFetchLastOver(e){var t;return!(!((t=e.data.data)===null||t===void 0)&&t.length)||!this.canFetchNextPage(e.data)}canFetchNextPage(e){return!!e.meta.next_token}getItemArray(){return this.tweets}dateStringToSnowflakeId(e){let t=BigInt("1288834974657"),n=new Date(e);if(isNaN(n.valueOf()))throw new Error("Unable to convert start_time/end_time to a valid date. A ISO 8601 DateTime is excepted, please check your input.");return(BigInt(n.valueOf())-t<<BigInt("22")).toString()}get tweets(){var e;return(e=this._realData.data)!==null&&e!==void 0?e:[]}get meta(){return super.meta}},Ot=class extends ua.TimelineV2Paginator{refreshInstanceFromResult(e,t){super.refreshInstanceFromResult(e,t);let n=e.data;t?this._realData.meta.oldest_id=n.meta.oldest_id:this._realData.meta.newest_id=n.meta.newest_id}getItemArray(){return this.tweets}get tweets(){var e;return(e=this._realData.data)!==null&&e!==void 0?e:[]}get meta(){return super.meta}},Zi=class extends ss{constructor(){super(...arguments),this._endpoint="tweets/search/recent"}};x.TweetSearchRecentV2Paginator=Zi;var ea=class extends ss{constructor(){super(...arguments),this._endpoint="tweets/search/all"}};x.TweetSearchAllV2Paginator=ea;var ta=class extends Ot{constructor(){super(...arguments),this._endpoint="tweets/:id/quote_tweets"}};x.QuotedTweetsTimelineV2Paginator=ta;var ra=class extends Ot{constructor(){super(...arguments),this._endpoint="users/:id/timelines/reverse_chronological"}};x.TweetHomeTimelineV2Paginator=ra;var na=class extends Ot{constructor(){super(...arguments),this._endpoint="users/:id/tweets"}};x.TweetUserTimelineV2Paginator=na;var sa=class extends Ot{constructor(){super(...arguments),this._endpoint="users/:id/mentions"}};x.TweetUserMentionTimelineV2Paginator=sa;var ia=class extends Ot{constructor(){super(...arguments),this._endpoint="users/:id/bookmarks"}};x.TweetBookmarksTimelineV2Paginator=ia;var is=class extends ua.TimelineV2Paginator{get tweets(){var e;return(e=this._realData.data)!==null&&e!==void 0?e:[]}get meta(){return super.meta}getItemArray(){return this.tweets}},aa=class extends is{constructor(){super(...arguments),this._endpoint="users/:id/liked_tweets"}};x.TweetV2UserLikedTweetsPaginator=aa;var oa=class extends is{constructor(){super(...arguments),this._endpoint="lists/:id/tweets"}};x.TweetV2ListTweetsPaginator=oa});var ga=g(N=>{"use strict";Object.defineProperty(N,"__esModule",{value:!0});N.TweetRetweetersUsersV2Paginator=N.TweetLikingUsersV2Paginator=N.UserListFollowersV2Paginator=N.UserListMembersV2Paginator=N.UserFollowingV2Paginator=N.UserFollowersV2Paginator=N.UserMutingUsersV2Paginator=N.UserBlockingUsersV2Paginator=void 0;var Nh=xr(),Fe=class extends Nh.TimelineV2Paginator{getItemArray(){return this.users}get users(){var e;return(e=this._realData.data)!==null&&e!==void 0?e:[]}get meta(){return super.meta}},la=class extends Fe{constructor(){super(...arguments),this._endpoint="users/:id/blocking"}};N.UserBlockingUsersV2Paginator=la;var ca=class extends Fe{constructor(){super(...arguments),this._endpoint="users/:id/muting"}};N.UserMutingUsersV2Paginator=ca;var da=class extends Fe{constructor(){super(...arguments),this._endpoint="users/:id/followers"}};N.UserFollowersV2Paginator=da;var fa=class extends Fe{constructor(){super(...arguments),this._endpoint="users/:id/following"}};N.UserFollowingV2Paginator=fa;var ha=class extends Fe{constructor(){super(...arguments),this._endpoint="lists/:id/members"}};N.UserListMembersV2Paginator=ha;var ma=class extends Fe{constructor(){super(...arguments),this._endpoint="lists/:id/followers"}};N.UserListFollowersV2Paginator=ma;var pa=class extends Fe{constructor(){super(...arguments),this._endpoint="tweets/:id/liking_users"}};N.TweetLikingUsersV2Paginator=pa;var _a=class extends Fe{constructor(){super(...arguments),this._endpoint="tweets/:id/retweeted_by"}};N.TweetRetweetersUsersV2Paginator=_a});var rc=g(ct=>{"use strict";Object.defineProperty(ct,"__esModule",{value:!0});ct.UserListFollowedV2Paginator=ct.UserListMembershipsV2Paginator=ct.UserOwnedListsV2Paginator=void 0;var $h=xr(),Ur=class extends $h.TimelineV2Paginator{getItemArray(){return this.lists}get lists(){var e;return(e=this._realData.data)!==null&&e!==void 0?e:[]}get meta(){return super.meta}},ya=class extends Ur{constructor(){super(...arguments),this._endpoint="users/:id/owned_lists"}};ct.UserOwnedListsV2Paginator=ya;var ba=class extends Ur{constructor(){super(...arguments),this._endpoint="users/:id/list_memberships"}};ct.UserListMembershipsV2Paginator=ba;var wa=class extends Ur{constructor(){super(...arguments),this._endpoint="users/:id/followed_lists"}};ct.UserListFollowedV2Paginator=wa});var Sa=g(V=>{"use strict";var Vh=V&&V.__createBinding||(Object.create?function(s,e,t,n){n===void 0&&(n=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,n,a)}:function(s,e,t,n){n===void 0&&(n=t),s[n]=e[t]}),qe=V&&V.__exportStar||function(s,e){for(var t in s)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Vh(e,s,t)};Object.defineProperty(V,"__esModule",{value:!0});qe(tc(),V);qe($t(),V);qe(ni(),V);qe(Ai(),V);qe(Pi(),V);qe(Fi(),V);qe(ga(),V);qe(Ni(),V);qe(rc(),V);qe(Mi(),V);qe(Li(),V)});var Ta=g(Wr=>{"use strict";var Hh=Wr&&Wr.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Wr,"__esModule",{value:!0});var Qh=Hh(Kn()),Yh=Te(),va=class extends Qh.default{constructor(){super(...arguments),this._prefix=Yh.API_V2_LABS_PREFIX}};Wr.default=va});var nc=g(Be=>{"use strict";Object.defineProperty(Be,"__esModule",{value:!0});Be.ConversationDMTimelineV2Paginator=Be.OneToOneDMTimelineV2Paginator=Be.FullDMTimelineV2Paginator=Be.DMTimelineV2Paginator=void 0;var Kh=xr(),rr=class extends Kh.TimelineV2Paginator{getItemArray(){return this.events}get events(){var e;return(e=this._realData.data)!==null&&e!==void 0?e:[]}get meta(){return super.meta}};Be.DMTimelineV2Paginator=rr;var Ra=class extends rr{constructor(){super(...arguments),this._endpoint="dm_events"}};Be.FullDMTimelineV2Paginator=Ra;var Pa=class extends rr{constructor(){super(...arguments),this._endpoint="dm_conversations/with/:participant_id/dm_events"}};Be.OneToOneDMTimelineV2Paginator=Pa;var qa=class extends rr{constructor(){super(...arguments),this._endpoint="dm_conversations/:dm_conversation_id/dm_events"}};Be.ConversationDMTimelineV2Paginator=qa});var Oa=g(zr=>{"use strict";var sc=zr&&zr.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(zr,"__esModule",{value:!0});var Xh=sc(Kn()),Gh=Te(),pe=Sa(),Jh=sc(Ta()),dt=ga(),Da=ut(),Aa=nc(),Ca=class extends Xh.default{constructor(){super(...arguments),this._prefix=Gh.API_V2_PREFIX}get labs(){return this._labs?this._labs:this._labs=new Jh.default(this)}async search(e,t={}){let n=typeof e=="string"?{...t,query:e}:{...e},a=await this.get("tweets/search/recent",n,{fullResponse:!0});return new pe.TweetSearchRecentV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:n})}async searchAll(e,t={}){let n={...t,query:e},a=await this.get("tweets/search/all",n,{fullResponse:!0});return new pe.TweetSearchAllV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:n})}singleTweet(e,t={}){return this.get("tweets/:id",t,{params:{id:e}})}tweets(e,t={}){return this.get("tweets",{ids:e,...t})}tweetCountRecent(e,t={}){return this.get("tweets/counts/recent",{query:e,...t})}tweetCountAll(e,t={}){return this.get("tweets/counts/all",{query:e,...t})}async tweetRetweetedBy(e,t={}){let{asPaginator:n,...a}=t,u=await this.get("tweets/:id/retweeted_by",a,{fullResponse:!0,params:{id:e}});return n?new dt.TweetRetweetersUsersV2Paginator({realData:u.data,rateLimit:u.rateLimit,instance:this,queryParams:a,sharedParams:{id:e}}):u.data}async tweetLikedBy(e,t={}){let{asPaginator:n,...a}=t,u=await this.get("tweets/:id/liking_users",a,{fullResponse:!0,params:{id:e}});return n?new dt.TweetLikingUsersV2Paginator({realData:u.data,rateLimit:u.rateLimit,instance:this,queryParams:a,sharedParams:{id:e}}):u.data}async homeTimeline(e={}){let t=await this.getCurrentUserV2Object(),n=await this.get("users/:id/timelines/reverse_chronological",e,{fullResponse:!0,params:{id:t.data.id}});return new pe.TweetHomeTimelineV2Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:e,sharedParams:{id:t.data.id}})}async userTimeline(e,t={}){let n=await this.get("users/:id/tweets",t,{fullResponse:!0,params:{id:e}});return new pe.TweetUserTimelineV2Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:t,sharedParams:{id:e}})}async userMentionTimeline(e,t={}){let n=await this.get("users/:id/mentions",t,{fullResponse:!0,params:{id:e}});return new pe.TweetUserMentionTimelineV2Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:t,sharedParams:{id:e}})}async quotes(e,t={}){let n=await this.get("tweets/:id/quote_tweets",t,{fullResponse:!0,params:{id:e}});return new pe.QuotedTweetsTimelineV2Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:t,sharedParams:{id:e}})}async bookmarks(e={}){let t=await this.getCurrentUserV2Object(),n=await this.get("users/:id/bookmarks",e,{fullResponse:!0,params:{id:t.data.id}});return new pe.TweetBookmarksTimelineV2Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:e,sharedParams:{id:t.data.id}})}me(e={}){return this.get("users/me",e)}user(e,t={}){return this.get("users/:id",t,{params:{id:e}})}users(e,t={}){let n=Array.isArray(e)?e.join(","):e;return this.get("users",{...t,ids:n})}userByUsername(e,t={}){return this.get("users/by/username/:username",t,{params:{username:e}})}usersByUsernames(e,t={}){return e=Array.isArray(e)?e.join(","):e,this.get("users/by",{...t,usernames:e})}async followers(e,t={}){let{asPaginator:n,...a}=t,u={id:e};if(!n)return this.get("users/:id/followers",a,{params:u});let c=await this.get("users/:id/followers",a,{fullResponse:!0,params:u});return new dt.UserFollowersV2Paginator({realData:c.data,rateLimit:c.rateLimit,instance:this,queryParams:a,sharedParams:u})}async following(e,t={}){let{asPaginator:n,...a}=t,u={id:e};if(!n)return this.get("users/:id/following",a,{params:u});let c=await this.get("users/:id/following",a,{fullResponse:!0,params:u});return new dt.UserFollowingV2Paginator({realData:c.data,rateLimit:c.rateLimit,instance:this,queryParams:a,sharedParams:u})}async userLikedTweets(e,t={}){let n={id:e},a=await this.get("users/:id/liked_tweets",t,{fullResponse:!0,params:n});return new pe.TweetV2UserLikedTweetsPaginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:{...t},sharedParams:n})}async userBlockingUsers(e,t={}){let n={id:e},a=await this.get("users/:id/blocking",t,{fullResponse:!0,params:n});return new dt.UserBlockingUsersV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:{...t},sharedParams:n})}async userMutingUsers(e,t={}){let n={id:e},a=await this.get("users/:id/muting",t,{fullResponse:!0,params:n});return new dt.UserMutingUsersV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:{...t},sharedParams:n})}list(e,t={}){return this.get("lists/:id",t,{params:{id:e}})}async listsOwned(e,t={}){let n={id:e},a=await this.get("users/:id/owned_lists",t,{fullResponse:!0,params:n});return new pe.UserOwnedListsV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:{...t},sharedParams:n})}async listMemberships(e,t={}){let n={id:e},a=await this.get("users/:id/list_memberships",t,{fullResponse:!0,params:n});return new pe.UserListMembershipsV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:{...t},sharedParams:n})}async listFollowed(e,t={}){let n={id:e},a=await this.get("users/:id/followed_lists",t,{fullResponse:!0,params:n});return new pe.UserListFollowedV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:{...t},sharedParams:n})}async listTweets(e,t={}){let n={id:e},a=await this.get("lists/:id/tweets",t,{fullResponse:!0,params:n});return new pe.TweetV2ListTweetsPaginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:{...t},sharedParams:n})}async listMembers(e,t={}){let n={id:e},a=await this.get("lists/:id/members",t,{fullResponse:!0,params:n});return new dt.UserListMembersV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:{...t},sharedParams:n})}async listFollowers(e,t={}){let n={id:e},a=await this.get("lists/:id/followers",t,{fullResponse:!0,params:n});return new dt.UserListFollowersV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:{...t},sharedParams:n})}async listDmEvents(e={}){let t=await this.get("dm_events",e,{fullResponse:!0});return new Aa.FullDMTimelineV2Paginator({realData:t.data,rateLimit:t.rateLimit,instance:this,queryParams:{...e}})}async listDmEventsWithParticipant(e,t={}){let n={participant_id:e},a=await this.get("dm_conversations/with/:participant_id/dm_events",t,{fullResponse:!0,params:n});return new Aa.OneToOneDMTimelineV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:{...t},sharedParams:n})}async listDmEventsOfConversation(e,t={}){let n={dm_conversation_id:e},a=await this.get("dm_conversations/:dm_conversation_id/dm_events",t,{fullResponse:!0,params:n});return new Aa.ConversationDMTimelineV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:{...t},sharedParams:n})}space(e,t={}){return this.get("spaces/:id",t,{params:{id:e}})}spaces(e,t={}){return this.get("spaces",{ids:e,...t})}spacesByCreators(e,t={}){return this.get("spaces/by/creator_ids",{user_ids:e,...t})}searchSpaces(e){return this.get("spaces/search",e)}spaceBuyers(e,t={}){return this.get("spaces/:id/buyers",t,{params:{id:e}})}spaceTweets(e,t={}){return this.get("spaces/:id/tweets",t,{params:{id:e}})}searchStream({autoConnect:e,...t}={}){return this.getStream("tweets/search/stream",t,{payloadIsError:Da.isTweetStreamV2ErrorPayload,autoConnect:e})}streamRules(e={}){return this.get("tweets/search/stream/rules",e)}updateStreamRules(e,t={}){return this.post("tweets/search/stream/rules",e,{query:t})}sampleStream({autoConnect:e,...t}={}){return this.getStream("tweets/sample/stream",t,{payloadIsError:Da.isTweetStreamV2ErrorPayload,autoConnect:e})}sample10Stream({autoConnect:e,...t}={}){return this.getStream("tweets/sample10/stream",t,{payloadIsError:Da.isTweetStreamV2ErrorPayload,autoConnect:e})}complianceJobs(e){return this.get("compliance/jobs",e)}complianceJob(e){return this.get("compliance/jobs/:id",void 0,{params:{id:e}})}async sendComplianceJob(e){let t=await this.post("compliance/jobs",{type:e.type,name:e.name}),n=e.ids instanceof Buffer?e.ids:Buffer.from(e.ids.join(`
`));return await this.put(t.data.upload_url,n,{forceBodyMode:"raw",enableAuth:!1,headers:{"Content-Type":"text/plain"},prefix:""}),t}async complianceJobResult(e){let t=e;for(;t.status!=="complete";){if(t.status==="expired"||t.status==="failed")throw new Error("Job failed to be completed.");await new Promise(a=>setTimeout(a,3500)),t=(await this.complianceJob(e.id)).data}return(await this.get(e.download_url,void 0,{enableAuth:!1,prefix:""})).trim().split(`
`).filter(a=>a).map(a=>JSON.parse(a))}};zr.default=Ca});var Ea=g(Nr=>{"use strict";var Zh=Nr&&Nr.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Nr,"__esModule",{value:!0});var em=Te(),tm=Zh(Ta()),La=class extends tm.default{constructor(){super(...arguments),this._prefix=em.API_V2_LABS_PREFIX}get readOnly(){return this}};Nr.default=La});var Ma=g($r=>{"use strict";var ic=$r&&$r.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty($r,"__esModule",{value:!0});var rm=Te(),nm=ic(Oa()),sm=ic(Ea()),Ia=class extends nm.default{constructor(){super(...arguments),this._prefix=rm.API_V2_PREFIX}get readOnly(){return this}get labs(){return this._labs?this._labs:this._labs=new sm.default(this)}hideReply(e,t){return this.put("tweets/:id/hidden",{hidden:t},{params:{id:e}})}like(e,t){return this.post("users/:id/likes",{tweet_id:t},{params:{id:e}})}unlike(e,t){return this.delete("users/:id/likes/:tweet_id",void 0,{params:{id:e,tweet_id:t}})}retweet(e,t){return this.post("users/:id/retweets",{tweet_id:t},{params:{id:e}})}unretweet(e,t){return this.delete("users/:id/retweets/:tweet_id",void 0,{params:{id:e,tweet_id:t}})}tweet(e,t={}){return typeof e=="object"?t=e:t={text:e,...t},this.post("tweets",t)}reply(e,t,n={}){var a;let u={in_reply_to_tweet_id:t,...(a=n.reply)!==null&&a!==void 0?a:{}};return this.post("tweets",{text:e,...n,reply:u})}quote(e,t,n={}){return this.tweet(e,{...n,quote_tweet_id:t})}async tweetThread(e){var t,n;let a=[];for(let u of e){let c=a.length?a[a.length-1]:null,f={...typeof u=="string"?{text:u}:u},m=c?c.data.id:(t=f.reply)===null||t===void 0?void 0:t.in_reply_to_tweet_id,b=(n=f.text)!==null&&n!==void 0?n:"";m?a.push(await this.reply(b,m,f)):a.push(await this.tweet(b,f))}return a}deleteTweet(e){return this.delete("tweets/:id",void 0,{params:{id:e}})}async bookmark(e){let t=await this.getCurrentUserV2Object();return this.post("users/:id/bookmarks",{tweet_id:e},{params:{id:t.data.id}})}async deleteBookmark(e){let t=await this.getCurrentUserV2Object();return this.delete("users/:id/bookmarks/:tweet_id",void 0,{params:{id:t.data.id,tweet_id:e}})}follow(e,t){return this.post("users/:id/following",{target_user_id:t},{params:{id:e}})}unfollow(e,t){return this.delete("users/:source_user_id/following/:target_user_id",void 0,{params:{source_user_id:e,target_user_id:t}})}block(e,t){return this.post("users/:id/blocking",{target_user_id:t},{params:{id:e}})}unblock(e,t){return this.delete("users/:source_user_id/blocking/:target_user_id",void 0,{params:{source_user_id:e,target_user_id:t}})}mute(e,t){return this.post("users/:id/muting",{target_user_id:t},{params:{id:e}})}unmute(e,t){return this.delete("users/:source_user_id/muting/:target_user_id",void 0,{params:{source_user_id:e,target_user_id:t}})}createList(e){return this.post("lists",e)}updateList(e,t={}){return this.put("lists/:id",t,{params:{id:e}})}removeList(e){return this.delete("lists/:id",void 0,{params:{id:e}})}addListMember(e,t){return this.post("lists/:id/members",{user_id:t},{params:{id:e}})}removeListMember(e,t){return this.delete("lists/:id/members/:user_id",void 0,{params:{id:e,user_id:t}})}subscribeToList(e,t){return this.post("users/:id/followed_lists",{list_id:t},{params:{id:e}})}unsubscribeOfList(e,t){return this.delete("users/:id/followed_lists/:list_id",void 0,{params:{id:e,list_id:t}})}pinList(e,t){return this.post("users/:id/pinned_lists",{list_id:t},{params:{id:e}})}unpinList(e,t){return this.delete("users/:id/pinned_lists/:list_id",void 0,{params:{id:e,list_id:t}})}sendDmInConversation(e,t){return this.post("dm_conversations/:dm_conversation_id/messages",t,{params:{dm_conversation_id:e}})}sendDmToParticipant(e,t){return this.post("dm_conversations/with/:participant_id/messages",t,{params:{participant_id:e}})}createDmConversation(e){return this.post("dm_conversations",e)}};$r.default=Ia});var ka=g(Lt=>{"use strict";var im=Lt&&Lt.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Lt,"__esModule",{value:!0});Lt.TwitterApiv2Labs=void 0;var am=Te(),om=im(Ea()),as=class extends om.default{constructor(){super(...arguments),this._prefix=am.API_V2_LABS_PREFIX}get readWrite(){return this}};Lt.TwitterApiv2Labs=as;Lt.default=as});var ja=g(Et=>{"use strict";var ac=Et&&Et.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Et,"__esModule",{value:!0});Et.TwitterApiv2=void 0;var um=Te(),lm=ac(Ma()),cm=ac(ka()),os=class extends lm.default{constructor(){super(...arguments),this._prefix=um.API_V2_PREFIX}get readWrite(){return this}get labs(){return this._labs?this._labs:this._labs=new cm.default(this)}};Et.TwitterApiv2=os;Et.default=os});var xa=g(Vr=>{"use strict";var Hr=Vr&&Vr.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Vr,"__esModule",{value:!0});var us=Hr(ls()),dm=Hr(yi()),fm=Hr(Qi()),hm=Hr(Oa()),Fa=_i(),mm=Hr(mi()),Ba=class extends dm.default{get v1(){return this._v1?this._v1:this._v1=new fm.default(this)}get v2(){return this._v2?this._v2:this._v2=new hm.default(this)}async currentUser(e=!1){return await this.getCurrentUserObject(e)}async currentUserV2(e=!1){return await this.getCurrentUserV2Object(e)}search(e,t){return this.v2.search(e,t)}async generateAuthLink(e="oob",{authAccessType:t,linkMode:n="authenticate",forceLogin:a,screenName:u}={}){let c=await this.post("https://api.twitter.com/oauth/request_token",{oauth_callback:e,x_auth_access_type:t}),f=`https://api.twitter.com/oauth/${n}?oauth_token=${encodeURIComponent(c.oauth_token)}`;return a!==void 0&&(f+=`&force_login=${encodeURIComponent(a)}`),u!==void 0&&(f+=`&screen_name=${encodeURIComponent(u)}`),this._requestMaker.hasPlugins()&&this._requestMaker.applyPluginMethod("onOAuth1RequestToken",{client:this._requestMaker,url:f,oauthResult:c}),{url:f,...c}}async login(e){let t=this.getActiveTokens();if(t.type!=="oauth-1.0a")throw new Error("You must setup TwitterApi instance with consumer keys to accept OAuth 1.0 login");let n=await this.post("https://api.twitter.com/oauth/access_token",{oauth_token:t.accessToken,oauth_verifier:e}),a=new us.default({appKey:t.appKey,appSecret:t.appSecret,accessToken:n.oauth_token,accessSecret:n.oauth_token_secret},this._requestMaker.clientSettings);return{accessToken:n.oauth_token,accessSecret:n.oauth_token_secret,userId:n.user_id,screenName:n.screen_name,client:a}}async appLogin(){let e=this.getActiveTokens();if(e.type!=="oauth-1.0a")throw new Error("You must setup TwitterApi instance with consumer keys to accept app-only login");let n=await new us.default({username:e.appKey,password:e.appSecret},this._requestMaker.clientSettings).post("https://api.twitter.com/oauth2/token",{grant_type:"client_credentials"});return new us.default(n.access_token,this._requestMaker.clientSettings)}generateOAuth2AuthLink(e,t={}){var n,a;if(!this._requestMaker.clientId)throw new Error("Twitter API instance is not initialized with client ID. You can find your client ID in Twitter Developer Portal. Please build an instance with: new TwitterApi({ clientId: '<yourClientId>' })");let u=(n=t.state)!==null&&n!==void 0?n:Fa.OAuth2Helper.generateRandomString(32),c=Fa.OAuth2Helper.getCodeVerifier(),f=Fa.OAuth2Helper.getCodeChallengeFromVerifier(c),m=(a=t.scope)!==null&&a!==void 0?a:"",b=Array.isArray(m)?m.join(" "):m,S=new URL("https://twitter.com/i/oauth2/authorize"),R={response_type:"code",client_id:this._requestMaker.clientId,redirect_uri:e,state:u,code_challenge:f,code_challenge_method:"s256",scope:b};mm.default.addQueryParamsToUrl(S,R);let w={url:S.toString(),state:u,codeVerifier:c,codeChallenge:f};return this._requestMaker.hasPlugins()&&this._requestMaker.applyPluginMethod("onOAuth2RequestToken",{client:this._requestMaker,result:w,redirectUri:e}),w}async loginWithOAuth2({code:e,codeVerifier:t,redirectUri:n}){if(!this._requestMaker.clientId)throw new Error("Twitter API instance is not initialized with client ID. Please build an instance with: new TwitterApi({ clientId: '<yourClientId>' })");let a=await this.post("https://api.twitter.com/2/oauth2/token",{code:e,code_verifier:t,redirect_uri:n,grant_type:"authorization_code",client_id:this._requestMaker.clientId,client_secret:this._requestMaker.clientSecret});return this.parseOAuth2AccessTokenResult(a)}async refreshOAuth2Token(e){if(!this._requestMaker.clientId)throw new Error("Twitter API instance is not initialized with client ID. Please build an instance with: new TwitterApi({ clientId: '<yourClientId>' })");let t=await this.post("https://api.twitter.com/2/oauth2/token",{refresh_token:e,grant_type:"refresh_token",client_id:this._requestMaker.clientId,client_secret:this._requestMaker.clientSecret});return this.parseOAuth2AccessTokenResult(t)}async revokeOAuth2Token(e,t="access_token"){if(!this._requestMaker.clientId)throw new Error("Twitter API instance is not initialized with client ID. Please build an instance with: new TwitterApi({ clientId: '<yourClientId>' })");return await this.post("https://api.twitter.com/2/oauth2/revoke",{client_id:this._requestMaker.clientId,client_secret:this._requestMaker.clientSecret,token:e,token_type_hint:t})}parseOAuth2AccessTokenResult(e){let t=new us.default(e.access_token,this._requestMaker.clientSettings),n=e.scope.split(" ").filter(a=>a);return{client:t,expiresIn:e.expires_in,accessToken:e.access_token,scope:n,refreshToken:e.refresh_token}}};Vr.default=Ba});var za=g(Qr=>{"use strict";var Wa=Qr&&Qr.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Qr,"__esModule",{value:!0});var pm=Wa(Xi()),_m=Wa(Ma()),gm=Wa(xa()),Ua=class extends gm.default{get v1(){return this._v1?this._v1:this._v1=new pm.default(this)}get v2(){return this._v2?this._v2:this._v2=new _m.default(this)}get readOnly(){return this}};Qr.default=Ua});var ls=g(De=>{"use strict";var Yr=De&&De.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(De,"__esModule",{value:!0});De.TwitterApiReadOnly=De.TwitterApiReadWrite=De.TwitterApi=void 0;var ym=Yr(Jn()),bm=Yr(ja()),wm=Yr(za()),cs=class extends wm.default{get v1(){return this._v1?this._v1:this._v1=new ym.default(this)}get v2(){return this._v2?this._v2:this._v2=new bm.default(this)}get readWrite(){return this}static getErrors(e){var t;return typeof e!="object"?[]:"data"in e?(t=e.data.errors)!==null&&t!==void 0?t:[]:[]}static getProfileImageInSize(e,t){let n=e.split("/").pop(),a=["normal","bigger","mini"],u=e;for(let f of a)if(n.includes(`_${f}`)){u=e.replace(`_${f}`,"");break}if(t==="original")return u;let c=u.lastIndexOf(".");if(c!==-1){let f=u.slice(c+1);return u.slice(0,c)+"_"+t+"."+f}else return u+"_"+t}};De.TwitterApi=cs;var Sm=za();Object.defineProperty(De,"TwitterApiReadWrite",{enumerable:!0,get:function(){return Yr(Sm).default}});var vm=xa();Object.defineProperty(De,"TwitterApiReadOnly",{enumerable:!0,get:function(){return Yr(vm).default}});De.default=cs});var Na=g(z=>{"use strict";var Tm=z&&z.__createBinding||(Object.create?function(s,e,t,n){n===void 0&&(n=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,n,a)}:function(s,e,t,n){n===void 0&&(n=t),s[n]=e[t]}),Ge=z&&z.__exportStar||function(s,e){for(var t in s)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Tm(e,s,t)},Rm=z&&z.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(z,"__esModule",{value:!0});z.default=void 0;var Pm=ls();Object.defineProperty(z,"default",{enumerable:!0,get:function(){return Rm(Pm).default}});Ge(ls(),z);Ge(Jn(),z);Ge(ja(),z);Ge(Gi(),z);Ge(ka(),z);Ge(Ie(),z);Ge(Sa(),z);Ge(Nn(),z);Ge(Wn(),z)});var jm={};Zd(jm,{default:()=>vc});module.exports=ef(jm);var cf=require("@raycast/api");var Rr=require("@raycast/api");var Mu=Le(require("http"),1),ku=Le(require("https"),1),bt=Le(require("zlib"),1),ie=Le(require("stream"),1),ju=Le(mu(),1);var ce=Le(require("stream"),1),Xs=require("util");var zm=Le(gu(),1),yu=65536;async function*Hs(s,e=!0){for(let t of s)if("stream"in t)yield*t.stream();else if(ArrayBuffer.isView(t))if(e){let n=t.byteOffset,a=t.byteOffset+t.byteLength;for(;n!==a;){let u=Math.min(a-n,yu),c=t.buffer.slice(n,n+u);n+=c.byteLength,yield new Uint8Array(c)}}else yield t;else{let n=0;for(;n!==t.size;){let u=await t.slice(n,Math.min(t.size,n+yu)).arrayBuffer();n+=u.byteLength,yield new Uint8Array(u)}}}var bu=class Qs{#e=[];#r="";#t=0;constructor(e=[],t={}){let n=0,a=e.map(c=>{let f;return ArrayBuffer.isView(c)?f=new Uint8Array(c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)):c instanceof ArrayBuffer?f=new Uint8Array(c.slice(0)):c instanceof Qs?f=c:f=new TextEncoder().encode(c),n+=ArrayBuffer.isView(f)?f.byteLength:f.size,f}),u=t.type===void 0?"":String(t.type);this.#r=/[^\u0020-\u007E]/.test(u)?"":u,this.#t=n,this.#e=a}get size(){return this.#t}get type(){return this.#r}async text(){let e=new TextDecoder,t="";for await(let n of Hs(this.#e,!1))t+=e.decode(n,{stream:!0});return t+=e.decode(),t}async arrayBuffer(){let e=new Uint8Array(this.size),t=0;for await(let n of Hs(this.#e,!1))e.set(n,t),t+=n.length;return e.buffer}stream(){let e=Hs(this.#e,!0);return new ReadableStream({type:"bytes",async pull(t){let n=await e.next();n.done?t.close():t.enqueue(n.value)}})}slice(e=0,t=this.size,n=""){let{size:a}=this,u=e<0?Math.max(a+e,0):Math.min(e,a),c=t<0?Math.max(a+t,0):Math.min(t,a),f=Math.max(c-u,0),m=this.#e,b=[],S=0;for(let w of m){if(S>=f)break;let _=ArrayBuffer.isView(w)?w.byteLength:w.size;if(u&&_<=u)u-=_,c-=_;else{let A;ArrayBuffer.isView(w)?(A=w.subarray(u,Math.min(_,c)),S+=A.byteLength):(A=w.slice(u,Math.min(_,c)),S+=A.size),b.push(A),u=0}}let R=new Qs([],{type:String(n).toLowerCase()});return R.#t=f,R.#e=b,R}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](e){return e&&typeof e=="object"&&typeof e.constructor=="function"&&(typeof e.stream=="function"||typeof e.arrayBuffer=="function")&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}};Object.defineProperties(bu.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});var rf=bu,wu=rf;var Ve=class extends Error{constructor(e,t){super(e),Error.captureStackTrace(this,this.constructor),this.type=t}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var ne=class extends Ve{constructor(e,t,n){super(e,t),n&&(this.code=this.errno=n.code,this.erroredSysCall=n.syscall)}};var vu=require("crypto");var Sr=Symbol.toStringTag,Ys=s=>typeof s=="object"&&typeof s.append=="function"&&typeof s.delete=="function"&&typeof s.get=="function"&&typeof s.getAll=="function"&&typeof s.has=="function"&&typeof s.set=="function"&&typeof s.sort=="function"&&s[Sr]==="URLSearchParams",Ee=s=>typeof s=="object"&&typeof s.arrayBuffer=="function"&&typeof s.type=="string"&&typeof s.stream=="function"&&typeof s.constructor=="function"&&/^(Blob|File)$/.test(s[Sr]);function Cn(s){return typeof s=="object"&&typeof s.append=="function"&&typeof s.set=="function"&&typeof s.get=="function"&&typeof s.getAll=="function"&&typeof s.delete=="function"&&typeof s.keys=="function"&&typeof s.values=="function"&&typeof s.entries=="function"&&typeof s.constructor=="function"&&s[Sr]==="FormData"}var Su=s=>typeof s=="object"&&(s[Sr]==="AbortSignal"||s[Sr]==="EventTarget");var Wt=`\r
`,Ks="-".repeat(2),nf=Buffer.byteLength(Wt),Tu=s=>`${Ks}${s}${Ks}${Wt.repeat(2)}`;function Ru(s,e,t){let n="";return n+=`${Ks}${s}${Wt}`,n+=`Content-Disposition: form-data; name="${e}"`,Ee(t)&&(n+=`; filename="${t.name}"${Wt}`,n+=`Content-Type: ${t.type||"application/octet-stream"}`),`${n}${Wt.repeat(2)}`}var Pu=()=>(0,vu.randomBytes)(8).toString("hex");async function*qu(s,e){for(let[t,n]of s)yield Ru(e,t,n),Ee(n)?yield*n.stream():yield n,yield Wt;yield Tu(e)}function Du(s,e){let t=0;for(let[n,a]of s)t+=Buffer.byteLength(Ru(e,n,a)),t+=Ee(a)?a.size:Buffer.byteLength(String(a)),t+=nf;return t+=Buffer.byteLength(Tu(e)),t}var se=Symbol("Body internals"),ot=class{constructor(e,{size:t=0}={}){let n=null;e===null?e=null:Ys(e)?e=Buffer.from(e.toString()):Ee(e)||Buffer.isBuffer(e)||(Xs.types.isAnyArrayBuffer(e)?e=Buffer.from(e):ArrayBuffer.isView(e)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof ce.default||(Cn(e)?(n=`NodeFetchFormDataBoundary${Pu()}`,e=ce.default.Readable.from(qu(e,n))):e=Buffer.from(String(e)))),this[se]={body:e,boundary:n,disturbed:!1,error:null},this.size=t,e instanceof ce.default&&e.on("error",a=>{let u=a instanceof Ve?a:new ne(`Invalid response body while trying to fetch ${this.url}: ${a.message}`,"system",a);this[se].error=u})}get body(){return this[se].body}get bodyUsed(){return this[se].disturbed}async arrayBuffer(){let{buffer:e,byteOffset:t,byteLength:n}=await On(this);return e.slice(t,t+n)}async blob(){let e=this.headers&&this.headers.get("content-type")||this[se].body&&this[se].body.type||"",t=await this.buffer();return new wu([t],{type:e})}async json(){let e=await On(this);return JSON.parse(e.toString())}async text(){return(await On(this)).toString()}buffer(){return On(this)}};Object.defineProperties(ot.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}});async function On(s){if(s[se].disturbed)throw new TypeError(`body used already for: ${s.url}`);if(s[se].disturbed=!0,s[se].error)throw s[se].error;let{body:e}=s;if(e===null)return Buffer.alloc(0);if(Ee(e)&&(e=ce.default.Readable.from(e.stream())),Buffer.isBuffer(e))return e;if(!(e instanceof ce.default))return Buffer.alloc(0);let t=[],n=0;try{for await(let a of e){if(s.size>0&&n+a.length>s.size){let u=new ne(`content size at ${s.url} over limit: ${s.size}`,"max-size");throw e.destroy(u),u}n+=a.length,t.push(a)}}catch(a){throw a instanceof Ve?a:new ne(`Invalid response body while trying to fetch ${s.url}: ${a.message}`,"system",a)}if(e.readableEnded===!0||e._readableState.ended===!0)try{return t.every(a=>typeof a=="string")?Buffer.from(t.join("")):Buffer.concat(t,n)}catch(a){throw new ne(`Could not create Buffer from response body for ${s.url}: ${a.message}`,"system",a)}else throw new ne(`Premature close of server response while trying to fetch ${s.url}`)}var Ln=(s,e)=>{let t,n,{body:a}=s;if(s.bodyUsed)throw new Error("cannot clone body after it is used");return a instanceof ce.default&&typeof a.getBoundary!="function"&&(t=new ce.PassThrough({highWaterMark:e}),n=new ce.PassThrough({highWaterMark:e}),a.pipe(t),a.pipe(n),s[se].body=t,a=n),a},En=(s,e)=>s===null?null:typeof s=="string"?"text/plain;charset=UTF-8":Ys(s)?"application/x-www-form-urlencoded;charset=UTF-8":Ee(s)?s.type||null:Buffer.isBuffer(s)||Xs.types.isAnyArrayBuffer(s)||ArrayBuffer.isView(s)?null:s&&typeof s.getBoundary=="function"?`multipart/form-data;boundary=${s.getBoundary()}`:Cn(s)?`multipart/form-data; boundary=${e[se].boundary}`:s instanceof ce.default?null:"text/plain;charset=UTF-8",Au=s=>{let{body:e}=s;return e===null?0:Ee(e)?e.size:Buffer.isBuffer(e)?e.length:e&&typeof e.getLengthSync=="function"?e.hasKnownLength&&e.hasKnownLength()?e.getLengthSync():null:Cn(e)?Du(s[se].boundary):null},Cu=(s,{body:e})=>{e===null?s.end():Ee(e)?ce.default.Readable.from(e.stream()).pipe(s):Buffer.isBuffer(e)?(s.write(e),s.end()):e.pipe(s)};var Gs=require("util"),vr=Le(require("http"),1),In=typeof vr.default.validateHeaderName=="function"?vr.default.validateHeaderName:s=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(s)){let e=new TypeError(`Header name must be a valid HTTP token [${s}]`);throw Object.defineProperty(e,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),e}},Js=typeof vr.default.validateHeaderValue=="function"?vr.default.validateHeaderValue:(s,e)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(e)){let t=new TypeError(`Invalid character in header content ["${s}"]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_CHAR"}),t}},J=class extends URLSearchParams{constructor(e){let t=[];if(e instanceof J){let n=e.raw();for(let[a,u]of Object.entries(n))t.push(...u.map(c=>[a,c]))}else if(e!=null)if(typeof e=="object"&&!Gs.types.isBoxedPrimitive(e)){let n=e[Symbol.iterator];if(n==null)t.push(...Object.entries(e));else{if(typeof n!="function")throw new TypeError("Header pairs must be iterable");t=[...e].map(a=>{if(typeof a!="object"||Gs.types.isBoxedPrimitive(a))throw new TypeError("Each header pair must be an iterable object");return[...a]}).map(a=>{if(a.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...a]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");return t=t.length>0?t.map(([n,a])=>(In(n),Js(n,String(a)),[String(n).toLowerCase(),String(a)])):void 0,super(t),new Proxy(this,{get(n,a,u){switch(a){case"append":case"set":return(c,f)=>(In(c),Js(c,String(f)),URLSearchParams.prototype[a].call(n,String(c).toLowerCase(),String(f)));case"delete":case"has":case"getAll":return c=>(In(c),URLSearchParams.prototype[a].call(n,String(c).toLowerCase()));case"keys":return()=>(n.sort(),new Set(URLSearchParams.prototype.keys.call(n)).keys());default:return Reflect.get(n,a,u)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(e){let t=this.getAll(e);if(t.length===0)return null;let n=t.join(", ");return/^content-encoding$/i.test(e)&&(n=n.toLowerCase()),n}forEach(e,t=void 0){for(let n of this.keys())Reflect.apply(e,t,[this.get(n),n,this])}*values(){for(let e of this.keys())yield this.get(e)}*entries(){for(let e of this.keys())yield[e,this.get(e)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((e,t)=>(e[t]=this.getAll(t),e),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((e,t)=>{let n=this.getAll(t);return t==="host"?e[t]=n[0]:e[t]=n.length>1?n:n[0],e},{})}};Object.defineProperties(J.prototype,["get","entries","forEach","values"].reduce((s,e)=>(s[e]={enumerable:!0},s),{}));function Ou(s=[]){return new J(s.reduce((e,t,n,a)=>(n%2===0&&e.push(a.slice(n,n+2)),e),[]).filter(([e,t])=>{try{return In(e),Js(e,String(t)),!0}catch{return!1}}))}var sf=new Set([301,302,303,307,308]),Mn=s=>sf.has(s);var ve=Symbol("Response internals"),H=class extends ot{constructor(e=null,t={}){super(e,t);let n=t.status!=null?t.status:200,a=new J(t.headers);if(e!==null&&!a.has("Content-Type")){let u=En(e);u&&a.append("Content-Type",u)}this[ve]={type:"default",url:t.url,status:n,statusText:t.statusText||"",headers:a,counter:t.counter,highWaterMark:t.highWaterMark}}get type(){return this[ve].type}get url(){return this[ve].url||""}get status(){return this[ve].status}get ok(){return this[ve].status>=200&&this[ve].status<300}get redirected(){return this[ve].counter>0}get statusText(){return this[ve].statusText}get headers(){return this[ve].headers}get highWaterMark(){return this[ve].highWaterMark}clone(){return new H(Ln(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size})}static redirect(e,t=302){if(!Mn(t))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new H(null,{headers:{location:new URL(e).toString()},status:t})}static error(){let e=new H(null,{status:0,statusText:""});return e[ve].type="error",e}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(H.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var Eu=require("url");var Lu=s=>{if(s.search)return s.search;let e=s.href.length-1,t=s.hash||(s.href[e]==="#"?"#":"");return s.href[e-t.length]==="?"?"?":""};var He=Symbol("Request internals"),kn=s=>typeof s=="object"&&typeof s[He]=="object",Qe=class extends ot{constructor(e,t={}){let n;kn(e)?n=new URL(e.url):(n=new URL(e),e={});let a=t.method||e.method||"GET";if(a=a.toUpperCase(),(t.body!=null||kn(e))&&e.body!==null&&(a==="GET"||a==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let u=t.body?t.body:kn(e)&&e.body!==null?Ln(e):null;super(u,{size:t.size||e.size||0});let c=new J(t.headers||e.headers||{});if(u!==null&&!c.has("Content-Type")){let m=En(u,this);m&&c.append("Content-Type",m)}let f=kn(e)?e.signal:null;if("signal"in t&&(f=t.signal),f!=null&&!Su(f))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");this[He]={method:a,redirect:t.redirect||e.redirect||"follow",headers:c,parsedURL:n,signal:f},this.follow=t.follow===void 0?e.follow===void 0?20:e.follow:t.follow,this.compress=t.compress===void 0?e.compress===void 0?!0:e.compress:t.compress,this.counter=t.counter||e.counter||0,this.agent=t.agent||e.agent,this.highWaterMark=t.highWaterMark||e.highWaterMark||16384,this.insecureHTTPParser=t.insecureHTTPParser||e.insecureHTTPParser||!1}get method(){return this[He].method}get url(){return(0,Eu.format)(this[He].parsedURL)}get headers(){return this[He].headers}get redirect(){return this[He].redirect}get signal(){return this[He].signal}clone(){return new Qe(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(Qe.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}});var Iu=s=>{let{parsedURL:e}=s[He],t=new J(s[He].headers);t.has("Accept")||t.set("Accept","*/*");let n=null;if(s.body===null&&/^(post|put)$/i.test(s.method)&&(n="0"),s.body!==null){let f=Au(s);typeof f=="number"&&!Number.isNaN(f)&&(n=String(f))}n&&t.set("Content-Length",n),t.has("User-Agent")||t.set("User-Agent","node-fetch"),s.compress&&!t.has("Accept-Encoding")&&t.set("Accept-Encoding","gzip,deflate,br");let{agent:a}=s;typeof a=="function"&&(a=a(e)),!t.has("Connection")&&!a&&t.set("Connection","close");let u=Lu(e);return{path:e.pathname+u,pathname:e.pathname,hostname:e.hostname,protocol:e.protocol,port:e.port,hash:e.hash,search:e.search,query:e.query,href:e.href,method:s.method,headers:t[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:s.insecureHTTPParser,agent:a}};var jn=class extends Ve{constructor(e,t="aborted"){super(e,t)}};var af=new Set(["data:","http:","https:"]);async function Tr(s,e){return new Promise((t,n)=>{let a=new Qe(s,e),u=Iu(a);if(!af.has(u.protocol))throw new TypeError(`node-fetch cannot load ${s}. URL scheme "${u.protocol.replace(/:$/,"")}" is not supported.`);if(u.protocol==="data:"){let _=(0,ju.default)(a.url),A=new H(_,{headers:{"Content-Type":_.typeFull}});t(A);return}let c=(u.protocol==="https:"?ku.default:Mu.default).request,{signal:f}=a,m=null,b=()=>{let _=new jn("The operation was aborted.");n(_),a.body&&a.body instanceof ie.default.Readable&&a.body.destroy(_),!(!m||!m.body)&&m.body.emit("error",_)};if(f&&f.aborted){b();return}let S=()=>{b(),w()},R=c(u);f&&f.addEventListener("abort",S);let w=()=>{R.abort(),f&&f.removeEventListener("abort",S)};R.on("error",_=>{n(new ne(`request to ${a.url} failed, reason: ${_.message}`,"system",_)),w()}),of(R,_=>{m.body.destroy(_)}),process.version<"v14"&&R.on("socket",_=>{let A;_.prependListener("end",()=>{A=_._eventsCount}),_.prependListener("close",O=>{if(m&&A<_._eventsCount&&!O){let le=new Error("Premature close");le.code="ERR_STREAM_PREMATURE_CLOSE",m.body.emit("error",le)}})}),R.on("response",_=>{R.setTimeout(0);let A=Ou(_.rawHeaders);if(Mn(_.statusCode)){let Ue=A.get("Location"),_e=Ue===null?null:new URL(Ue,a.url);switch(a.redirect){case"error":n(new ne(`uri requested responds with a redirect, redirect mode is set to error: ${a.url}`,"no-redirect")),w();return;case"manual":_e!==null&&A.set("Location",_e);break;case"follow":{if(_e===null)break;if(a.counter>=a.follow){n(new ne(`maximum redirect reached at: ${a.url}`,"max-redirect")),w();return}let We={headers:new J(a.headers),follow:a.follow,counter:a.counter+1,agent:a.agent,compress:a.compress,method:a.method,body:a.body,signal:a.signal,size:a.size};if(_.statusCode!==303&&a.body&&e.body instanceof ie.default.Readable){n(new ne("Cannot follow redirect with body being a readable stream","unsupported-redirect")),w();return}(_.statusCode===303||(_.statusCode===301||_.statusCode===302)&&a.method==="POST")&&(We.method="GET",We.body=void 0,We.headers.delete("content-length")),t(Tr(new Qe(_e,We))),w();return}default:return n(new TypeError(`Redirect option '${a.redirect}' is not a valid value of RequestRedirect`))}}f&&_.once("end",()=>{f.removeEventListener("abort",S)});let O=(0,ie.pipeline)(_,new ie.PassThrough,n);process.version<"v12.10"&&_.on("aborted",S);let le={url:a.url,status:_.statusCode,statusText:_.statusMessage,headers:A,size:a.size,counter:a.counter,highWaterMark:a.highWaterMark},Ae=A.get("Content-Encoding");if(!a.compress||a.method==="HEAD"||Ae===null||_.statusCode===204||_.statusCode===304){m=new H(O,le),t(m);return}let xe={flush:bt.default.Z_SYNC_FLUSH,finishFlush:bt.default.Z_SYNC_FLUSH};if(Ae==="gzip"||Ae==="x-gzip"){O=(0,ie.pipeline)(O,bt.default.createGunzip(xe),n),m=new H(O,le),t(m);return}if(Ae==="deflate"||Ae==="x-deflate"){(0,ie.pipeline)(_,new ie.PassThrough,n).once("data",_e=>{O=(_e[0]&15)===8?(0,ie.pipeline)(O,bt.default.createInflate(),n):(0,ie.pipeline)(O,bt.default.createInflateRaw(),n),m=new H(O,le),t(m)});return}if(Ae==="br"){O=(0,ie.pipeline)(O,bt.default.createBrotliDecompress(),n),m=new H(O,le),t(m);return}m=new H(O,le),t(m)}),Cu(R,a)})}function of(s,e){let t=Buffer.from(`0\r
\r
`),n=!1,a=!1,u;s.on("response",c=>{let{headers:f}=c;n=f["transfer-encoding"]==="chunked"&&!f["content-length"]}),s.on("socket",c=>{let f=()=>{if(n&&!a){let m=new Error("Premature close");m.code="ERR_STREAM_PREMATURE_CLOSE",e(m)}};c.prependListener("close",f),s.on("abort",()=>{c.removeListener("close",f)}),c.on("data",m=>{a=Buffer.compare(m.slice(-5),t)===0,!a&&u&&(a=Buffer.compare(u.slice(-3),t.slice(0,3))===0&&Buffer.compare(m.slice(-2),t.slice(3))===0),u=m})})}function zt(){return{source:{light:"logo.png",dark:"logo@dark.png"}}}function Pr(){return(0,Rr.getPreferenceValues)().clientid||""}var Nt=new Rr.OAuth.PKCEClient({redirectMethod:Rr.OAuth.RedirectMethod.Web,providerName:"Twitter",providerIcon:zt(),providerId:"twitter",description:"Connect your X account"});async function Fu(){let s=await Nt.getTokens();if(s?.accessToken){s.refreshToken&&s.isExpired()&&await Nt.setTokens(await lf(s.refreshToken));return}let e=await Nt.authorizationRequest({endpoint:"https://twitter.com/i/oauth2/authorize",clientId:Pr(),scope:"tweet.read tweet.write users.read follows.read like.read like.write offline.access"}),{authorizationCode:t}=await Nt.authorize(e);await Nt.setTokens(await uf(e,t))}async function uf(s,e){let t=new URLSearchParams;t.append("client_id",Pr()),t.append("code",e),t.append("code_verifier",s.codeVerifier),t.append("grant_type","authorization_code"),t.append("redirect_uri",s.redirectURI);let n=await Tr("https://api.twitter.com/2/oauth2/token",{method:"POST",body:t});if(!n.ok)throw console.error("fetch tokens error:",await n.text()),new Error(n.statusText);return await n.json()}async function Bu(){return await Nt.getTokens()}async function lf(s){let e=new URLSearchParams;e.append("client_id",Pr()),e.append("refresh_token",s),e.append("grant_type","refresh_token");let t=await Tr("https://api.twitter.com/2/oauth2/token",{method:"POST",body:e});if(!t.ok)throw console.error("refresh tokens error:",await t.text()),new Error(t.statusText);let n=await t.json();return n.refresh_token=n.refresh_token??s,n}function xu(){return!0}function Fn(){let s=Pr();return!s||s===""||s==="-"}var q=require("@raycast/api"),ds=require("react");var oc=require("@raycast/api"),uc=require("react"),lc=Le(Na());function nr(s){return s instanceof Error?s.message:"unknown error"}var V_=new Intl.NumberFormat("en",{notation:"compact"});function qm(){let s=(0,oc.getPreferenceValues)(),e=s.appkey||"",t=s.appsecret||"",n=s.accesstoken||"",a=s.accesssecret||"";return new lc.TwitterApi({appKey:e,appSecret:t,accessToken:n,accessSecret:a})}var $a=null;function Va(){return $a||($a=qm()),$a}var Y=require("react/jsx-runtime");function Dm(s){let e=s.text,t=cc(e);return(0,Y.jsx)(q.Form.Description,{text:`${e.length}/280 ${t?"\u2705":"\u274C"}`})}function Am(s){let e=s.index,t=s.content,n=e===0?"What's happening?":"Another Tweet";return(0,Y.jsxs)(ds.Fragment,{children:[(0,Y.jsx)(q.Form.TextArea,{id:`${e}`,title:`Tweet ${e>0?e+1:""}`,placeholder:n,value:t.text,onChange:a=>s.onTextChange(a,e)}),(0,Y.jsx)(Dm,{text:t.text})]})}function cc(s){let e=s.length;return!(e<1||e>280)}function Cm(s){return cc(s.text)}function dc(s){if(s.length<1)return!1;for(let e of s)if(!Cm(e))return!1;return!0}async function Om(s){try{if(!dc(s)){await(0,q.showToast)({style:q.Toast.Style.Failure,title:"Invalid Tweet",message:"Tweets are not valid"});return}if(s.length===1){let e=s[0];await Va().v1.tweet(e.text),await(0,q.showToast)({style:q.Toast.Style.Success,title:"Tweet created",message:"Tweet creation successful"}),(0,q.popToRoot)()}else{let e=s.map(t=>t.text);await Va().v1.tweetThread(e),await(0,q.showToast)({style:q.Toast.Style.Success,title:"Thread created",message:"Thread creation successful"}),(0,q.popToRoot)()}}catch(e){await(0,q.showToast)({style:q.Toast.Style.Failure,title:"Error",message:nr(e)})}}function fc(){let[s,e]=(0,ds.useState)([{text:""}]),t=()=>{let f=[...s,{text:""}];e(f)},n=s&&s.length>1?"Send Thread":"Send Tweet",a=async()=>{if(s.length>1){let f=s[s.length-1],m=!0;if(f.text.length>0&&(m=await(0,q.confirmAlert)({title:"Really remove last Tweet?",message:"You last tweet contain content, it will get lost",icon:"\u26A0\uFE0F"})),m){let b=[...s];b.pop(),e(b)}}},u=(f,m)=>{let b=[...s];b[m].text=f,e(b)},c=()=>{let f=[...s];for(let m=0;m<f.length;m++)f[m].text+=` ${m+1}/${f.length}`;e(f)};return(0,Y.jsx)(q.Form,{actions:(0,Y.jsxs)(q.ActionPanel,{children:[(0,Y.jsx)(q.ActionPanel.Section,{children:dc(s)&&(0,Y.jsx)(q.Action.SubmitForm,{title:n,icon:zt(),onSubmit:()=>Om(s)})}),(0,Y.jsxs)(q.ActionPanel.Section,{title:"Thread",children:[(0,Y.jsx)(q.Action,{title:"Add Tweet",onAction:t,icon:{source:q.Icon.Plus,tintColor:q.Color.PrimaryText},shortcut:{modifiers:["cmd"],key:"+"}}),s.length>1&&(0,Y.jsx)(q.Action,{title:"Remove Last Tweet",onAction:a,icon:{source:q.Icon.Trash,tintColor:q.Color.Red},shortcut:{modifiers:["cmd"],key:"-"}}),s.length>1&&(0,Y.jsx)(q.Action,{title:"Add Tweet Numbers",onAction:c,icon:q.Icon.Document,shortcut:{modifiers:["cmd"],key:"n"}})]})]}),children:s.map((f,m)=>(0,Y.jsx)(Am,{index:m,content:f,onTextChange:u},m))})}var P=require("@raycast/api"),fs=require("react");var yc=require("react"),sr=Le(Na());var hc=20,mc=["public_metrics","author_id","attachments","created_at","id","entities","conversation_id"],pc=["attachments.media_keys","author_id","in_reply_to_user_id","entities.mentions.username","referenced_tweets.id"],_c=["url","type","media_key","preview_image_url"];function gc(s){return{id:s.id,name:s.name,username:s.username,profile_image_url:s.profile_image_url}}var Ha=class{constructor(){this.userCache={}}async getAPI(){await Fu();let t=(await Bu())?.accessToken;return new sr.TwitterApi(t||"")}async getUserAccount(e){if(e in this.userCache)return this.userCache[e];let n=await(await this.getAPI()).v2.user(e,{"user.fields":["profile_image_url"]}),a=gc(n.data);return this.userCache[e]=a,a}async prefetchUserAccounts(e){let t=[];for(let n of e)n.author_id&&!(n.author_id in this.userCache)&&t.push(n.author_id);if(t.length>0){let a=await(await this.getAPI()).v2.users(t,{"user.fields":["profile_image_url"]});for(let u of a.data){let c=gc(u);this.userCache[c.id]=c}}}async me(){if(this.meCache)return this.meCache;let t=await(await this.getAPI()).v2.me(),n={id:t.data.id,name:t.data.name,username:t.data.username,profile_image_url:t.data.profile_image_url};return this.meCache=n,n}async getMyTweets(){let t=await(await this.getAPI()).v2.me();return await this.getTweetsFromAuthor(t.data.id,["non_public_metrics","organic_metrics"])}async getTweetsFromAuthor(e,t){let n=await this.getAPI(),a=[...mc];t&&a.push(...t);let u=await n.v2.userTimeline(e,{max_results:hc,"tweet.fields":a,"media.fields":_c,expansions:pc}),c=new sr.TwitterV2IncludesHelper(u),f=[];await this.prefetchUserAccounts(u);for(let m of u)f.push(await this.tweetV2ToTweet(m,c));return f}async tweetV2ToTweet(e,t){let n=e,a=t.medias(n),u;n.non_public_metrics&&(u={impression_count:n.non_public_metrics.impression_count,url_link_clicks:n.non_public_metrics.url_link_clicks});let c;n.organic_metrics&&(c={impression_count:n.organic_metrics.impression_count,url_link_clicks:n.organic_metrics.url_link_clicks,user_profile_clicks:n.organic_metrics.user_profile_clicks,retweet_count:n.organic_metrics.retweet_count,reply_count:n.organic_metrics.reply_count,like_count:n.organic_metrics.like_count});let f;if(a&&a.length>0){let b=a[0];b.type==="animated_gif"||b.type==="video"?f=b.preview_image_url:f=b.url}if(!n.author_id)throw Error("No author ID");return{id:n.id,text:n.text,created_at:n.created_at,conversation_id:n.conversation_id,source:n.source||"",image_url:f,user:await this.getUserAccount(n.author_id),quote_count:n.public_metrics?.quote_count||0,reply_count:n.public_metrics?.reply_count||0,retweet_count:n.public_metrics?.retweet_count||0,like_count:n.public_metrics?.like_count||0,non_public_metrics:u,organic_metrics:c}}async refreshTweets(e){if(e===void 0)return;let t=()=>e.length===e.filter(S=>S.non_public_metrics!==void 0).length,n=()=>e.length===e.filter(S=>S.organic_metrics!==void 0).length,a=await this.getAPI(),u=e.map(S=>S.id),c=[...mc];t()&&c.push("non_public_metrics"),n()&&c.push("organic_metrics");let f=await a.v2.tweets(u,{"tweet.fields":c,"media.fields":_c,expansions:pc}),m=new sr.TwitterV2IncludesHelper(f);return await Promise.all(f.data.map(async S=>await this.tweetV2ToTweet(S,m)))}async sendTweet(e){await(await this.getAPI()).v2.tweet(e)}async sendThread(e){await(await this.getAPI()).v2.tweetThread(e)}async replyTweetID(e,t){await(await this.getAPI()).v2.reply(e,t)}async replyTweet(e,t){await this.replyTweetID(e,t.id)}async retweet(e){let t=await this.getAPI(),n=await this.me();await t.v2.retweet(n.id,e.id)}async deleteTweetID(e){await(await this.getAPI()).v2.deleteTweet(e)}async deleteTweet(e){await this.deleteTweetID(e.id)}async likeTweet(e){let t=await this.getAPI(),n=await this.me();t.v2.like(n.id,e.id)}async unlikeTweet(e){let t=await this.getAPI(),n=await this.me();t.v2.unlike(n.id,e.id)}async homeTimeline(){let t=await(await this.getAPI()).v2.homeTimeline({exclude:"replies",max_results:hc,"tweet.fields":["public_metrics","author_id","attachments","created_at","id","entities","conversation_id"],"media.fields":["url","type","media_key","preview_image_url"],expansions:["attachments.media_keys","author_id","in_reply_to_user_id","entities.mentions.username","referenced_tweets.id"]}),n=new sr.TwitterV2IncludesHelper(t),a=[];await this.prefetchUserAccounts(t);for(let u of t){let c=n.medias(u),f;if(c&&c.length>0){let b=c[0];b.type==="animated_gif"||b.type==="video"?f=b.preview_image_url:f=b.url}if(!u.author_id)continue;let m={id:u.id,text:u.text,created_at:u.created_at,conversation_id:u.conversation_id,source:u.source||"",image_url:f,user:await this.getUserAccount(u.author_id),quote_count:u.public_metrics?.quote_count||0,reply_count:u.public_metrics?.reply_count||0,retweet_count:u.public_metrics?.retweet_count||0,like_count:u.public_metrics?.like_count||0};a.push(m)}return a}};function Lm(){return new Ha}var Qa=Lm();var K=require("react/jsx-runtime");function Em(s){let e=s.text,t=bc(e);return(0,K.jsx)(P.Form.Description,{text:`${e.length}/280 ${t?"\u2705":"\u274C"}`})}function Im(s){let e=s.index,t=s.content,n=e===0?"What's happening?":"Another Tweet";return(0,K.jsxs)(fs.Fragment,{children:[(0,K.jsx)(P.Form.TextArea,{id:`${e}`,title:`Tweet ${e>0?e+1:""}`,placeholder:n,value:t.text,onChange:a=>s.onTextChange(a,e)}),(0,K.jsx)(Em,{text:t.text})]})}function bc(s){let e=s.length;return!(e<1||e>280)}function Mm(s){return bc(s.text)}function wc(s){if(s.length<1)return!1;for(let e of s)if(!Mm(e))return!1;return!0}async function km(s){try{if(!wc(s)){await(0,P.showToast)({style:P.Toast.Style.Failure,title:"Invalid Tweet",message:"Tweets are not valid"});return}if(s.length===1){let e=s[0];if(Fn()){let t=new URL("https://twitter.com/intent/tweet");t.searchParams.append("text",e.text),(0,P.open)(t.href)}else await Qa.sendTweet(e.text),await(0,P.showToast)({style:P.Toast.Style.Success,title:"Tweet created",message:"Tweet creation successful"});(0,P.popToRoot)()}else{if(Fn())throw new Error("This Operation requires a an OAuth client");let e=s.map(t=>t.text);await Qa.sendThread(e),await(0,P.showToast)({style:P.Toast.Style.Success,title:"Thread created",message:"Thread creation successful"}),(0,P.popToRoot)()}}catch(e){await(0,P.showToast)({style:P.Toast.Style.Failure,title:"Error",message:nr(e)})}}function Sc({defaultValue:s}){let[e,t]=(0,fs.useState)([{text:s||""}]),n=()=>{let m=[...e,{text:""}];t(m)},a=e&&e.length>1?"Send Thread":"Send Tweet",u=async()=>{if(e.length>1){let m=e[e.length-1],b=!0;if(m.text.length>0&&(b=await(0,P.confirmAlert)({title:"Really remove last Tweet?",message:"You last tweet contain content, it will get lost",icon:"\u26A0\uFE0F"})),b){let S=[...e];S.pop(),t(S)}}},c=(m,b)=>{let S=[...e];S[b].text=m,t(S)},f=()=>{let m=[...e];for(let b=0;b<m.length;b++)m[b].text+=` ${b+1}/${m.length}`;t(m)};return(0,K.jsx)(P.Form,{actions:(0,K.jsxs)(P.ActionPanel,{children:[(0,K.jsx)(P.ActionPanel.Section,{children:wc(e)&&(0,K.jsx)(P.Action.SubmitForm,{title:a,icon:zt(),onSubmit:()=>km(e)})}),!Fn()&&(0,K.jsxs)(P.ActionPanel.Section,{title:"Thread",children:[(0,K.jsx)(P.Action,{title:"Add Tweet",onAction:n,icon:{source:P.Icon.Plus,tintColor:P.Color.PrimaryText},shortcut:{modifiers:["cmd"],key:"+"}}),e.length>1&&(0,K.jsx)(P.Action,{title:"Remove Last Tweet",onAction:u,icon:{source:P.Icon.Trash,tintColor:P.Color.Red},shortcut:{modifiers:["cmd"],key:"-"}}),e.length>1&&(0,K.jsx)(P.Action,{title:"Add Tweet Numbers",onAction:f,icon:P.Icon.Document,shortcut:{modifiers:["cmd"],key:"n"}})]})]}),children:e.map((m,b)=>(0,K.jsx)(Im,{index:b,content:m,onTextChange:c},b))})}var Ya=require("react/jsx-runtime");function vc({launchContext:s}){return xu()?(0,Ya.jsx)(Sc,{defaultValue:s?.defaultValue}):(0,Ya.jsx)(fc,{})}
