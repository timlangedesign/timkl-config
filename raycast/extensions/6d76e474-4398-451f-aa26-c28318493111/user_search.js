"use strict";var sa=Object.create;var pt=Object.defineProperty;var ia=Object.getOwnPropertyDescriptor;var na=Object.getOwnPropertyNames;var aa=Object.getPrototypeOf,oa=Object.prototype.hasOwnProperty;var u=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports),ua=(s,e)=>{for(var t in e)pt(s,t,{get:e[t],enumerable:!0})},si=(s,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of na(e))!oa.call(s,i)&&i!==t&&pt(s,i,{get:()=>e[i],enumerable:!(r=ia(e,i))||r.enumerable});return s};var ca=(s,e,t)=>(t=s!=null?sa(aa(s)):{},si(e||!s||!s.__esModule?pt(t,"default",{value:s,enumerable:!0}):t,s)),la=s=>si(pt({},"__esModule",{value:!0}),s);var C=u(k=>{"use strict";Object.defineProperty(k,"__esModule",{value:!0});k.API_V1_1_STREAM_PREFIX=k.API_V1_1_UPLOAD_PREFIX=k.API_V1_1_PREFIX=k.API_V2_LABS_PREFIX=k.API_V2_PREFIX=void 0;k.API_V2_PREFIX="https://api.twitter.com/2/";k.API_V2_LABS_PREFIX="https://api.twitter.com/labs/2/";k.API_V1_1_PREFIX="https://api.twitter.com/1.1/";k.API_V1_1_UPLOAD_PREFIX="https://upload.twitter.com/1.1/";k.API_V1_1_STREAM_PREFIX="https://stream.twitter.com/1.1/"});var Ie=u(pe=>{"use strict";Object.defineProperty(pe,"__esModule",{value:!0});pe.PreviousableTwitterPaginator=pe.TwitterPaginator=void 0;var Xe=class{constructor({realData:e,rateLimit:t,instance:r,queryParams:i,sharedParams:n}){this._maxResultsWhenFetchLast=100,this._realData=e,this._rateLimit=t,this._instance=r,this._queryParams=i,this._sharedParams=n}get _isRateLimitOk(){return!this._rateLimit||this._rateLimit.reset*1e3<Date.now()?!0:this._rateLimit.remaining>0}makeRequest(e){return this._instance.get(this.getEndpoint(),e,{fullResponse:!0,params:this._sharedParams})}makeNewInstanceFromResult(e,t){return new this.constructor({realData:e.data,rateLimit:e.rateLimit,instance:this._instance,queryParams:t,sharedParams:this._sharedParams})}getEndpoint(){return this._endpoint}injectQueryParams(e){return{...e?{max_results:e}:{},...this._queryParams}}async next(e){let t=this.getNextQueryParams(e),r=await this.makeRequest(t);return this.makeNewInstanceFromResult(r,t)}async fetchNext(e){let t=this.getNextQueryParams(e),r=await this.makeRequest(t);return await this.refreshInstanceFromResult(r,!0),this}async fetchLast(e=1/0){let t=this.getNextQueryParams(this._maxResultsWhenFetchLast),r=0;for(;r<e&&this._isRateLimitOk;){let i=await this.makeRequest(t);if(await this.refreshInstanceFromResult(i,!0),r+=this.getPageLengthFromRequest(i),this.isFetchLastOver(i))break;t=this.getNextQueryParams(this._maxResultsWhenFetchLast)}return this}get rateLimit(){var e;return{...(e=this._rateLimit)!==null&&e!==void 0?e:{}}}get data(){return this._realData}get done(){return!this.canFetchNextPage(this._realData)}*[Symbol.iterator](){yield*this.getItemArray()}async*[Symbol.asyncIterator](){yield*this.getItemArray();let e=this,t=this.canFetchNextPage(this._realData);for(;t&&this._isRateLimitOk&&e.getItemArray().length>0;){let r=await e.next(this._maxResultsWhenFetchLast);this.refreshInstanceFromResult({data:r._realData,headers:{},rateLimit:r._rateLimit},!0),t=this.canFetchNextPage(r._realData),yield*r.getItemArray(),e=r}}async*fetchAndIterate(){for(let r of this.getItemArray())yield[r,this];let e=this,t=this.canFetchNextPage(this._realData);for(;t&&this._isRateLimitOk&&e.getItemArray().length>0;){let r=await e.next(this._maxResultsWhenFetchLast);this.refreshInstanceFromResult({data:r._realData,headers:{},rateLimit:r._rateLimit},!0),t=this.canFetchNextPage(r._realData);for(let i of r.getItemArray())yield[i,r];this._rateLimit=r._rateLimit,e=r}}};pe.TwitterPaginator=Xe;var Yt=class extends Xe{async previous(e){let t=this.getPreviousQueryParams(e),r=await this.makeRequest(t);return this.makeNewInstanceFromResult(r,t)}async fetchPrevious(e){let t=this.getPreviousQueryParams(e),r=await this.makeRequest(t);return await this.refreshInstanceFromResult(r,!1),this}};pe.PreviousableTwitterPaginator=Yt;pe.default=Xe});var ge=u(je=>{"use strict";var ha=je&&je.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(je,"__esModule",{value:!0});je.CursoredV1Paginator=void 0;var ma=ha(Ie()),Jt=class extends ma.default{getNextQueryParams(e){var t;return{...this._queryParams,cursor:(t=this._realData.next_cursor_str)!==null&&t!==void 0?t:this._realData.next_cursor,...e?{count:e}:{}}}isFetchLastOver(e){return!this.canFetchNextPage(e.data)}canFetchNextPage(e){return!this.isNextCursorInvalid(e.next_cursor)||!this.isNextCursorInvalid(e.next_cursor_str)}isNextCursorInvalid(e){return e===void 0||e===0||e===-1||e==="0"||e==="-1"}};je.CursoredV1Paginator=Jt});var er=u(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});xe.WelcomeDmV1Paginator=xe.DmEventsV1Paginator=void 0;var ui=ge(),Gt=class extends ui.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="direct_messages/events/list.json"}refreshInstanceFromResult(e,t){let r=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.events.push(...r.events),this._realData.next_cursor=r.next_cursor)}getPageLengthFromRequest(e){return e.data.events.length}getItemArray(){return this.events}get events(){return this._realData.events}};xe.DmEventsV1Paginator=Gt;var Zt=class extends ui.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="direct_messages/welcome_messages/list.json"}refreshInstanceFromResult(e,t){let r=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.welcome_messages.push(...r.welcome_messages),this._realData.next_cursor=r.next_cursor)}getPageLengthFromRequest(e){return e.data.welcome_messages.length}getItemArray(){return this.welcomeMessages}get welcomeMessages(){return this._realData.welcome_messages}};xe.WelcomeDmV1Paginator=Zt});var li=u(ci=>{"use strict";Object.defineProperty(ci,"__esModule",{value:!0})});var di=u(Ke=>{"use strict";Object.defineProperty(Ke,"__esModule",{value:!0});Ke.EUploadMimeType=void 0;var fa;(function(s){s.Jpeg="image/jpeg",s.Mp4="video/mp4",s.Mov="video/quicktime",s.Gif="image/gif",s.Png="image/png",s.Srt="text/plain",s.Webp="image/webp"})(fa=Ke.EUploadMimeType||(Ke.EUploadMimeType={}))});var mi=u(hi=>{"use strict";Object.defineProperty(hi,"__esModule",{value:!0})});var _i=u(fi=>{"use strict";Object.defineProperty(fi,"__esModule",{value:!0})});var gi=u(pi=>{"use strict";Object.defineProperty(pi,"__esModule",{value:!0})});var yi=u(wi=>{"use strict";Object.defineProperty(wi,"__esModule",{value:!0})});var Pi=u(vi=>{"use strict";Object.defineProperty(vi,"__esModule",{value:!0})});var bi=u(Qe=>{"use strict";Object.defineProperty(Qe,"__esModule",{value:!0});Qe.EDirectMessageEventTypeV1=void 0;var _a;(function(s){s.Create="message_create",s.WelcomeCreate="welcome_message"})(_a=Qe.EDirectMessageEventTypeV1||(Qe.EDirectMessageEventTypeV1={}))});var Ri=u(Ti=>{"use strict";Object.defineProperty(Ti,"__esModule",{value:!0})});var qi=u(D=>{"use strict";var pa=D&&D.__createBinding||(Object.create?function(s,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,r,i)}:function(s,e,t,r){r===void 0&&(r=t),s[r]=e[t]}),re=D&&D.__exportStar||function(s,e){for(var t in s)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&pa(e,s,t)};Object.defineProperty(D,"__esModule",{value:!0});re(li(),D);re(di(),D);re(mi(),D);re(_i(),D);re(gi(),D);re(yi(),D);re(Pi(),D);re(bi(),D);re(Ri(),D)});var Di=u(Si=>{"use strict";Object.defineProperty(Si,"__esModule",{value:!0})});var Mi=u(Li=>{"use strict";Object.defineProperty(Li,"__esModule",{value:!0})});var ji=u(Ii=>{"use strict";Object.defineProperty(Ii,"__esModule",{value:!0})});var Oi=u(xi=>{"use strict";Object.defineProperty(xi,"__esModule",{value:!0})});var Fi=u(Ai=>{"use strict";Object.defineProperty(Ai,"__esModule",{value:!0})});var ki=u(Ui=>{"use strict";Object.defineProperty(Ui,"__esModule",{value:!0})});var Ei=u(E=>{"use strict";var ga=E&&E.__createBinding||(Object.create?function(s,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,r,i)}:function(s,e,t,r){r===void 0&&(r=t),s[r]=e[t]}),Oe=E&&E.__exportStar||function(s,e){for(var t in s)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ga(e,s,t)};Object.defineProperty(E,"__esModule",{value:!0});Oe(Di(),E);Oe(Mi(),E);Oe(ji(),E);Oe(Oi(),E);Oe(Fi(),E);Oe(ki(),E)});var Bi=u(q=>{"use strict";Object.defineProperty(q,"__esModule",{value:!0});q.EApiV2ErrorCode=q.EApiV1ErrorCode=q.ApiResponseError=q.ApiPartialResponseError=q.ApiRequestError=q.ETwitterApiError=void 0;var wt;(function(s){s.Request="request",s.PartialResponse="partial-response",s.Response="response"})(wt=q.ETwitterApiError||(q.ETwitterApiError={}));var Ye=class extends Error{constructor(){super(...arguments),this.error=!0}},tr=class extends Ye{constructor(e,t){super(e),this.type=wt.Request,Error.captureStackTrace(this,this.constructor),Object.defineProperty(this,"_options",{value:t})}get request(){return this._options.request}get requestError(){return this._options.requestError}toJSON(){return{type:this.type,error:this.requestError}}};q.ApiRequestError=tr;var rr=class extends Ye{constructor(e,t){super(e),this.type=wt.PartialResponse,Error.captureStackTrace(this,this.constructor),Object.defineProperty(this,"_options",{value:t})}get request(){return this._options.request}get response(){return this._options.response}get responseError(){return this._options.responseError}get rawContent(){return this._options.rawContent}toJSON(){return{type:this.type,error:this.responseError}}};q.ApiPartialResponseError=rr;var sr=class extends Ye{constructor(e,t){if(super(e),this.type=wt.Response,Error.captureStackTrace(this,this.constructor),Object.defineProperty(this,"_options",{value:t}),this.code=t.code,this.headers=t.headers,this.rateLimit=t.rateLimit,t.data&&typeof t.data=="object"&&"error"in t.data&&!t.data.errors){let r={...t.data};r.errors=[{code:Ae.InternalError,message:r.error}],this.data=r}else this.data=t.data}get request(){return this._options.request}get response(){return this._options.response}hasErrorCode(...e){let t=this.errors;if(!t?.length)return!1;if("code"in t[0])return t.some(n=>e.includes(n.code));let r=this.data;return e.includes(r.type)}get errors(){var e;return(e=this.data)===null||e===void 0?void 0:e.errors}get rateLimitError(){return this.code===420||this.code===429}get isAuthError(){return this.code===401?!0:this.hasErrorCode(Ae.AuthTimestampInvalid,Ae.AuthenticationFail,Ae.BadAuthenticationData,Ae.InvalidOrExpiredToken)}toJSON(){return{type:this.type,code:this.code,error:this.data,rateLimit:this.rateLimit,headers:this.headers}}};q.ApiResponseError=sr;var Ae;(function(s){s[s.InvalidCoordinates=3]="InvalidCoordinates",s[s.NoLocationFound=13]="NoLocationFound",s[s.AuthenticationFail=32]="AuthenticationFail",s[s.InvalidOrExpiredToken=89]="InvalidOrExpiredToken",s[s.UnableToVerifyCredentials=99]="UnableToVerifyCredentials",s[s.AuthTimestampInvalid=135]="AuthTimestampInvalid",s[s.BadAuthenticationData=215]="BadAuthenticationData",s[s.NoUserMatch=17]="NoUserMatch",s[s.UserNotFound=50]="UserNotFound",s[s.ResourceNotFound=34]="ResourceNotFound",s[s.TweetNotFound=144]="TweetNotFound",s[s.TweetNotVisible=179]="TweetNotVisible",s[s.NotAllowedResource=220]="NotAllowedResource",s[s.MediaIdNotFound=325]="MediaIdNotFound",s[s.TweetNoLongerAvailable=421]="TweetNoLongerAvailable",s[s.TweetViolatedRules=422]="TweetViolatedRules",s[s.TargetUserSuspended=63]="TargetUserSuspended",s[s.YouAreSuspended=64]="YouAreSuspended",s[s.AccountUpdateFailed=120]="AccountUpdateFailed",s[s.NoSelfSpamReport=36]="NoSelfSpamReport",s[s.NoSelfMute=271]="NoSelfMute",s[s.AccountLocked=326]="AccountLocked",s[s.RateLimitExceeded=88]="RateLimitExceeded",s[s.NoDMRightForApp=93]="NoDMRightForApp",s[s.OverCapacity=130]="OverCapacity",s[s.InternalError=131]="InternalError",s[s.TooManyFollowings=161]="TooManyFollowings",s[s.TweetLimitExceeded=185]="TweetLimitExceeded",s[s.DuplicatedTweet=187]="DuplicatedTweet",s[s.TooManySpamReports=205]="TooManySpamReports",s[s.RequestLooksLikeSpam=226]="RequestLooksLikeSpam",s[s.NoWriteRightForApp=261]="NoWriteRightForApp",s[s.TweetActionsDisabled=425]="TweetActionsDisabled",s[s.TweetRepliesRestricted=433]="TweetRepliesRestricted",s[s.NamedParameterMissing=38]="NamedParameterMissing",s[s.InvalidAttachmentUrl=44]="InvalidAttachmentUrl",s[s.TweetTextTooLong=186]="TweetTextTooLong",s[s.MissingUrlParameter=195]="MissingUrlParameter",s[s.NoMultipleGifs=323]="NoMultipleGifs",s[s.InvalidMediaIds=324]="InvalidMediaIds",s[s.InvalidUrl=407]="InvalidUrl",s[s.TooManyTweetAttachments=386]="TooManyTweetAttachments",s[s.StatusAlreadyFavorited=139]="StatusAlreadyFavorited",s[s.FollowRequestAlreadySent=160]="FollowRequestAlreadySent",s[s.CannotUnmuteANonMutedAccount=272]="CannotUnmuteANonMutedAccount",s[s.TweetAlreadyRetweeted=327]="TweetAlreadyRetweeted",s[s.ReplyToDeletedTweet=385]="ReplyToDeletedTweet",s[s.DMReceiverNotFollowingYou=150]="DMReceiverNotFollowingYou",s[s.UnableToSendDM=151]="UnableToSendDM",s[s.MustAllowDMFromAnyone=214]="MustAllowDMFromAnyone",s[s.CannotSendDMToThisUser=349]="CannotSendDMToThisUser",s[s.DMTextTooLong=354]="DMTextTooLong",s[s.SubscriptionAlreadyExists=355]="SubscriptionAlreadyExists",s[s.CallbackUrlNotApproved=415]="CallbackUrlNotApproved",s[s.SuspendedApplication=416]="SuspendedApplication",s[s.OobOauthIsNotAllowed=417]="OobOauthIsNotAllowed"})(Ae=q.EApiV1ErrorCode||(q.EApiV1ErrorCode={}));var wa;(function(s){s.InvalidRequest="https://api.twitter.com/2/problems/invalid-request",s.ClientForbidden="https://api.twitter.com/2/problems/client-forbidden",s.UnsupportedAuthentication="https://api.twitter.com/2/problems/unsupported-authentication",s.InvalidRules="https://api.twitter.com/2/problems/invalid-rules",s.TooManyRules="https://api.twitter.com/2/problems/rule-cap",s.DuplicatedRules="https://api.twitter.com/2/problems/duplicate-rules",s.RateLimitExceeded="https://api.twitter.com/2/problems/usage-capped",s.ConnectionError="https://api.twitter.com/2/problems/streaming-connection",s.ClientDisconnected="https://api.twitter.com/2/problems/client-disconnected",s.TwitterDisconnectedYou="https://api.twitter.com/2/problems/operational-disconnect",s.ResourceNotFound="https://api.twitter.com/2/problems/resource-not-found",s.ResourceUnauthorized="https://api.twitter.com/2/problems/not-authorized-for-resource",s.DisallowedResource="https://api.twitter.com/2/problems/disallowed-resource"})(wa=q.EApiV2ErrorCode||(q.EApiV2ErrorCode={}))});var Vi=u(Ni=>{"use strict";Object.defineProperty(Ni,"__esModule",{value:!0})});var Ci=u(Je=>{"use strict";Object.defineProperty(Je,"__esModule",{value:!0});Je.ETwitterStreamEvent=void 0;var ya;(function(s){s.Connected="connected",s.ConnectError="connect error",s.ConnectionError="connection error",s.ConnectionClosed="connection closed",s.ConnectionLost="connection lost",s.ReconnectAttempt="reconnect attempt",s.Reconnected="reconnected",s.ReconnectError="reconnect error",s.ReconnectLimitExceeded="reconnect limit exceeded",s.DataKeepAlive="data keep-alive",s.Data="data event content",s.DataError="data twitter error",s.TweetParseError="data tweet parse error",s.Error="stream error"})(ya=Je.ETwitterStreamEvent||(Je.ETwitterStreamEvent={}))});var Wi=u(Hi=>{"use strict";Object.defineProperty(Hi,"__esModule",{value:!0})});var $i=u(yt=>{"use strict";Object.defineProperty(yt,"__esModule",{value:!0});yt.TwitterApiPluginResponseOverride=void 0;var ir=class{constructor(e){this.value=e}};yt.TwitterApiPluginResponseOverride=ir});var zi=u(we=>{"use strict";var va=we&&we.__createBinding||(Object.create?function(s,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,r,i)}:function(s,e,t,r){r===void 0&&(r=t),s[r]=e[t]}),Pa=we&&we.__exportStar||function(s,e){for(var t in s)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&va(e,s,t)};Object.defineProperty(we,"__esModule",{value:!0});Pa($i(),we)});var K=u(x=>{"use strict";var ba=x&&x.__createBinding||(Object.create?function(s,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,r,i)}:function(s,e,t,r){r===void 0&&(r=t),s[r]=e[t]}),ye=x&&x.__exportStar||function(s,e){for(var t in s)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ba(e,s,t)};Object.defineProperty(x,"__esModule",{value:!0});ye(qi(),x);ye(Ei(),x);ye(Bi(),x);ye(Vi(),x);ye(Ci(),x);ye(Wi(),x);ye(zi(),x)});var Pt=u(vt=>{"use strict";Object.defineProperty(vt,"__esModule",{value:!0});vt.TwitterApiV2Settings=void 0;vt.TwitterApiV2Settings={debug:!1,deprecationWarnings:!0,logger:{log:console.log.bind(console)}}});var le=u(L=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0});L.safeDeprecationWarning=L.hasMultipleItems=L.isTweetStreamV2ErrorPayload=L.trimUndefinedProperties=L.arrayWrap=L.sharedPromise=void 0;var Ta=Pt();function Ra(s){let e={value:void 0,promise:s().then(t=>(e.value=t,t))};return e}L.sharedPromise=Ra;function qa(s){return Array.isArray(s)?s:[s]}L.arrayWrap=qa;function Sa(s){for(let e in s)s[e]===void 0&&delete s[e]}L.trimUndefinedProperties=Sa;function Da(s){return typeof s=="object"&&"errors"in s&&!("data"in s)}L.isTweetStreamV2ErrorPayload=Da;function La(s){return Array.isArray(s)&&s.length>1?!0:s.toString().includes(",")}L.hasMultipleItems=La;var Xi=new Set;function Ma(s){if(typeof console>"u"||!console.warn||!Ta.TwitterApiV2Settings.deprecationWarnings)return;let e=`${s.instance}-${s.method}-${s.problem}`;if(Xi.has(e))return;let t=`[twitter-api-v2] Deprecation warning: In ${s.instance}.${s.method}() call, ${s.problem}.
${s.resolution}.`;console.warn(t),console.warn("To disable this message, import variable TwitterApiV2Settings from twitter-api-v2 and set TwitterApiV2Settings.deprecationWarnings to false."),Xi.add(e)}L.safeDeprecationWarning=Ma});var ar=u(O=>{"use strict";var Ia=O&&O.__createBinding||(Object.create?function(s,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,r,i)}:function(s,e,t,r){r===void 0&&(r=t),s[r]=e[t]}),ja=O&&O.__setModuleDefault||(Object.create?function(s,e){Object.defineProperty(s,"default",{enumerable:!0,value:e})}:function(s,e){s.default=e}),xa=O&&O.__importStar||function(s){if(s&&s.__esModule)return s;var e={};if(s!=null)for(var t in s)t!=="default"&&Object.prototype.hasOwnProperty.call(s,t)&&Ia(e,s,t);return ja(e,s),e},Oa=O&&O.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(O,"__esModule",{value:!0});O.RequestHandlerHelper=void 0;var Aa=require("https"),M=Pt(),Fa=Oa(Tt()),nr=K(),se=xa(require("zlib")),Ua=require("events"),bt=class{constructor(e){this.requestData=e,this.requestErrorHandled=!1,this.responseData=[]}get hrefPathname(){let e=this.requestData.url;return e.hostname+e.pathname}isCompressionDisabled(){return!this.requestData.compression||this.requestData.compression==="identity"}isFormEncodedEndpoint(){return this.requestData.url.href.startsWith("https://api.twitter.com/oauth/")}createRequestError(e){return M.TwitterApiV2Settings.debug&&M.TwitterApiV2Settings.logger.log("Request error:",e),new nr.ApiRequestError("Request failed.",{request:this.req,error:e})}createPartialResponseError(e,t){let i=`Request failed with partial response with HTTP code ${this.res.statusCode}`;return t?i+=" (connection abruptly closed)":i+=" (parse error)",new nr.ApiPartialResponseError(i,{request:this.req,response:this.res,responseError:e,rawContent:Buffer.concat(this.responseData).toString()})}formatV1Errors(e){return e.map(({code:t,message:r})=>`${r} (Twitter code ${t})`).join(", ")}formatV2Error(e){return`${e.title}: ${e.detail} (see ${e.type})`}createResponseError({res:e,data:t,rateLimit:r,code:i}){var n;M.TwitterApiV2Settings.debug&&(M.TwitterApiV2Settings.logger.log(`Request failed with code ${i}, data:`,t),M.TwitterApiV2Settings.logger.log("Response headers:",e.headers));let a=`Request failed with code ${i}`;if(!((n=t?.errors)===null||n===void 0)&&n.length){let o=t.errors;"code"in o[0]?a+=" - "+this.formatV1Errors(o):a+=" - "+this.formatV2Error(t)}return new nr.ApiResponseError(a,{code:i,data:t,headers:e.headers,request:this.req,response:e,rateLimit:r})}getResponseDataStream(e){if(this.isCompressionDisabled())return e;let t=(e.headers["content-encoding"]||"identity").trim().toLowerCase();if(t==="br"){let r=se.createBrotliDecompress({flush:se.constants.BROTLI_OPERATION_FLUSH,finishFlush:se.constants.BROTLI_OPERATION_FLUSH});return e.pipe(r),r}if(t==="gzip"){let r=se.createGunzip({flush:se.constants.Z_SYNC_FLUSH,finishFlush:se.constants.Z_SYNC_FLUSH});return e.pipe(r),r}if(t==="deflate"){let r=se.createInflate({flush:se.constants.Z_SYNC_FLUSH,finishFlush:se.constants.Z_SYNC_FLUSH});return e.pipe(r),r}return e}detectResponseType(e){var t,r;return!((t=e.headers["content-type"])===null||t===void 0)&&t.includes("application/json")||!((r=e.headers["content-type"])===null||r===void 0)&&r.includes("application/problem+json")?"json":this.isFormEncodedEndpoint()?"url":"text"}getParsedResponse(e){let t=this.responseData,r=this.requestData.forceParseMode||this.detectResponseType(e);if(r==="buffer")return Buffer.concat(t);if(r==="text")return Buffer.concat(t).toString();if(r==="json"){let i=Buffer.concat(t).toString();return i.length?JSON.parse(i):void 0}else if(r==="url"){let i=Buffer.concat(t).toString(),n={};for(let[a,o]of new URLSearchParams(i))n[a]=o;return n}else return}getRateLimitFromResponse(e){let t;return e.headers["x-rate-limit-limit"]&&(t={limit:Number(e.headers["x-rate-limit-limit"]),remaining:Number(e.headers["x-rate-limit-remaining"]),reset:Number(e.headers["x-rate-limit-reset"])},e.headers["x-app-limit-24hour-limit"]&&(t.day={limit:Number(e.headers["x-app-limit-24hour-limit"]),remaining:Number(e.headers["x-app-limit-24hour-remaining"]),reset:Number(e.headers["x-app-limit-24hour-reset"])}),this.requestData.rateLimitSaver&&this.requestData.rateLimitSaver(t)),t}onSocketEventHandler(e,t,r){let i=this.onSocketCloseHandler.bind(this,e);r.on("close",i),t.on("complete",()=>r.off("close",i))}onSocketCloseHandler(e){if(this.req.removeAllListeners("timeout"),!this.res&&!this.requestErrorHandled)return e(this.createRequestError(new Error("Socket closed without any information.")))}requestErrorHandler(e,t){var r,i;(i=(r=this.requestData).requestEventDebugHandler)===null||i===void 0||i.call(r,"request-error",{requestError:t}),this.requestErrorHandled=!0,e(this.createRequestError(t))}timeoutErrorHandler(){this.requestErrorHandled=!0,this.req.destroy(new Error("Request timeout."))}classicResponseHandler(e,t,r){this.res=r;let i=this.getResponseDataStream(r);i.on("data",n=>this.responseData.push(n)),i.on("end",this.onResponseEndHandler.bind(this,e,t)),i.on("close",this.onResponseCloseHandler.bind(this,e,t)),this.requestData.requestEventDebugHandler&&(this.requestData.requestEventDebugHandler("response",{res:r}),r.on("aborted",n=>this.requestData.requestEventDebugHandler("response-aborted",{error:n})),r.on("error",n=>this.requestData.requestEventDebugHandler("response-error",{error:n})),r.on("close",()=>this.requestData.requestEventDebugHandler("response-close",{data:this.responseData})),r.on("end",()=>this.requestData.requestEventDebugHandler("response-end")))}onResponseEndHandler(e,t){let r=this.getRateLimitFromResponse(this.res),i;try{i=this.getParsedResponse(this.res)}catch(a){t(this.createPartialResponseError(a,!1));return}let n=this.res.statusCode;if(n>=400){t(this.createResponseError({data:i,res:this.res,rateLimit:r,code:n}));return}M.TwitterApiV2Settings.debug&&(M.TwitterApiV2Settings.logger.log(`[${this.requestData.options.method} ${this.hrefPathname}]: Request succeeds with code ${this.res.statusCode}`),M.TwitterApiV2Settings.logger.log("Response body:",i)),e({data:i,headers:this.res.headers,rateLimit:r})}onResponseCloseHandler(e,t){let r=this.res;if(r.aborted)try{return this.getParsedResponse(this.res),this.onResponseEndHandler(e,t)}catch(i){return t(this.createPartialResponseError(i,!0))}if(!r.complete)return t(this.createPartialResponseError(new Error("Response has been interrupted before response could be parsed."),!0))}streamResponseHandler(e,t,r){if(r.statusCode<400){M.TwitterApiV2Settings.debug&&M.TwitterApiV2Settings.logger.log(`[${this.requestData.options.method} ${this.hrefPathname}]: Request succeeds with code ${r.statusCode} (starting stream)`);let n=this.getResponseDataStream(r);e({req:this.req,res:n,originalResponse:r,requestData:this.requestData})}else this.classicResponseHandler(()=>{},t,r)}debugRequest(){let e=this.requestData.url;M.TwitterApiV2Settings.logger.log(`[${this.requestData.options.method} ${this.hrefPathname}]`,this.requestData.options),e.search&&M.TwitterApiV2Settings.logger.log("Request parameters:",[...e.searchParams.entries()].map(([t,r])=>`${t}: ${r}`)),this.requestData.body&&M.TwitterApiV2Settings.logger.log("Request body:",this.requestData.body)}buildRequest(){var e;let t=this.requestData.url,r=t.username?`${t.username}:${t.password}`:void 0,i=(e=this.requestData.options.headers)!==null&&e!==void 0?e:{};this.requestData.compression===!0||this.requestData.compression==="brotli"?i["accept-encoding"]="br;q=1.0, gzip;q=0.8, deflate;q=0.5, *;q=0.1":this.requestData.compression==="gzip"?i["accept-encoding"]="gzip;q=1, deflate;q=0.5, *;q=0.1":this.requestData.compression==="deflate"&&(i["accept-encoding"]="deflate;q=1, *;q=0.1"),M.TwitterApiV2Settings.debug&&this.debugRequest(),this.req=(0,Aa.request)({...this.requestData.options,host:t.hostname,port:t.port||void 0,path:t.pathname+t.search,protocol:t.protocol,auth:r,headers:i})}registerRequestEventDebugHandlers(e){e.on("close",()=>this.requestData.requestEventDebugHandler("close")),e.on("abort",()=>this.requestData.requestEventDebugHandler("abort")),e.on("socket",t=>{this.requestData.requestEventDebugHandler("socket",{socket:t}),t.on("error",r=>this.requestData.requestEventDebugHandler("socket-error",{socket:t,error:r})),t.on("connect",()=>this.requestData.requestEventDebugHandler("socket-connect",{socket:t})),t.on("close",r=>this.requestData.requestEventDebugHandler("socket-close",{socket:t,withError:r})),t.on("end",()=>this.requestData.requestEventDebugHandler("socket-end",{socket:t})),t.on("lookup",(...r)=>this.requestData.requestEventDebugHandler("socket-lookup",{socket:t,data:r})),t.on("timeout",()=>this.requestData.requestEventDebugHandler("socket-timeout",{socket:t}))})}makeRequest(){return this.buildRequest(),new Promise((e,t)=>{let r=o=>{n.emit("complete"),e(o)},i=o=>{n.emit("complete"),t(o)},n=new Ua.EventEmitter,a=this.req;a.on("error",this.requestErrorHandler.bind(this,i)),a.on("socket",this.onSocketEventHandler.bind(this,i,n)),a.on("response",this.classicResponseHandler.bind(this,r,i)),this.requestData.options.timeout&&a.on("timeout",this.timeoutErrorHandler.bind(this)),this.requestData.requestEventDebugHandler&&this.registerRequestEventDebugHandlers(a),this.requestData.body&&a.write(this.requestData.body),a.end()})}async makeRequestAsStream(){let{req:e,res:t,requestData:r,originalResponse:i}=await this.makeRequestAndResolveWhenReady();return new Fa.default(r,{req:e,res:t,originalResponse:i})}makeRequestAndResolveWhenReady(){return this.buildRequest(),new Promise((e,t)=>{let r=this.req;r.on("error",this.requestErrorHandler.bind(this,t)),r.on("response",this.streamResponseHandler.bind(this,e,t)),this.requestData.body&&r.write(this.requestData.body),r.end()})}};O.RequestHandlerHelper=bt;O.default=bt});var Ki=u(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});Ge.TweetStreamEventCombiner=void 0;var ka=require("events"),de=K(),Rt=class extends ka.EventEmitter{constructor(e){super(),this.stream=e,this.stack=[],this.onStreamData=this.onStreamData.bind(this),this.onStreamError=this.onStreamError.bind(this),this.onceNewEvent=this.once.bind(this,"event"),e.on(de.ETwitterStreamEvent.Data,this.onStreamData),e.on(de.ETwitterStreamEvent.ConnectionError,this.onStreamError),e.on(de.ETwitterStreamEvent.TweetParseError,this.onStreamError),e.on(de.ETwitterStreamEvent.ConnectionClosed,this.onStreamError)}nextEvent(){return new Promise(this.onceNewEvent)}hasStack(){return this.stack.length>0}popStack(){let e=this.stack;return this.stack=[],e}destroy(){this.removeAllListeners(),this.stream.off(de.ETwitterStreamEvent.Data,this.onStreamData),this.stream.off(de.ETwitterStreamEvent.ConnectionError,this.onStreamError),this.stream.off(de.ETwitterStreamEvent.TweetParseError,this.onStreamError),this.stream.off(de.ETwitterStreamEvent.ConnectionClosed,this.onStreamError)}emitEvent(e,t){this.emit("event",{type:e,payload:t})}onStreamError(e){this.emitEvent("error",e)}onStreamData(e){this.stack.push(e),this.emitEvent("data",e)}};Ge.TweetStreamEventCombiner=Rt;Ge.default=Rt});var Qi=u(Fe=>{"use strict";Object.defineProperty(Fe,"__esModule",{value:!0});Fe.EStreamParserEvent=void 0;var Ea=require("events"),or=class extends Ea.EventEmitter{constructor(){super(...arguments),this.currentMessage=""}push(e){this.currentMessage+=e,e=this.currentMessage;let t=e.length,r=0,i=0;for(;i<t;){if(e.slice(i,i+2)===`\r
`){let n=e.slice(r,i);if(r=i+=2,!n.length)continue;try{let a=JSON.parse(n);if(a){this.emit(ur.ParsedData,a);continue}}catch(a){this.emit(ur.ParseError,a)}}i++}this.currentMessage=e.slice(r,t)}reset(){this.currentMessage=""}};Fe.default=or;var ur;(function(s){s.ParsedData="parsed data",s.ParseError="parse error"})(ur=Fe.EStreamParserEvent||(Fe.EStreamParserEvent={}))});var Tt=u(A=>{"use strict";var Ba=A&&A.__createBinding||(Object.create?function(s,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,r,i)}:function(s,e,t,r){r===void 0&&(r=t),s[r]=e[t]}),Na=A&&A.__setModuleDefault||(Object.create?function(s,e){Object.defineProperty(s,"default",{enumerable:!0,value:e})}:function(s,e){s.default=e}),Va=A&&A.__importStar||function(s){if(s&&s.__esModule)return s;var e={};if(s!=null)for(var t in s)t!=="default"&&Object.prototype.hasOwnProperty.call(s,t)&&Ba(e,s,t);return Na(e,s),e},Gi=A&&A.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(A,"__esModule",{value:!0});A.TweetStream=void 0;var Ca=require("events"),Yi=Gi(ar()),p=K(),Ha=Gi(Ki()),cr=Va(Qi()),Ji=[5,15,30,60,90,120,180,300,600,900],Wa=s=>s>Ji.length?901e3:Ji[s-1]*1e3,qt=class extends Ca.EventEmitter{constructor(e,t){super(),this.requestData=e,this.autoReconnect=!1,this.autoReconnectRetries=5,this.keepAliveTimeoutMs=1e3*120,this.nextRetryTimeout=Wa,this.parser=new cr.default,this.connectionProcessRunning=!1,this.onKeepAliveTimeout=this.onKeepAliveTimeout.bind(this),this.initEventsFromParser(),t&&(this.req=t.req,this.res=t.res,this.originalResponse=t.originalResponse,this.initEventsFromRequest())}on(e,t){return super.on(e,t)}initEventsFromRequest(){if(!this.req||!this.res)throw new Error("TweetStream error: You cannot init TweetStream without a request and response object.");let e=t=>{this.emit(p.ETwitterStreamEvent.ConnectionError,t),this.emit(p.ETwitterStreamEvent.Error,{type:p.ETwitterStreamEvent.ConnectionError,error:t,message:"Connection lost or closed by Twitter."}),this.onConnectionError()};this.req.on("error",e),this.res.on("error",e),this.res.on("close",()=>e(new Error("Connection closed by Twitter."))),this.res.on("data",t=>{if(this.resetKeepAliveTimeout(),t.toString()===`\r
`)return this.emit(p.ETwitterStreamEvent.DataKeepAlive);this.parser.push(t.toString())}),this.resetKeepAliveTimeout()}initEventsFromParser(){let e=this.requestData.payloadIsError;this.parser.on(cr.EStreamParserEvent.ParsedData,t=>{e&&e(t)?(this.emit(p.ETwitterStreamEvent.DataError,t),this.emit(p.ETwitterStreamEvent.Error,{type:p.ETwitterStreamEvent.DataError,error:t,message:"Twitter sent a payload that is detected as an error payload."})):this.emit(p.ETwitterStreamEvent.Data,t)}),this.parser.on(cr.EStreamParserEvent.ParseError,t=>{this.emit(p.ETwitterStreamEvent.TweetParseError,t),this.emit(p.ETwitterStreamEvent.Error,{type:p.ETwitterStreamEvent.TweetParseError,error:t,message:"Failed to parse stream data."})})}resetKeepAliveTimeout(){this.unbindKeepAliveTimeout(),this.keepAliveTimeoutMs!==1/0&&(this.keepAliveTimeout=setTimeout(this.onKeepAliveTimeout,this.keepAliveTimeoutMs))}onKeepAliveTimeout(){this.emit(p.ETwitterStreamEvent.ConnectionLost),this.onConnectionError()}unbindTimeouts(){this.unbindRetryTimeout(),this.unbindKeepAliveTimeout()}unbindKeepAliveTimeout(){this.keepAliveTimeout&&(clearTimeout(this.keepAliveTimeout),this.keepAliveTimeout=void 0)}unbindRetryTimeout(){this.retryTimeout&&(clearTimeout(this.retryTimeout),this.retryTimeout=void 0)}closeWithoutEmit(){this.unbindTimeouts(),this.res&&(this.res.removeAllListeners(),this.res.destroy()),this.req&&(this.req.removeAllListeners(),this.req.destroy())}close(){this.emit(p.ETwitterStreamEvent.ConnectionClosed),this.closeWithoutEmit()}destroy(){this.removeAllListeners(),this.close()}async clone(){let t=await new Yi.default(this.requestData).makeRequestAsStream(),r=this.eventNames();for(let i of r){let n=this.listeners(i);for(let a of n)t.on(i,a)}return t}async connect(e={}){typeof e.autoReconnect<"u"&&(this.autoReconnect=e.autoReconnect),typeof e.autoReconnectRetries<"u"&&(this.autoReconnectRetries=e.autoReconnectRetries==="unlimited"?1/0:e.autoReconnectRetries),typeof e.keepAliveTimeout<"u"&&(this.keepAliveTimeoutMs=e.keepAliveTimeout==="disable"?1/0:e.keepAliveTimeout),typeof e.nextRetryTimeout<"u"&&(this.nextRetryTimeout=e.nextRetryTimeout),this.unbindTimeouts();try{await this.reconnect()}catch(t){if(this.emit(p.ETwitterStreamEvent.ConnectError,0),this.emit(p.ETwitterStreamEvent.Error,{type:p.ETwitterStreamEvent.ConnectError,error:t,message:"Connect error - Initial connection just failed."}),this.autoReconnect)this.makeAutoReconnectRetry(0,t);else throw t}return this}async reconnect(){if(this.connectionProcessRunning)throw new Error("Connection process is already running.");this.connectionProcessRunning=!0;try{let e=!0;this.req&&(e=!1,this.closeWithoutEmit());let{req:t,res:r,originalResponse:i}=await new Yi.default(this.requestData).makeRequestAndResolveWhenReady();this.req=t,this.res=r,this.originalResponse=i,this.emit(e?p.ETwitterStreamEvent.Connected:p.ETwitterStreamEvent.Reconnected),this.parser.reset(),this.initEventsFromRequest()}finally{this.connectionProcessRunning=!1}}async onConnectionError(e=0){if(this.unbindTimeouts(),this.closeWithoutEmit(),!this.autoReconnect){this.emit(p.ETwitterStreamEvent.ConnectionClosed);return}if(e>=this.autoReconnectRetries){this.emit(p.ETwitterStreamEvent.ReconnectLimitExceeded),this.emit(p.ETwitterStreamEvent.ConnectionClosed);return}try{this.emit(p.ETwitterStreamEvent.ReconnectAttempt,e),await this.reconnect()}catch(t){this.emit(p.ETwitterStreamEvent.ReconnectError,e),this.emit(p.ETwitterStreamEvent.Error,{type:p.ETwitterStreamEvent.ReconnectError,error:t,message:`Reconnect error - ${e+1} attempts made yet.`}),this.makeAutoReconnectRetry(e,t)}}makeAutoReconnectRetry(e,t){let r=this.nextRetryTimeout(e+1,t);this.retryTimeout=setTimeout(()=>{this.onConnectionError(e+1)},r)}async*[Symbol.asyncIterator](){let e=new Ha.default(this);try{for(;;){if(!this.req||this.req.aborted)throw new Error("Connection closed");e.hasStack()&&(yield*e.popStack());let{type:t,payload:r}=await e.nextEvent();if(t==="error")throw r}}finally{e.destroy()}}};A.TweetStream=qt;A.default=qt});var Zi=u(Ue=>{"use strict";Object.defineProperty(Ue,"__esModule",{value:!0});Ue.applyResponseHooks=Ue.hasRequestErrorPlugins=void 0;var St=K();function $a(s){var e;if(!(!((e=s.clientSettings.plugins)===null||e===void 0)&&e.length))return!1;for(let t of s.clientSettings.plugins)if(t.onRequestError||t.onResponseError)return!0;return!1}Ue.hasRequestErrorPlugins=$a;async function za(s,e,t,r){let i;return r instanceof St.ApiRequestError||r instanceof St.ApiPartialResponseError?i=await this.applyPluginMethod("onRequestError",{client:this,url:this.getUrlObjectFromUrlString(s.url),params:s,computedParams:e,requestOptions:t,error:r}):r instanceof St.ApiResponseError&&(i=await this.applyPluginMethod("onResponseError",{client:this,url:this.getUrlObjectFromUrlString(s.url),params:s,computedParams:e,requestOptions:t,error:r})),i&&i instanceof St.TwitterApiPluginResponseOverride?i.value:Promise.reject(r)}Ue.applyResponseHooks=za});var lr=u(H=>{"use strict";var Xa=H&&H.__createBinding||(Object.create?function(s,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,r,i)}:function(s,e,t,r){r===void 0&&(r=t),s[r]=e[t]}),Ka=H&&H.__setModuleDefault||(Object.create?function(s,e){Object.defineProperty(s,"default",{enumerable:!0,value:e})}:function(s,e){s.default=e}),Qa=H&&H.__importStar||function(s){if(s&&s.__esModule)return s;var e={};if(s!=null)for(var t in s)t!=="default"&&Object.prototype.hasOwnProperty.call(s,t)&&Xa(e,s,t);return Ka(e,s),e};Object.defineProperty(H,"__esModule",{value:!0});H.OAuth1Helper=void 0;var Ya=Qa(require("crypto")),I=class{constructor(e){this.nonceLength=32,this.consumerKeys=e.consumerKeys}static percentEncode(e){return encodeURIComponent(e).replace(/!/g,"%21").replace(/\*/g,"%2A").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29")}hash(e,t){return Ya.createHmac("sha1",t).update(e).digest("base64")}authorize(e,t={}){let r={oauth_consumer_key:this.consumerKeys.key,oauth_nonce:this.getNonce(),oauth_signature_method:"HMAC-SHA1",oauth_timestamp:this.getTimestamp(),oauth_version:"1.0"};return t.key!==void 0&&(r.oauth_token=t.key),e.data||(e.data={}),r.oauth_signature=this.getSignature(e,t.secret,r),r}toHeader(e){let t=tn(e),r="OAuth ";for(let i of t)i.key.indexOf("oauth_")===0&&(r+=I.percentEncode(i.key)+'="'+I.percentEncode(i.value)+'",');return{Authorization:r.slice(0,r.length-1)}}getNonce(){let e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",t="";for(let r=0;r<this.nonceLength;r++)t+=e[Math.trunc(Math.random()*e.length)];return t}getTimestamp(){return Math.trunc(new Date().getTime()/1e3)}getSignature(e,t,r){return this.hash(this.getBaseString(e,r),this.getSigningKey(t))}getSigningKey(e){return I.percentEncode(this.consumerKeys.secret)+"&"+I.percentEncode(e||"")}getBaseString(e,t){return e.method.toUpperCase()+"&"+I.percentEncode(this.getBaseUrl(e.url))+"&"+I.percentEncode(this.getParameterString(e,t))}getParameterString(e,t){let r=tn(Za(en(t,en(e.data,Ga(e.url))))),i="";for(let{key:n,value:a}of r)if(a&&Array.isArray(a)){a.sort();let o="";a.forEach((c,m)=>{o+=n+"="+c,m<a.length&&(o+="&")}),i+=o}else i+=n+"="+a+"&";return i.slice(0,i.length-1)}getBaseUrl(e){return e.split("?")[0]}};H.OAuth1Helper=I;H.default=I;function en(s,e){return{...s||{},...e||{}}}function tn(s){return Object.keys(s).sort().map(e=>({key:e,value:s[e]}))}function Ja(s){let e=s.split("&"),t={};for(let r of e){let[i,n=""]=r.split("=");t[i]?(Array.isArray(t[i])||(t[i]=[t[i]]),t[i].push(decodeURIComponent(n))):t[i]=decodeURIComponent(n)}return t}function Ga(s){let e=s.split("?");return e.length===1?{}:Ja(e[1])}function Za(s){let e={};for(let t in s){let r=s[t];r&&Array.isArray(r)?r=r.map(i=>I.percentEncode(i)):r=I.percentEncode(r),e[I.percentEncode(t)]=r}return e}});var rn=u(Dt=>{"use strict";Object.defineProperty(Dt,"__esModule",{value:!0});Dt.FormDataHelper=void 0;var eo=le(),B=class{constructor(){this._boundary="",this._chunks=[]}bodyAppend(...e){let t=e.map(r=>r instanceof Buffer?r:Buffer.from(r));this._chunks.push(...t)}append(e,t,r){let i=t instanceof Buffer?t:t.toString(),n=this.getMultipartHeader(e,i,r);this.bodyAppend(n,i,B.LINE_BREAK)}getHeaders(){return{"content-type":"multipart/form-data; boundary="+this.getBoundary()}}getLength(){return this._chunks.reduce((e,t)=>e+t.length,this.getMultipartFooter().length)}getBuffer(){let e=[...this._chunks,this.getMultipartFooter()],t=Buffer.alloc(this.getLength()),r=0;for(let i of e)for(let n=0;n<i.length;r++,n++)t[r]=i[n];return t}getBoundary(){return this._boundary||this.generateBoundary(),this._boundary}generateBoundary(){let e="--------------------------";for(let t=0;t<24;t++)e+=Math.floor(Math.random()*10).toString(16);this._boundary=e}getMultipartHeader(e,t,r){r||(r=t instanceof Buffer?B.DEFAULT_CONTENT_TYPE:"");let i={"Content-Disposition":["form-data",`name="${e}"`],"Content-Type":r},n="";for(let[a,o]of Object.entries(i))o.length&&(n+=a+": "+(0,eo.arrayWrap)(o).join("; ")+B.LINE_BREAK);return"--"+this.getBoundary()+B.LINE_BREAK+n+B.LINE_BREAK}getMultipartFooter(){return this._footerChunk?this._footerChunk:this._footerChunk=Buffer.from("--"+this.getBoundary()+"--"+B.LINE_BREAK)}};Dt.FormDataHelper=B;B.LINE_BREAK=`\r
`;B.DEFAULT_CONTENT_TYPE="application/octet-stream"});var dr=u(ve=>{"use strict";var to=ve&&ve.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ve,"__esModule",{value:!0});ve.RequestParamHelpers=void 0;var ro=rn(),sn=to(lr()),Ze=class{static formatQueryToString(e){let t={};for(let r in e)typeof e[r]=="string"?t[r]=e[r]:typeof e[r]<"u"&&(t[r]=String(e[r]));return t}static autoDetectBodyType(e){if(e.pathname.startsWith("/2/")||e.pathname.startsWith("/labs/2/"))return e.password.startsWith("/2/oauth2")?"url":"json";if(e.hostname==="upload.twitter.com")return e.pathname==="/1.1/media/upload.json"?"form-data":"json";let t=e.pathname.split("/1.1/",2)[1];return this.JSON_1_1_ENDPOINTS.has(t)?"json":"url"}static addQueryParamsToUrl(e,t){let r=Object.entries(t);if(r.length){let i="";for(let[n,a]of r)i+=(i.length?"&":"?")+`${sn.default.percentEncode(n)}=${sn.default.percentEncode(a)}`;e.search=i}}static constructBodyParams(e,t,r){if(e instanceof Buffer)return e;if(r==="json")return t["content-type"]||(t["content-type"]="application/json;charset=UTF-8"),JSON.stringify(e);if(r==="url")return t["content-type"]||(t["content-type"]="application/x-www-form-urlencoded;charset=UTF-8"),Object.keys(e).length?new URLSearchParams(e).toString().replace(/\*/g,"%2A"):"";if(r==="raw")throw new Error("You can only use raw body mode with Buffers. To give a string, use Buffer.from(str).");{let i=new ro.FormDataHelper;for(let n in e)i.append(n,e[n]);if(!t["content-type"]){let n=i.getHeaders();t["content-type"]=n["content-type"]}return i.getBuffer()}}static setBodyLengthHeader(e,t){var r;e.headers=(r=e.headers)!==null&&r!==void 0?r:{},typeof t=="string"?e.headers["content-length"]=Buffer.byteLength(t):e.headers["content-length"]=t.length}static isOAuthSerializable(e){return!(e instanceof Buffer)}static mergeQueryAndBodyForOAuth(e,t){let r={};for(let i in e)r[i]=e[i];if(this.isOAuthSerializable(t))for(let i in t){let n=t[i];this.isOAuthSerializable(n)&&(r[i]=typeof n=="object"&&n!==null&&"toString"in n?n.toString():n)}return r}static moveUrlQueryParamsIntoObject(e,t){for(let[r,i]of e.searchParams)t[r]=i;return e.search="",e}static applyRequestParametersToUrl(e,t){return e.pathname=e.pathname.replace(/:([A-Z_-]+)/ig,(r,i)=>t[i]!==void 0?String(t[i]):r),e}};ve.RequestParamHelpers=Ze;Ze.JSON_1_1_ENDPOINTS=new Set(["direct_messages/events/new.json","direct_messages/welcome_messages/new.json","direct_messages/welcome_messages/rules/new.json","media/metadata/create.json","collections/entries/curate.json"]);ve.default=Ze});var mr=u(Q=>{"use strict";var so=Q&&Q.__createBinding||(Object.create?function(s,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,r,i)}:function(s,e,t,r){r===void 0&&(r=t),s[r]=e[t]}),io=Q&&Q.__setModuleDefault||(Object.create?function(s,e){Object.defineProperty(s,"default",{enumerable:!0,value:e})}:function(s,e){s.default=e}),no=Q&&Q.__importStar||function(s){if(s&&s.__esModule)return s;var e={};if(s!=null)for(var t in s)t!=="default"&&Object.prototype.hasOwnProperty.call(s,t)&&so(e,s,t);return io(e,s),e};Object.defineProperty(Q,"__esModule",{value:!0});Q.OAuth2Helper=void 0;var ao=no(require("crypto")),hr=class{static getCodeVerifier(){return this.generateRandomString(128)}static getCodeChallengeFromVerifier(e){return this.escapeBase64Url(ao.createHash("sha256").update(e).digest("base64"))}static getAuthHeader(e,t){let r=encodeURIComponent(e)+":"+encodeURIComponent(t);return Buffer.from(r).toString("base64")}static generateRandomString(e){let t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~";for(let i=0;i<e;i++)t+=r[Math.floor(Math.random()*r.length)];return t}static escapeBase64Url(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}};Q.OAuth2Helper=hr});var an=u(ke=>{"use strict";var Lt=ke&&ke.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ke,"__esModule",{value:!0});ke.ClientRequestMaker=void 0;var oo=K(),uo=Lt(Tt()),nn=Zi(),co=le(),lo=Lt(lr()),ho=Lt(ar()),ie=Lt(dr()),mo=mr(),Pe=class{constructor(e){this.rateLimits={},this.clientSettings={},e&&(this.clientSettings=e)}getRateLimits(){return this.rateLimits}saveRateLimit(e,t){this.rateLimits[e]=t}async send(e){var t,r,i,n,a;if(!((t=this.clientSettings.plugins)===null||t===void 0)&&t.length){let w=await this.applyPreRequestConfigHooks(e);if(w)return w}let o=this.getHttpRequestArgs(e),c={method:o.method,headers:o.headers,timeout:e.timeout,agent:this.clientSettings.httpAgent},m=e.enableRateLimitSave!==!1;o.body&&ie.default.setBodyLengthHeader(c,o.body),!((r=this.clientSettings.plugins)===null||r===void 0)&&r.length&&await this.applyPreRequestHooks(e,o,c);let h=new ho.default({url:o.url,options:c,body:o.body,rateLimitSaver:m?this.saveRateLimit.bind(this,o.rawUrl):void 0,requestEventDebugHandler:e.requestEventDebugHandler,compression:(n=(i=e.compression)!==null&&i!==void 0?i:this.clientSettings.compression)!==null&&n!==void 0?n:!0,forceParseMode:e.forceParseMode}).makeRequest();(0,nn.hasRequestErrorPlugins)(this)&&(h=this.applyResponseErrorHooks(e,o,c,h));let f=await h;if(!((a=this.clientSettings.plugins)===null||a===void 0)&&a.length){let w=await this.applyPostRequestHooks(e,o,c,f);if(w)return w.value}return f}sendStream(e){var t,r;this.clientSettings.plugins&&this.applyPreStreamRequestConfigHooks(e);let i=this.getHttpRequestArgs(e),n={method:i.method,headers:i.headers,agent:this.clientSettings.httpAgent},a=e.enableRateLimitSave!==!1,o=e.autoConnect!==!1;i.body&&ie.default.setBodyLengthHeader(n,i.body);let c={url:i.url,options:n,body:i.body,rateLimitSaver:a?this.saveRateLimit.bind(this,i.rawUrl):void 0,payloadIsError:e.payloadIsError,compression:(r=(t=e.compression)!==null&&t!==void 0?t:this.clientSettings.compression)!==null&&r!==void 0?r:!0},m=new uo.default(c);return o?m.connect():m}initializeToken(e){if(typeof e=="string")this.bearerToken=e;else if(typeof e=="object"&&"appKey"in e)this.consumerToken=e.appKey,this.consumerSecret=e.appSecret,e.accessToken&&e.accessSecret&&(this.accessToken=e.accessToken,this.accessSecret=e.accessSecret),this._oauth=this.buildOAuth();else if(typeof e=="object"&&"username"in e){let t=encodeURIComponent(e.username)+":"+encodeURIComponent(e.password);this.basicToken=Buffer.from(t).toString("base64")}else typeof e=="object"&&"clientId"in e&&(this.clientId=e.clientId,this.clientSecret=e.clientSecret)}getActiveTokens(){return this.bearerToken?{type:"oauth2",bearerToken:this.bearerToken}:this.basicToken?{type:"basic",token:this.basicToken}:this.consumerSecret&&this._oauth?{type:"oauth-1.0a",appKey:this.consumerToken,appSecret:this.consumerSecret,accessToken:this.accessToken,accessSecret:this.accessSecret}:this.clientId?{type:"oauth2-user",clientId:this.clientId}:{type:"none"}}buildOAuth(){if(!this.consumerSecret||!this.consumerToken)throw new Error("Invalid consumer tokens");return new lo.default({consumerKeys:{key:this.consumerToken,secret:this.consumerSecret}})}getOAuthAccessTokens(){if(!(!this.accessSecret||!this.accessToken))return{key:this.accessToken,secret:this.accessSecret}}getPlugins(){var e;return(e=this.clientSettings.plugins)!==null&&e!==void 0?e:[]}hasPlugins(){var e;return!!(!((e=this.clientSettings.plugins)===null||e===void 0)&&e.length)}async applyPluginMethod(e,t){var r;let i;for(let n of this.getPlugins()){let a=await((r=n[e])===null||r===void 0?void 0:r.call(n,t));a&&a instanceof oo.TwitterApiPluginResponseOverride&&(i=a)}return i}writeAuthHeaders({headers:e,bodyInSignature:t,url:r,method:i,query:n,body:a}){if(e={...e},this.bearerToken)e.Authorization="Bearer "+this.bearerToken;else if(this.basicToken)e.Authorization="Basic "+this.basicToken;else if(this.clientId&&this.clientSecret)e.Authorization="Basic "+mo.OAuth2Helper.getAuthHeader(this.clientId,this.clientSecret);else if(this.consumerSecret&&this._oauth){let o=t?ie.default.mergeQueryAndBodyForOAuth(n,a):n,c=this._oauth.authorize({url:r.toString(),method:i,data:o},this.getOAuthAccessTokens());e={...e,...this._oauth.toHeader(c)}}return e}getUrlObjectFromUrlString(e){return e.startsWith("http")||(e="https://"+e),new URL(e)}getHttpRequestArgs({url:e,method:t,query:r={},body:i={},headers:n,forceBodyMode:a,enableAuth:o,params:c}){let m;t=t.toUpperCase(),n=n??{},n["x-user-agent"]||(n["x-user-agent"]="Node.twitter-api-v2");let h=this.getUrlObjectFromUrlString(e),f=h.origin+h.pathname;c&&ie.default.applyRequestParametersToUrl(h,c);let w=ie.default.formatQueryToString(r);ie.default.moveUrlQueryParamsIntoObject(h,w),i instanceof Buffer||(0,co.trimUndefinedProperties)(i);let te=a??ie.default.autoDetectBodyType(h);if(o!==!1){let oe=Pe.BODY_METHODS.has(t)&&te==="url";n=this.writeAuthHeaders({headers:n,bodyInSignature:oe,method:t,query:w,url:h,body:i})}return Pe.BODY_METHODS.has(t)&&(m=ie.default.constructBodyParams(i,n,te)||void 0),ie.default.addQueryParamsToUrl(h,w),{rawUrl:f,url:h,method:t,headers:n,body:m}}async applyPreRequestConfigHooks(e){var t;let r=this.getUrlObjectFromUrlString(e.url);for(let i of this.getPlugins()){let n=await((t=i.onBeforeRequestConfig)===null||t===void 0?void 0:t.call(i,{client:this,url:r,params:e}));if(n)return n}}applyPreStreamRequestConfigHooks(e){var t;let r=this.getUrlObjectFromUrlString(e.url);for(let i of this.getPlugins())(t=i.onBeforeStreamRequestConfig)===null||t===void 0||t.call(i,{client:this,url:r,params:e})}async applyPreRequestHooks(e,t,r){await this.applyPluginMethod("onBeforeRequest",{client:this,url:this.getUrlObjectFromUrlString(e.url),params:e,computedParams:t,requestOptions:r})}async applyPostRequestHooks(e,t,r,i){return await this.applyPluginMethod("onAfterRequest",{client:this,url:this.getUrlObjectFromUrlString(e.url),params:e,computedParams:t,requestOptions:r,response:i})}applyResponseErrorHooks(e,t,r,i){return i.catch(nn.applyResponseHooks.bind(this,e,t,r))}};ke.ClientRequestMaker=Pe;Pe.BODY_METHODS=new Set(["POST","PUT","PATCH"])});var _r=u(fr=>{"use strict";Object.defineProperty(fr,"__esModule",{value:!0});var fo=an(),on=le(),un=C(),et=class{constructor(e,t={}){this._currentUser=null,this._currentUserV2=null,e instanceof et?this._requestMaker=e._requestMaker:(this._requestMaker=new fo.ClientRequestMaker(t),this._requestMaker.initializeToken(e))}setPrefix(e){this._prefix=e}cloneWithPrefix(e){let t=this.constructor(this);return t.setPrefix(e),t}getActiveTokens(){return this._requestMaker.getActiveTokens()}getPlugins(){return this._requestMaker.getPlugins()}getPluginOfType(e){return this.getPlugins().find(t=>t instanceof e)}hasHitRateLimit(e){var t;return this.isRateLimitStatusObsolete(e)?!1:((t=this.getLastRateLimitStatus(e))===null||t===void 0?void 0:t.remaining)===0}isRateLimitStatusObsolete(e){let t=this.getLastRateLimitStatus(e);return t===void 0?!0:t.reset*1e3<Date.now()}getLastRateLimitStatus(e){let t=e.match(/^https?:\/\//)?e:this._prefix+e;return this._requestMaker.getRateLimits()[t]}getCurrentUserObject(e=!1){return!e&&this._currentUser?this._currentUser.value?Promise.resolve(this._currentUser.value):this._currentUser.promise:(this._currentUser=(0,on.sharedPromise)(()=>this.get("account/verify_credentials.json",{tweet_mode:"extended"},{prefix:un.API_V1_1_PREFIX})),this._currentUser.promise)}getCurrentUserV2Object(e=!1){return!e&&this._currentUserV2?this._currentUserV2.value?Promise.resolve(this._currentUserV2.value):this._currentUserV2.promise:(this._currentUserV2=(0,on.sharedPromise)(()=>this.get("users/me",void 0,{prefix:un.API_V2_PREFIX})),this._currentUserV2.promise)}async get(e,t={},{fullResponse:r,prefix:i=this._prefix,...n}={}){i&&(e=i+e);let a=await this._requestMaker.send({url:e,method:"GET",query:t,...n});return r?a:a.data}async delete(e,t={},{fullResponse:r,prefix:i=this._prefix,...n}={}){i&&(e=i+e);let a=await this._requestMaker.send({url:e,method:"DELETE",query:t,...n});return r?a:a.data}async post(e,t,{fullResponse:r,prefix:i=this._prefix,...n}={}){i&&(e=i+e);let a=await this._requestMaker.send({url:e,method:"POST",body:t,...n});return r?a:a.data}async put(e,t,{fullResponse:r,prefix:i=this._prefix,...n}={}){i&&(e=i+e);let a=await this._requestMaker.send({url:e,method:"PUT",body:t,...n});return r?a:a.data}async patch(e,t,{fullResponse:r,prefix:i=this._prefix,...n}={}){i&&(e=i+e);let a=await this._requestMaker.send({url:e,method:"PATCH",body:t,...n});return r?a:a.data}getStream(e,t,{prefix:r=this._prefix,...i}={}){return this._requestMaker.sendStream({url:r?r+e:e,method:"GET",query:t,...i})}postStream(e,t,{prefix:r=this._prefix,...i}={}){return this._requestMaker.sendStream({url:r?r+e:e,method:"POST",body:t,...i})}};fr.default=et});var Mt=u(tt=>{"use strict";var _o=tt&&tt.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(tt,"__esModule",{value:!0});var cn=_o(_r()),pr=class extends cn.default{constructor(e){if(!(e instanceof cn.default))throw new Error("You must instance SubTwitterApi instance from existing TwitterApi instance.");super(e)}};tt.default=pr});var br=u(j=>{"use strict";var po=j&&j.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(j,"__esModule",{value:!0});j.UserFavoritesV1Paginator=j.ListTimelineV1Paginator=j.UserTimelineV1Paginator=j.MentionTimelineV1Paginator=j.HomeTimelineV1Paginator=void 0;var go=po(Ie()),be=class extends go.default{constructor(){super(...arguments),this.hasFinishedFetch=!1}refreshInstanceFromResult(e,t){let r=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.push(...r),this.hasFinishedFetch=r.length===0)}getNextQueryParams(e){let t=BigInt(this._realData[this._realData.length-1].id_str);return{...this.injectQueryParams(e),max_id:(t-BigInt(1)).toString()}}getPageLengthFromRequest(e){return e.data.length}isFetchLastOver(e){return!e.data.length}canFetchNextPage(e){return e.length>0}getItemArray(){return this.tweets}get tweets(){return this._realData}get done(){return super.done||this.hasFinishedFetch}},gr=class extends be{constructor(){super(...arguments),this._endpoint="statuses/home_timeline.json"}};j.HomeTimelineV1Paginator=gr;var wr=class extends be{constructor(){super(...arguments),this._endpoint="statuses/mentions_timeline.json"}};j.MentionTimelineV1Paginator=wr;var yr=class extends be{constructor(){super(...arguments),this._endpoint="statuses/user_timeline.json"}};j.UserTimelineV1Paginator=yr;var vr=class extends be{constructor(){super(...arguments),this._endpoint="lists/statuses.json"}};j.ListTimelineV1Paginator=vr;var Pr=class extends be{constructor(){super(...arguments),this._endpoint="favorites/list.json"}};j.UserFavoritesV1Paginator=Pr});var qr=u(Ee=>{"use strict";Object.defineProperty(Ee,"__esModule",{value:!0});Ee.MuteUserIdsV1Paginator=Ee.MuteUserListV1Paginator=void 0;var ln=ge(),Tr=class extends ln.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="mutes/users/list.json"}refreshInstanceFromResult(e,t){let r=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.users.push(...r.users),this._realData.next_cursor=r.next_cursor)}getPageLengthFromRequest(e){return e.data.users.length}getItemArray(){return this.users}get users(){return this._realData.users}};Ee.MuteUserListV1Paginator=Tr;var Rr=class extends ln.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="mutes/users/ids.json",this._maxResultsWhenFetchLast=5e3}refreshInstanceFromResult(e,t){let r=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.ids.push(...r.ids),this._realData.next_cursor=r.next_cursor)}getPageLengthFromRequest(e){return e.data.ids.length}getItemArray(){return this.ids}get ids(){return this._realData.ids}};Ee.MuteUserIdsV1Paginator=Rr});var Lr=u(Be=>{"use strict";Object.defineProperty(Be,"__esModule",{value:!0});Be.UserFollowerIdsV1Paginator=Be.UserFollowerListV1Paginator=void 0;var dn=ge(),Sr=class extends dn.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="followers/list.json"}refreshInstanceFromResult(e,t){let r=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.users.push(...r.users),this._realData.next_cursor=r.next_cursor)}getPageLengthFromRequest(e){return e.data.users.length}getItemArray(){return this.users}get users(){return this._realData.users}};Be.UserFollowerListV1Paginator=Sr;var Dr=class extends dn.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="followers/ids.json",this._maxResultsWhenFetchLast=5e3}refreshInstanceFromResult(e,t){let r=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.ids.push(...r.ids),this._realData.next_cursor=r.next_cursor)}getPageLengthFromRequest(e){return e.data.ids.length}getItemArray(){return this.ids}get ids(){return this._realData.ids}};Be.UserFollowerIdsV1Paginator=Dr});var jr=u(Ne=>{"use strict";Object.defineProperty(Ne,"__esModule",{value:!0});Ne.UserFollowersIdsV1Paginator=Ne.UserFriendListV1Paginator=void 0;var hn=ge(),Mr=class extends hn.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="friends/list.json"}refreshInstanceFromResult(e,t){let r=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.users.push(...r.users),this._realData.next_cursor=r.next_cursor)}getPageLengthFromRequest(e){return e.data.users.length}getItemArray(){return this.users}get users(){return this._realData.users}};Ne.UserFriendListV1Paginator=Mr;var Ir=class extends hn.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="friends/ids.json",this._maxResultsWhenFetchLast=5e3}refreshInstanceFromResult(e,t){let r=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.ids.push(...r.ids),this._realData.next_cursor=r.next_cursor)}getPageLengthFromRequest(e){return e.data.ids.length}getItemArray(){return this.ids}get ids(){return this._realData.ids}};Ne.UserFollowersIdsV1Paginator=Ir});var Ar=u(Y=>{"use strict";var wo=Y&&Y.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Y,"__esModule",{value:!0});Y.FriendshipsOutgoingV1Paginator=Y.FriendshipsIncomingV1Paginator=Y.UserSearchV1Paginator=void 0;var yo=wo(Ie()),vo=ge(),xr=class extends yo.default{constructor(){super(...arguments),this._endpoint="users/search.json"}refreshInstanceFromResult(e,t){let r=e.data;this._rateLimit=e.rateLimit,t&&this._realData.push(...r)}getNextQueryParams(e){var t;let r=Number((t=this._queryParams.page)!==null&&t!==void 0?t:"1");return{...this._queryParams,page:r+1,...e?{count:e}:{}}}getPageLengthFromRequest(e){return e.data.length}isFetchLastOver(e){return!e.data.length}canFetchNextPage(e){return e.length>0}getItemArray(){return this.users}get users(){return this._realData}};Y.UserSearchV1Paginator=xr;var It=class extends vo.CursoredV1Paginator{constructor(){super(...arguments),this._endpoint="friendships/incoming.json",this._maxResultsWhenFetchLast=5e3}refreshInstanceFromResult(e,t){let r=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.ids.push(...r.ids),this._realData.next_cursor=r.next_cursor)}getPageLengthFromRequest(e){return e.data.ids.length}getItemArray(){return this.ids}get ids(){return this._realData.ids}};Y.FriendshipsIncomingV1Paginator=It;var Or=class extends It{constructor(){super(...arguments),this._endpoint="friendships/outgoing.json"}};Y.FriendshipsOutgoingV1Paginator=Or});var Nr=u(N=>{"use strict";Object.defineProperty(N,"__esModule",{value:!0});N.ListSubscribersV1Paginator=N.ListMembersV1Paginator=N.ListSubscriptionsV1Paginator=N.ListOwnershipsV1Paginator=N.ListMembershipsV1Paginator=void 0;var mn=ge(),rt=class extends mn.CursoredV1Paginator{refreshInstanceFromResult(e,t){let r=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.lists.push(...r.lists),this._realData.next_cursor=r.next_cursor)}getPageLengthFromRequest(e){return e.data.lists.length}getItemArray(){return this.lists}get lists(){return this._realData.lists}},Fr=class extends rt{constructor(){super(...arguments),this._endpoint="lists/memberships.json"}};N.ListMembershipsV1Paginator=Fr;var Ur=class extends rt{constructor(){super(...arguments),this._endpoint="lists/ownerships.json"}};N.ListOwnershipsV1Paginator=Ur;var kr=class extends rt{constructor(){super(...arguments),this._endpoint="lists/subscriptions.json"}};N.ListSubscriptionsV1Paginator=kr;var jt=class extends mn.CursoredV1Paginator{refreshInstanceFromResult(e,t){let r=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.users.push(...r.users),this._realData.next_cursor=r.next_cursor)}getPageLengthFromRequest(e){return e.data.users.length}getItemArray(){return this.users}get users(){return this._realData.users}},Er=class extends jt{constructor(){super(...arguments),this._endpoint="lists/members.json"}};N.ListMembersV1Paginator=Er;var Br=class extends jt{constructor(){super(...arguments),this._endpoint="lists/subscribers.json"}};N.ListSubscribersV1Paginator=Br});var Wr=u(it=>{"use strict";var gn=it&&it.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(it,"__esModule",{value:!0});var Po=gn(Mt()),Vr=C(),bo=le(),To=gn(xt()),Te=br(),fn=qr(),_n=Lr(),pn=jr(),Cr=Ar(),st=Nr(),Hr=class extends Po.default{constructor(){super(...arguments),this._prefix=Vr.API_V1_1_PREFIX}singleTweet(e,t={}){return this.get("statuses/show.json",{tweet_mode:"extended",id:e,...t})}tweets(e,t={}){return this.post("statuses/lookup.json",{tweet_mode:"extended",id:e,...t})}oembedTweet(e,t={}){return this.get("oembed",{url:`https://twitter.com/i/statuses/${e}`,...t},{prefix:"https://publish.twitter.com/"})}async homeTimeline(e={}){let t={tweet_mode:"extended",...e},r=await this.get("statuses/home_timeline.json",t,{fullResponse:!0});return new Te.HomeTimelineV1Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:t})}async mentionTimeline(e={}){let t={tweet_mode:"extended",...e},r=await this.get("statuses/mentions_timeline.json",t,{fullResponse:!0});return new Te.MentionTimelineV1Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:t})}async userTimeline(e,t={}){let r={tweet_mode:"extended",user_id:e,...t},i=await this.get("statuses/user_timeline.json",r,{fullResponse:!0});return new Te.UserTimelineV1Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:r})}async userTimelineByUsername(e,t={}){let r={tweet_mode:"extended",screen_name:e,...t},i=await this.get("statuses/user_timeline.json",r,{fullResponse:!0});return new Te.UserTimelineV1Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:r})}async favoriteTimeline(e,t={}){let r={tweet_mode:"extended",user_id:e,...t},i=await this.get("favorites/list.json",r,{fullResponse:!0});return new Te.UserFavoritesV1Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:r})}async favoriteTimelineByUsername(e,t={}){let r={tweet_mode:"extended",screen_name:e,...t},i=await this.get("favorites/list.json",r,{fullResponse:!0});return new Te.UserFavoritesV1Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:r})}user(e){return this.get("users/show.json",{tweet_mode:"extended",...e})}users(e){return this.get("users/lookup.json",{tweet_mode:"extended",...e})}verifyCredentials(e={}){return this.get("account/verify_credentials.json",e)}async listMutedUsers(e={}){let t={tweet_mode:"extended",...e},r=await this.get("mutes/users/list.json",t,{fullResponse:!0});return new fn.MuteUserListV1Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:t})}async listMutedUserIds(e={}){let t={stringify_ids:!0,...e},r=await this.get("mutes/users/ids.json",t,{fullResponse:!0});return new fn.MuteUserIdsV1Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:t})}async userFriendList(e={}){let t={...e},r=await this.get("friends/list.json",t,{fullResponse:!0});return new pn.UserFriendListV1Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:t})}async userFollowerList(e={}){let t={...e},r=await this.get("followers/list.json",t,{fullResponse:!0});return new _n.UserFollowerListV1Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:t})}async userFollowerIds(e={}){let t={stringify_ids:!0,...e},r=await this.get("followers/ids.json",t,{fullResponse:!0});return new _n.UserFollowerIdsV1Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:t})}async userFollowingIds(e={}){let t={stringify_ids:!0,...e},r=await this.get("friends/ids.json",t,{fullResponse:!0});return new pn.UserFollowersIdsV1Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:t})}async searchUsers(e,t={}){let r={q:e,tweet_mode:"extended",page:1,...t},i=await this.get("users/search.json",r,{fullResponse:!0});return new Cr.UserSearchV1Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:r})}friendship(e){return this.get("friendships/show.json",e)}friendships(e){return this.get("friendships/lookup.json",e)}friendshipsNoRetweets(){return this.get("friendships/no_retweets/ids.json",{stringify_ids:!0})}async friendshipsIncoming(e={}){let t={stringify_ids:!0,...e},r=await this.get("friendships/incoming.json",t,{fullResponse:!0});return new Cr.FriendshipsIncomingV1Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:t})}async friendshipsOutgoing(e={}){let t={stringify_ids:!0,...e},r=await this.get("friendships/outgoing.json",t,{fullResponse:!0});return new Cr.FriendshipsOutgoingV1Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:t})}accountSettings(){return this.get("account/settings.json")}userProfileBannerSizes(e){return this.get("users/profile_banner.json",e)}list(e){return this.get("lists/show.json",{tweet_mode:"extended",...e})}lists(e={}){return this.get("lists/list.json",{tweet_mode:"extended",...e})}async listMembers(e={}){let t={tweet_mode:"extended",...e},r=await this.get("lists/members.json",t,{fullResponse:!0});return new st.ListMembersV1Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:t})}listGetMember(e){return this.get("lists/members/show.json",{tweet_mode:"extended",...e})}async listMemberships(e={}){let t={tweet_mode:"extended",...e},r=await this.get("lists/memberships.json",t,{fullResponse:!0});return new st.ListMembershipsV1Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:t})}async listOwnerships(e={}){let t={tweet_mode:"extended",...e},r=await this.get("lists/ownerships.json",t,{fullResponse:!0});return new st.ListOwnershipsV1Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:t})}async listStatuses(e){let t={tweet_mode:"extended",...e},r=await this.get("lists/statuses.json",t,{fullResponse:!0});return new Te.ListTimelineV1Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:t})}async listSubscribers(e={}){let t={tweet_mode:"extended",...e},r=await this.get("lists/subscribers.json",t,{fullResponse:!0});return new st.ListSubscribersV1Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:t})}listGetSubscriber(e){return this.get("lists/subscribers/show.json",{tweet_mode:"extended",...e})}async listSubscriptions(e={}){let t={tweet_mode:"extended",...e},r=await this.get("lists/subscriptions.json",t,{fullResponse:!0});return new st.ListSubscriptionsV1Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:t})}mediaInfo(e){return this.get("media/upload.json",{command:"STATUS",media_id:e},{prefix:Vr.API_V1_1_UPLOAD_PREFIX})}filterStream({autoConnect:e,...t}={}){let r={};for(let[n,a]of Object.entries(t))if(n==="follow"||n==="track")r[n]=a.toString();else if(n==="locations"){let o=a;r.locations=(0,bo.arrayWrap)(o).map(c=>`${c.lng},${c.lat}`).join(",")}else r[n]=a;return this.stream.postStream("statuses/filter.json",r,{autoConnect:e})}sampleStream({autoConnect:e,...t}={}){return this.stream.getStream("statuses/sample.json",t,{autoConnect:e})}get stream(){let e=new To.default(this);return e.setPrefix(Vr.API_V1_1_STREAM_PREFIX),e}trendsByPlace(e,t={}){return this.get("trends/place.json",{id:e,...t})}trendsAvailable(){return this.get("trends/available.json")}trendsClosest(e,t){return this.get("trends/closest.json",{lat:e,long:t})}geoPlace(e){return this.get("geo/id/:place_id.json",void 0,{params:{place_id:e}})}geoSearch(e){return this.get("geo/search.json",e)}geoReverseGeoCode(e){return this.get("geo/reverse_geocode.json",e)}rateLimitStatuses(...e){return this.get("application/rate_limit_status.json",{resources:e})}supportedLanguages(){return this.get("help/languages.json")}};it.default=Hr});var vn=u(y=>{"use strict";var Ro=y&&y.__createBinding||(Object.create?function(s,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,r,i)}:function(s,e,t,r){r===void 0&&(r=t),s[r]=e[t]}),qo=y&&y.__setModuleDefault||(Object.create?function(s,e){Object.defineProperty(s,"default",{enumerable:!0,value:e})}:function(s,e){s.default=e}),So=y&&y.__importStar||function(s){if(s&&s.__esModule)return s;var e={};if(s!=null)for(var t in s)t!=="default"&&Object.prototype.hasOwnProperty.call(s,t)&&Ro(e,s,t);return qo(e,s),e};Object.defineProperty(y,"__esModule",{value:!0});y.readNextPartOf=y.sleepSecs=y.getMediaCategoryByMime=y.getMimeType=y.getFileSizeFromFileHandle=y.getFileHandle=y.readFileIntoBuffer=void 0;var Ot=So(require("fs")),wn=le(),b=K();async function Do(s){let e=await yn(s);return typeof e=="number"?new Promise((t,r)=>{Ot.readFile(e,(i,n)=>{if(i)return r(i);t(n)})}):e instanceof Buffer?e:e.readFile()}y.readFileIntoBuffer=Do;function yn(s){if(typeof s=="string")return Ot.promises.open(s,"r");if(typeof s=="number")return s;if(typeof s=="object"&&!(s instanceof Buffer))return s;if(s instanceof Buffer)return s;throw new Error("Given file is not valid, please check its type.")}y.getFileHandle=yn;async function Lo(s){return typeof s=="number"?(await new Promise((t,r)=>{Ot.fstat(s,(i,n)=>{i&&r(i),t(n)})})).size:s instanceof Buffer?s.length:(await s.stat()).size}y.getFileSizeFromFileHandle=Lo;function Mo(s,e,t){if(typeof t=="string")return t;if(typeof s=="string"&&!e)return Io(s);if(typeof e=="string")return jo(e);throw new Error("You must specify type if file is a file handle or Buffer.")}y.getMimeType=Mo;function Io(s){return s.endsWith(".jpeg")||s.endsWith(".jpg")?b.EUploadMimeType.Jpeg:s.endsWith(".png")?b.EUploadMimeType.Png:s.endsWith(".webp")?b.EUploadMimeType.Webp:s.endsWith(".gif")?b.EUploadMimeType.Gif:s.endsWith(".mpeg4")||s.endsWith(".mp4")?b.EUploadMimeType.Mp4:s.endsWith(".mov")||s.endsWith(".mov")?b.EUploadMimeType.Mov:s.endsWith(".srt")?b.EUploadMimeType.Srt:((0,wn.safeDeprecationWarning)({instance:"TwitterApiv1ReadWrite",method:"uploadMedia",problem:"options.mimeType is missing and filename couldn't help to resolve MIME type, so it will fallback to image/jpeg",resolution:"If you except to give filenames without extensions, please specify explicitlty the MIME type using options.mimeType"}),b.EUploadMimeType.Jpeg)}function jo(s){return(0,wn.safeDeprecationWarning)({instance:"TwitterApiv1ReadWrite",method:"uploadMedia",problem:"you're using options.type",resolution:"Remove options.type argument and migrate to options.mimeType which takes the real MIME type. If you're using type=longmp4, add options.longVideo alongside of mimeType=EUploadMimeType.Mp4"}),s==="gif"?b.EUploadMimeType.Gif:s==="jpg"?b.EUploadMimeType.Jpeg:s==="png"?b.EUploadMimeType.Png:s==="webp"?b.EUploadMimeType.Webp:s==="srt"?b.EUploadMimeType.Srt:s==="mp4"||s==="longmp4"?b.EUploadMimeType.Mp4:s==="mov"?b.EUploadMimeType.Mov:s}function xo(s,e){return s===b.EUploadMimeType.Mp4||s===b.EUploadMimeType.Mov?e==="tweet"?"TweetVideo":"DmVideo":s===b.EUploadMimeType.Gif?e==="tweet"?"TweetGif":"DmGif":s===b.EUploadMimeType.Srt?"Subtitles":e==="tweet"?"TweetImage":"DmImage"}y.getMediaCategoryByMime=xo;function Oo(s){return new Promise(e=>setTimeout(e,s*1e3))}y.sleepSecs=Oo;async function Ao(s,e,t=0,r){if(s instanceof Buffer){let n=s.slice(t,t+e);return[n,n.length]}if(!r)throw new Error("Well, we will need a buffer to store file content.");let i;return typeof s=="number"?i=await new Promise((n,a)=>{Ot.read(s,r,0,e,t,(o,c)=>{o&&a(o),n(c)})}):i=(await s.read(r,0,e,t)).bytesRead,[r,i]}y.readNextPartOf=Ao});var Xr=u(W=>{"use strict";var Fo=W&&W.__createBinding||(Object.create?function(s,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,r,i)}:function(s,e,t,r){r===void 0&&(r=t),s[r]=e[t]}),Uo=W&&W.__setModuleDefault||(Object.create?function(s,e){Object.defineProperty(s,"default",{enumerable:!0,value:e})}:function(s,e){s.default=e}),ko=W&&W.__importStar||function(s){if(s&&s.__esModule)return s;var e={};if(s!=null)for(var t in s)t!=="default"&&Object.prototype.hasOwnProperty.call(s,t)&&Fo(e,s,t);return Uo(e,s),e},Eo=W&&W.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(W,"__esModule",{value:!0});var Pn=ko(require("fs")),Re=C(),At=le(),Bo=K(),No=Eo(Wr()),J=vn(),$r="media/upload.json",zr=class extends No.default{constructor(){super(...arguments),this._prefix=Re.API_V1_1_PREFIX}get readOnly(){return this}tweet(e,t={}){let r={status:e,tweet_mode:"extended",...t};return this.post("statuses/update.json",r)}async quote(e,t,r={}){let i="https://twitter.com/i/statuses/"+t;return this.tweet(e,{...r,attachment_url:i})}async tweetThread(e){let t=[];for(let r of e){let i=t.length?t[t.length-1]:null,n={...typeof r=="string"?{status:r}:r},a=i?i.id_str:n.in_reply_to_status_id,o=n.status;a?t.push(await this.reply(o,a,n)):t.push(await this.tweet(o,n))}return t}reply(e,t,r={}){return this.tweet(e,{auto_populate_reply_metadata:!0,in_reply_to_status_id:t,...r})}deleteTweet(e){return this.post("statuses/destroy/:id.json",{tweet_mode:"extended"},{params:{id:e}})}reportUserAsSpam(e){return this.post("users/report_spam.json",{tweet_mode:"extended",...e})}updateFriendship(e){return this.post("friendships/update.json",e)}createFriendship(e){return this.post("friendships/create.json",e)}destroyFriendship(e){return this.post("friendships/destroy.json",e)}updateAccountSettings(e){return this.post("account/settings.json",e)}updateAccountProfile(e){return this.post("account/update_profile.json",e)}async updateAccountProfileBanner(e,t={}){let r={banner:await(0,J.readFileIntoBuffer)(e),...t};return this.post("account/update_profile_banner.json",r,{forceBodyMode:"form-data"})}async updateAccountProfileImage(e,t={}){let r={tweet_mode:"extended",image:await(0,J.readFileIntoBuffer)(e),...t};return this.post("account/update_profile_image.json",r,{forceBodyMode:"form-data"})}removeAccountProfileBanner(){return this.post("account/remove_profile_banner.json")}createList(e){return this.post("lists/create.json",{tweet_mode:"extended",...e})}updateList(e){return this.post("lists/update.json",{tweet_mode:"extended",...e})}removeList(e){return this.post("lists/destroy.json",{tweet_mode:"extended",...e})}addListMembers(e){let r=e.user_id&&(0,At.hasMultipleItems)(e.user_id)||e.screen_name&&(0,At.hasMultipleItems)(e.screen_name)?"lists/members/create_all.json":"lists/members/create.json";return this.post(r,e)}removeListMembers(e){let r=e.user_id&&(0,At.hasMultipleItems)(e.user_id)||e.screen_name&&(0,At.hasMultipleItems)(e.screen_name)?"lists/members/destroy_all.json":"lists/members/destroy.json";return this.post(r,e)}subscribeToList(e){return this.post("lists/subscribers/create.json",{tweet_mode:"extended",...e})}unsubscribeOfList(e){return this.post("lists/subscribers/destroy.json",{tweet_mode:"extended",...e})}createMediaMetadata(e,t){return this.post("media/metadata/create.json",{media_id:e,...t},{prefix:Re.API_V1_1_UPLOAD_PREFIX,forceBodyMode:"json"})}createMediaSubtitles(e,t){return this.post("media/subtitles/create.json",{media_id:e,media_category:"TweetVideo",subtitle_info:{subtitles:t}},{prefix:Re.API_V1_1_UPLOAD_PREFIX,forceBodyMode:"json"})}deleteMediaSubtitles(e,...t){return this.post("media/subtitles/delete.json",{media_id:e,media_category:"TweetVideo",subtitle_info:{subtitles:t.map(r=>({language_code:r}))}},{prefix:Re.API_V1_1_UPLOAD_PREFIX,forceBodyMode:"json"})}async uploadMedia(e,t={},r=!1){var i;let n=(i=t.chunkLength)!==null&&i!==void 0?i:1048576,{fileHandle:a,mediaCategory:o,fileSize:c,mimeType:m}=await this.getUploadMediaRequirements(e,t);try{let h=await this.post($r,{command:"INIT",total_bytes:c,media_type:m,media_category:o,additional_owners:t.additionalOwners,shared:t.shared?!0:void 0},{prefix:Re.API_V1_1_UPLOAD_PREFIX});await this.mediaChunkedUpload(a,n,h.media_id_string,t.maxConcurrentUploads);let f=await this.post($r,{command:"FINALIZE",media_id:h.media_id_string},{prefix:Re.API_V1_1_UPLOAD_PREFIX});return f.processing_info&&f.processing_info.state!=="succeeded"&&await this.awaitForMediaProcessingCompletion(f),r?f:f.media_id_string}finally{typeof e=="number"?Pn.close(e,()=>{}):typeof a=="object"&&!(a instanceof Buffer)&&a.close()}}async awaitForMediaProcessingCompletion(e){for(var t;;){e=await this.mediaInfo(e.media_id_string);let{processing_info:r}=e;if(!r||r.state==="succeeded")return;if(!((t=r.error)===null||t===void 0)&&t.code){let{name:i,message:n}=r.error;throw new Error(`Failed to process media: ${i} - ${n}.`)}if(r.state==="failed")throw new Error("Failed to process the media.");r.check_after_secs?await(0,J.sleepSecs)(r.check_after_secs):await(0,J.sleepSecs)(5)}}async getUploadMediaRequirements(e,{mimeType:t,type:r,target:i,longVideo:n}={}){let a;try{a=await(0,J.getFileHandle)(e);let o=(0,J.getMimeType)(e,r,t),c;return o===Bo.EUploadMimeType.Mp4&&(!t&&!r&&i!=="dm"||n)?c="amplify_video":c=(0,J.getMediaCategoryByMime)(o,i??"tweet"),{fileHandle:a,mediaCategory:c,fileSize:await(0,J.getFileSizeFromFileHandle)(a),mimeType:o}}catch(o){throw typeof e=="number"?Pn.close(e,()=>{}):typeof a=="object"&&!(a instanceof Buffer)&&a.close(),o}}async mediaChunkedUpload(e,t,r,i=3){let n=0;if(i<1)throw new RangeError("Bad maxConcurrentUploads parameter.");let a=e instanceof Buffer?void 0:Buffer.alloc(t),o,c,m=0;[o,c]=await(0,J.readNextPartOf)(e,t,m,a),m+=c;let h=new Set;for(;c;){let f=o.slice(0,c);if(f.length){let w=this.post($r,{command:"APPEND",media_id:r,segment_index:n,media:f},{prefix:Re.API_V1_1_UPLOAD_PREFIX});h.add(w),w.then(()=>{h.delete(w)}),n++}h.size>=i&&await Promise.race(h),[o,c]=await(0,J.readNextPartOf)(e,t,m,a),m+=c}await Promise.all([...h])}};W.default=zr});var xt=u(qe=>{"use strict";var Vo=qe&&qe.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(qe,"__esModule",{value:!0});qe.TwitterApiv1=void 0;var Co=C(),bn=er(),nt=K(),Ho=Vo(Xr()),Ft=class extends Ho.default{constructor(){super(...arguments),this._prefix=Co.API_V1_1_PREFIX}get readWrite(){return this}sendDm({recipient_id:e,custom_profile_id:t,...r}){let i={event:{type:nt.EDirectMessageEventTypeV1.Create,[nt.EDirectMessageEventTypeV1.Create]:{target:{recipient_id:e},message_data:r}}};return t&&(i.event[nt.EDirectMessageEventTypeV1.Create].custom_profile_id=t),this.post("direct_messages/events/new.json",i,{forceBodyMode:"json"})}getDmEvent(e){return this.get("direct_messages/events/show.json",{id:e})}deleteDm(e){return this.delete("direct_messages/events/destroy.json",{id:e})}async listDmEvents(e={}){let t={...e},r=await this.get("direct_messages/events/list.json",t,{fullResponse:!0});return new bn.DmEventsV1Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:t})}newWelcomeDm(e,t){let r={[nt.EDirectMessageEventTypeV1.WelcomeCreate]:{name:e,message_data:t}};return this.post("direct_messages/welcome_messages/new.json",r,{forceBodyMode:"json"})}getWelcomeDm(e){return this.get("direct_messages/welcome_messages/show.json",{id:e})}deleteWelcomeDm(e){return this.delete("direct_messages/welcome_messages/destroy.json",{id:e})}updateWelcomeDm(e,t){let r={message_data:t};return this.put("direct_messages/welcome_messages/update.json",r,{forceBodyMode:"json",query:{id:e}})}async listWelcomeDms(e={}){let t={...e},r=await this.get("direct_messages/welcome_messages/list.json",t,{fullResponse:!0});return new bn.WelcomeDmV1Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:t})}newWelcomeDmRule(e){return this.post("direct_messages/welcome_messages/rules/new.json",{welcome_message_rule:{welcome_message_id:e}},{forceBodyMode:"json"})}getWelcomeDmRule(e){return this.get("direct_messages/welcome_messages/rules/show.json",{id:e})}deleteWelcomeDmRule(e){return this.delete("direct_messages/welcome_messages/rules/destroy.json",{id:e})}async listWelcomeDmRules(e={}){let t={...e};return this.get("direct_messages/welcome_messages/rules/list.json",t)}async setWelcomeDm(e,t=!0){var r;let i=await this.listWelcomeDmRules();if(!((r=i.welcome_message_rules)===null||r===void 0)&&r.length)for(let n of i.welcome_message_rules)await this.deleteWelcomeDmRule(n.id),t&&await this.deleteWelcomeDm(n.welcome_message_id);return this.newWelcomeDmRule(e)}markDmAsRead(e,t){return this.post("direct_messages/mark_read.json",{last_read_event_id:e,recipient_id:t},{forceBodyMode:"url"})}indicateDmTyping(e){return this.post("direct_messages/indicate_typing.json",{recipient_id:e},{forceBodyMode:"url"})}async downloadDmImage(e){if(typeof e!="string"){let r=e[nt.EDirectMessageEventTypeV1.Create].message_data.attachment;if(!r)throw new Error("The given direct message doesn't contain any attachment");e=r.media.media_url_https}let t=await this.get(e,void 0,{forceParseMode:"buffer",prefix:""});if(!t.length)throw new Error("Image not found. Make sure you are logged with credentials able to access direct messages, and check the URL.");return t}};qe.TwitterApiv1=Ft;qe.default=Ft});var Kr=u(Ut=>{"use strict";Object.defineProperty(Ut,"__esModule",{value:!0});Ut.TwitterV2IncludesHelper=void 0;var g=class{constructor(e){this.result=e}get tweets(){return g.tweets(this.result)}static tweets(e){var t,r;return(r=(t=e.includes)===null||t===void 0?void 0:t.tweets)!==null&&r!==void 0?r:[]}tweetById(e){return g.tweetById(this.result,e)}static tweetById(e,t){return this.tweets(e).find(r=>r.id===t)}retweet(e){return g.retweet(this.result,e)}static retweet(e,t){var r;let i=((r=t.referenced_tweets)!==null&&r!==void 0?r:[]).filter(n=>n.type==="retweeted").map(n=>n.id);return this.tweets(e).find(n=>i.includes(n.id))}quote(e){return g.quote(this.result,e)}static quote(e,t){var r;let i=((r=t.referenced_tweets)!==null&&r!==void 0?r:[]).filter(n=>n.type==="quoted").map(n=>n.id);return this.tweets(e).find(n=>i.includes(n.id))}repliedTo(e){return g.repliedTo(this.result,e)}static repliedTo(e,t){var r;let i=((r=t.referenced_tweets)!==null&&r!==void 0?r:[]).filter(n=>n.type==="replied_to").map(n=>n.id);return this.tweets(e).find(n=>i.includes(n.id))}author(e){return g.author(this.result,e)}static author(e,t){let r=t.author_id;return r?this.users(e).find(i=>i.id===r):void 0}repliedToAuthor(e){return g.repliedToAuthor(this.result,e)}static repliedToAuthor(e,t){let r=t.in_reply_to_user_id;return r?this.users(e).find(i=>i.id===r):void 0}get users(){return g.users(this.result)}static users(e){var t,r;return(r=(t=e.includes)===null||t===void 0?void 0:t.users)!==null&&r!==void 0?r:[]}userById(e){return g.userById(this.result,e)}static userById(e,t){return this.users(e).find(r=>r.id===t)}pinnedTweet(e){return g.pinnedTweet(this.result,e)}static pinnedTweet(e,t){return t.pinned_tweet_id?this.tweets(e).find(r=>r.id===t.pinned_tweet_id):void 0}get media(){return g.media(this.result)}static media(e){var t,r;return(r=(t=e.includes)===null||t===void 0?void 0:t.media)!==null&&r!==void 0?r:[]}medias(e){return g.medias(this.result,e)}static medias(e,t){var r,i;let n=(i=(r=t.attachments)===null||r===void 0?void 0:r.media_keys)!==null&&i!==void 0?i:[];return this.media(e).filter(a=>n.includes(a.media_key))}get polls(){return g.polls(this.result)}static polls(e){var t,r;return(r=(t=e.includes)===null||t===void 0?void 0:t.polls)!==null&&r!==void 0?r:[]}poll(e){return g.poll(this.result,e)}static poll(e,t){var r,i;let n=(i=(r=t.attachments)===null||r===void 0?void 0:r.poll_ids)!==null&&i!==void 0?i:[];if(n.length){let a=n[0];return this.polls(e).find(o=>o.id===a)}}get places(){return g.places(this.result)}static places(e){var t,r;return(r=(t=e.includes)===null||t===void 0?void 0:t.places)!==null&&r!==void 0?r:[]}place(e){return g.place(this.result,e)}static place(e,t){var r;let i=(r=t.geo)===null||r===void 0?void 0:r.place_id;return i?this.places(e).find(n=>n.id===i):void 0}listOwner(e){return g.listOwner(this.result,e)}static listOwner(e,t){let r=t.owner_id;return r?this.users(e).find(i=>i.id===r):void 0}spaceCreator(e){return g.spaceCreator(this.result,e)}static spaceCreator(e,t){let r=t.creator_id;return r?this.users(e).find(i=>i.id===r):void 0}spaceHosts(e){return g.spaceHosts(this.result,e)}static spaceHosts(e,t){var r;let i=(r=t.host_ids)!==null&&r!==void 0?r:[];return this.users(e).filter(n=>i.includes(n.id))}spaceSpeakers(e){return g.spaceSpeakers(this.result,e)}static spaceSpeakers(e,t){var r;let i=(r=t.speaker_ids)!==null&&r!==void 0?r:[];return this.users(e).filter(n=>i.includes(n.id))}spaceInvitedUsers(e){return g.spaceInvitedUsers(this.result,e)}static spaceInvitedUsers(e,t){var r;let i=(r=t.invited_user_ids)!==null&&r!==void 0?r:[];return this.users(e).filter(n=>i.includes(n.id))}};Ut.TwitterV2IncludesHelper=g});var at=u(Ve=>{"use strict";Object.defineProperty(Ve,"__esModule",{value:!0});Ve.TimelineV2Paginator=Ve.TwitterV2Paginator=void 0;var Tn=Kr(),Wo=Ie(),kt=class extends Wo.PreviousableTwitterPaginator{updateIncludes(e){if(e.errors&&(this._realData.errors||(this._realData.errors=[]),this._realData.errors=[...this._realData.errors,...e.errors]),!e.includes)return;this._realData.includes||(this._realData.includes={});let t=this._realData.includes;for(let[r,i]of Object.entries(e.includes))t[r]||(t[r]=[]),t[r]=[...t[r],...i]}assertUsable(){if(this.unusable)throw new Error("Unable to use this paginator to fetch more data, as it does not contain any metadata. Check .errors property for more details.")}get meta(){return this._realData.meta}get includes(){var e;return!((e=this._realData)===null||e===void 0)&&e.includes?this._includesInstance?this._includesInstance:this._includesInstance=new Tn.TwitterV2IncludesHelper(this._realData):new Tn.TwitterV2IncludesHelper(this._realData)}get errors(){var e;return(e=this._realData.errors)!==null&&e!==void 0?e:[]}get unusable(){return this.errors.length>0&&!this._realData.meta&&!this._realData.data}};Ve.TwitterV2Paginator=kt;var Qr=class extends kt{refreshInstanceFromResult(e,t){var r;let i=e.data,n=(r=i.data)!==null&&r!==void 0?r:[];this._rateLimit=e.rateLimit,this._realData.data||(this._realData.data=[]),t?(this._realData.meta.result_count+=i.meta.result_count,this._realData.meta.next_token=i.meta.next_token,this._realData.data.push(...n)):(this._realData.meta.result_count+=i.meta.result_count,this._realData.meta.previous_token=i.meta.previous_token,this._realData.data.unshift(...n)),this.updateIncludes(i)}getNextQueryParams(e){return this.assertUsable(),{...this.injectQueryParams(e),pagination_token:this._realData.meta.next_token}}getPreviousQueryParams(e){return this.assertUsable(),{...this.injectQueryParams(e),pagination_token:this._realData.meta.previous_token}}getPageLengthFromRequest(e){var t,r;return(r=(t=e.data.data)===null||t===void 0?void 0:t.length)!==null&&r!==void 0?r:0}isFetchLastOver(e){var t;return!(!((t=e.data.data)===null||t===void 0)&&t.length)||!this.canFetchNextPage(e.data)}canFetchNextPage(e){var t;return!!(!((t=e.meta)===null||t===void 0)&&t.next_token)}};Ve.TimelineV2Paginator=Qr});var Rn=u(P=>{"use strict";Object.defineProperty(P,"__esModule",{value:!0});P.TweetV2ListTweetsPaginator=P.TweetV2UserLikedTweetsPaginator=P.TweetBookmarksTimelineV2Paginator=P.TweetUserMentionTimelineV2Paginator=P.TweetUserTimelineV2Paginator=P.TweetHomeTimelineV2Paginator=P.QuotedTweetsTimelineV2Paginator=P.TweetSearchAllV2Paginator=P.TweetSearchRecentV2Paginator=void 0;var ns=at(),Et=class extends ns.TwitterV2Paginator{refreshInstanceFromResult(e,t){var r;let i=e.data,n=(r=i.data)!==null&&r!==void 0?r:[];this._rateLimit=e.rateLimit,this._realData.data||(this._realData.data=[]),t?(this._realData.meta.oldest_id=i.meta.oldest_id,this._realData.meta.result_count+=i.meta.result_count,this._realData.meta.next_token=i.meta.next_token,this._realData.data.push(...n)):(this._realData.meta.newest_id=i.meta.newest_id,this._realData.meta.result_count+=i.meta.result_count,this._realData.data.unshift(...n)),this.updateIncludes(i)}getNextQueryParams(e){this.assertUsable();let t={...this.injectQueryParams(e)};return this._realData.meta.next_token?t.next_token=this._realData.meta.next_token:(t.start_time&&(t.since_id=this.dateStringToSnowflakeId(t.start_time),delete t.start_time),t.end_time&&delete t.end_time,t.until_id=this._realData.meta.oldest_id),t}getPreviousQueryParams(e){return this.assertUsable(),{...this.injectQueryParams(e),since_id:this._realData.meta.newest_id}}getPageLengthFromRequest(e){var t,r;return(r=(t=e.data.data)===null||t===void 0?void 0:t.length)!==null&&r!==void 0?r:0}isFetchLastOver(e){var t;return!(!((t=e.data.data)===null||t===void 0)&&t.length)||!this.canFetchNextPage(e.data)}canFetchNextPage(e){return!!e.meta.next_token}getItemArray(){return this.tweets}dateStringToSnowflakeId(e){let t=BigInt("1288834974657"),r=new Date(e);if(isNaN(r.valueOf()))throw new Error("Unable to convert start_time/end_time to a valid date. A ISO 8601 DateTime is excepted, please check your input.");return(BigInt(r.valueOf())-t<<BigInt("22")).toString()}get tweets(){var e;return(e=this._realData.data)!==null&&e!==void 0?e:[]}get meta(){return super.meta}},Se=class extends ns.TimelineV2Paginator{refreshInstanceFromResult(e,t){super.refreshInstanceFromResult(e,t);let r=e.data;t?this._realData.meta.oldest_id=r.meta.oldest_id:this._realData.meta.newest_id=r.meta.newest_id}getItemArray(){return this.tweets}get tweets(){var e;return(e=this._realData.data)!==null&&e!==void 0?e:[]}get meta(){return super.meta}},Yr=class extends Et{constructor(){super(...arguments),this._endpoint="tweets/search/recent"}};P.TweetSearchRecentV2Paginator=Yr;var Jr=class extends Et{constructor(){super(...arguments),this._endpoint="tweets/search/all"}};P.TweetSearchAllV2Paginator=Jr;var Gr=class extends Se{constructor(){super(...arguments),this._endpoint="tweets/:id/quote_tweets"}};P.QuotedTweetsTimelineV2Paginator=Gr;var Zr=class extends Se{constructor(){super(...arguments),this._endpoint="users/:id/timelines/reverse_chronological"}};P.TweetHomeTimelineV2Paginator=Zr;var es=class extends Se{constructor(){super(...arguments),this._endpoint="users/:id/tweets"}};P.TweetUserTimelineV2Paginator=es;var ts=class extends Se{constructor(){super(...arguments),this._endpoint="users/:id/mentions"}};P.TweetUserMentionTimelineV2Paginator=ts;var rs=class extends Se{constructor(){super(...arguments),this._endpoint="users/:id/bookmarks"}};P.TweetBookmarksTimelineV2Paginator=rs;var Bt=class extends ns.TimelineV2Paginator{get tweets(){var e;return(e=this._realData.data)!==null&&e!==void 0?e:[]}get meta(){return super.meta}getItemArray(){return this.tweets}},ss=class extends Bt{constructor(){super(...arguments),this._endpoint="users/:id/liked_tweets"}};P.TweetV2UserLikedTweetsPaginator=ss;var is=class extends Bt{constructor(){super(...arguments),this._endpoint="lists/:id/tweets"}};P.TweetV2ListTweetsPaginator=is});var fs=u(R=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0});R.TweetRetweetersUsersV2Paginator=R.TweetLikingUsersV2Paginator=R.UserListFollowersV2Paginator=R.UserListMembersV2Paginator=R.UserFollowingV2Paginator=R.UserFollowersV2Paginator=R.UserMutingUsersV2Paginator=R.UserBlockingUsersV2Paginator=void 0;var $o=at(),G=class extends $o.TimelineV2Paginator{getItemArray(){return this.users}get users(){var e;return(e=this._realData.data)!==null&&e!==void 0?e:[]}get meta(){return super.meta}},as=class extends G{constructor(){super(...arguments),this._endpoint="users/:id/blocking"}};R.UserBlockingUsersV2Paginator=as;var os=class extends G{constructor(){super(...arguments),this._endpoint="users/:id/muting"}};R.UserMutingUsersV2Paginator=os;var us=class extends G{constructor(){super(...arguments),this._endpoint="users/:id/followers"}};R.UserFollowersV2Paginator=us;var cs=class extends G{constructor(){super(...arguments),this._endpoint="users/:id/following"}};R.UserFollowingV2Paginator=cs;var ls=class extends G{constructor(){super(...arguments),this._endpoint="lists/:id/members"}};R.UserListMembersV2Paginator=ls;var ds=class extends G{constructor(){super(...arguments),this._endpoint="lists/:id/followers"}};R.UserListFollowersV2Paginator=ds;var hs=class extends G{constructor(){super(...arguments),this._endpoint="tweets/:id/liking_users"}};R.TweetLikingUsersV2Paginator=hs;var ms=class extends G{constructor(){super(...arguments),this._endpoint="tweets/:id/retweeted_by"}};R.TweetRetweetersUsersV2Paginator=ms});var qn=u(he=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});he.UserListFollowedV2Paginator=he.UserListMembershipsV2Paginator=he.UserOwnedListsV2Paginator=void 0;var zo=at(),ot=class extends zo.TimelineV2Paginator{getItemArray(){return this.lists}get lists(){var e;return(e=this._realData.data)!==null&&e!==void 0?e:[]}get meta(){return super.meta}},_s=class extends ot{constructor(){super(...arguments),this._endpoint="users/:id/owned_lists"}};he.UserOwnedListsV2Paginator=_s;var ps=class extends ot{constructor(){super(...arguments),this._endpoint="users/:id/list_memberships"}};he.UserListMembershipsV2Paginator=ps;var gs=class extends ot{constructor(){super(...arguments),this._endpoint="users/:id/followed_lists"}};he.UserListFollowedV2Paginator=gs});var ws=u(S=>{"use strict";var Xo=S&&S.__createBinding||(Object.create?function(s,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,r,i)}:function(s,e,t,r){r===void 0&&(r=t),s[r]=e[t]}),$=S&&S.__exportStar||function(s,e){for(var t in s)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Xo(e,s,t)};Object.defineProperty(S,"__esModule",{value:!0});$(Rn(),S);$(Ie(),S);$(er(),S);$(qr(),S);$(br(),S);$(Ar(),S);$(fs(),S);$(Nr(),S);$(qn(),S);$(jr(),S);$(Lr(),S)});var vs=u(ut=>{"use strict";var Ko=ut&&ut.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ut,"__esModule",{value:!0});var Qo=Ko(Mt()),Yo=C(),ys=class extends Qo.default{constructor(){super(...arguments),this._prefix=Yo.API_V2_LABS_PREFIX}};ut.default=ys});var Sn=u(Z=>{"use strict";Object.defineProperty(Z,"__esModule",{value:!0});Z.ConversationDMTimelineV2Paginator=Z.OneToOneDMTimelineV2Paginator=Z.FullDMTimelineV2Paginator=Z.DMTimelineV2Paginator=void 0;var Jo=at(),Ce=class extends Jo.TimelineV2Paginator{getItemArray(){return this.events}get events(){var e;return(e=this._realData.data)!==null&&e!==void 0?e:[]}get meta(){return super.meta}};Z.DMTimelineV2Paginator=Ce;var Ps=class extends Ce{constructor(){super(...arguments),this._endpoint="dm_events"}};Z.FullDMTimelineV2Paginator=Ps;var bs=class extends Ce{constructor(){super(...arguments),this._endpoint="dm_conversations/with/:participant_id/dm_events"}};Z.OneToOneDMTimelineV2Paginator=bs;var Ts=class extends Ce{constructor(){super(...arguments),this._endpoint="dm_conversations/:dm_conversation_id/dm_events"}};Z.ConversationDMTimelineV2Paginator=Ts});var Ds=u(ct=>{"use strict";var Dn=ct&&ct.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ct,"__esModule",{value:!0});var Go=Dn(Mt()),Zo=C(),V=ws(),eu=Dn(vs()),me=fs(),Rs=le(),qs=Sn(),Ss=class extends Go.default{constructor(){super(...arguments),this._prefix=Zo.API_V2_PREFIX}get labs(){return this._labs?this._labs:this._labs=new eu.default(this)}async search(e,t={}){let r=typeof e=="string"?{...t,query:e}:{...e},i=await this.get("tweets/search/recent",r,{fullResponse:!0});return new V.TweetSearchRecentV2Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:r})}async searchAll(e,t={}){let r={...t,query:e},i=await this.get("tweets/search/all",r,{fullResponse:!0});return new V.TweetSearchAllV2Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:r})}singleTweet(e,t={}){return this.get("tweets/:id",t,{params:{id:e}})}tweets(e,t={}){return this.get("tweets",{ids:e,...t})}tweetCountRecent(e,t={}){return this.get("tweets/counts/recent",{query:e,...t})}tweetCountAll(e,t={}){return this.get("tweets/counts/all",{query:e,...t})}async tweetRetweetedBy(e,t={}){let{asPaginator:r,...i}=t,n=await this.get("tweets/:id/retweeted_by",i,{fullResponse:!0,params:{id:e}});return r?new me.TweetRetweetersUsersV2Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:i,sharedParams:{id:e}}):n.data}async tweetLikedBy(e,t={}){let{asPaginator:r,...i}=t,n=await this.get("tweets/:id/liking_users",i,{fullResponse:!0,params:{id:e}});return r?new me.TweetLikingUsersV2Paginator({realData:n.data,rateLimit:n.rateLimit,instance:this,queryParams:i,sharedParams:{id:e}}):n.data}async homeTimeline(e={}){let t=await this.getCurrentUserV2Object(),r=await this.get("users/:id/timelines/reverse_chronological",e,{fullResponse:!0,params:{id:t.data.id}});return new V.TweetHomeTimelineV2Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:e,sharedParams:{id:t.data.id}})}async userTimeline(e,t={}){let r=await this.get("users/:id/tweets",t,{fullResponse:!0,params:{id:e}});return new V.TweetUserTimelineV2Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:t,sharedParams:{id:e}})}async userMentionTimeline(e,t={}){let r=await this.get("users/:id/mentions",t,{fullResponse:!0,params:{id:e}});return new V.TweetUserMentionTimelineV2Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:t,sharedParams:{id:e}})}async quotes(e,t={}){let r=await this.get("tweets/:id/quote_tweets",t,{fullResponse:!0,params:{id:e}});return new V.QuotedTweetsTimelineV2Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:t,sharedParams:{id:e}})}async bookmarks(e={}){let t=await this.getCurrentUserV2Object(),r=await this.get("users/:id/bookmarks",e,{fullResponse:!0,params:{id:t.data.id}});return new V.TweetBookmarksTimelineV2Paginator({realData:r.data,rateLimit:r.rateLimit,instance:this,queryParams:e,sharedParams:{id:t.data.id}})}me(e={}){return this.get("users/me",e)}user(e,t={}){return this.get("users/:id",t,{params:{id:e}})}users(e,t={}){let r=Array.isArray(e)?e.join(","):e;return this.get("users",{...t,ids:r})}userByUsername(e,t={}){return this.get("users/by/username/:username",t,{params:{username:e}})}usersByUsernames(e,t={}){return e=Array.isArray(e)?e.join(","):e,this.get("users/by",{...t,usernames:e})}async followers(e,t={}){let{asPaginator:r,...i}=t,n={id:e};if(!r)return this.get("users/:id/followers",i,{params:n});let a=await this.get("users/:id/followers",i,{fullResponse:!0,params:n});return new me.UserFollowersV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:i,sharedParams:n})}async following(e,t={}){let{asPaginator:r,...i}=t,n={id:e};if(!r)return this.get("users/:id/following",i,{params:n});let a=await this.get("users/:id/following",i,{fullResponse:!0,params:n});return new me.UserFollowingV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:i,sharedParams:n})}async userLikedTweets(e,t={}){let r={id:e},i=await this.get("users/:id/liked_tweets",t,{fullResponse:!0,params:r});return new V.TweetV2UserLikedTweetsPaginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:{...t},sharedParams:r})}async userBlockingUsers(e,t={}){let r={id:e},i=await this.get("users/:id/blocking",t,{fullResponse:!0,params:r});return new me.UserBlockingUsersV2Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:{...t},sharedParams:r})}async userMutingUsers(e,t={}){let r={id:e},i=await this.get("users/:id/muting",t,{fullResponse:!0,params:r});return new me.UserMutingUsersV2Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:{...t},sharedParams:r})}list(e,t={}){return this.get("lists/:id",t,{params:{id:e}})}async listsOwned(e,t={}){let r={id:e},i=await this.get("users/:id/owned_lists",t,{fullResponse:!0,params:r});return new V.UserOwnedListsV2Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:{...t},sharedParams:r})}async listMemberships(e,t={}){let r={id:e},i=await this.get("users/:id/list_memberships",t,{fullResponse:!0,params:r});return new V.UserListMembershipsV2Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:{...t},sharedParams:r})}async listFollowed(e,t={}){let r={id:e},i=await this.get("users/:id/followed_lists",t,{fullResponse:!0,params:r});return new V.UserListFollowedV2Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:{...t},sharedParams:r})}async listTweets(e,t={}){let r={id:e},i=await this.get("lists/:id/tweets",t,{fullResponse:!0,params:r});return new V.TweetV2ListTweetsPaginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:{...t},sharedParams:r})}async listMembers(e,t={}){let r={id:e},i=await this.get("lists/:id/members",t,{fullResponse:!0,params:r});return new me.UserListMembersV2Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:{...t},sharedParams:r})}async listFollowers(e,t={}){let r={id:e},i=await this.get("lists/:id/followers",t,{fullResponse:!0,params:r});return new me.UserListFollowersV2Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:{...t},sharedParams:r})}async listDmEvents(e={}){let t=await this.get("dm_events",e,{fullResponse:!0});return new qs.FullDMTimelineV2Paginator({realData:t.data,rateLimit:t.rateLimit,instance:this,queryParams:{...e}})}async listDmEventsWithParticipant(e,t={}){let r={participant_id:e},i=await this.get("dm_conversations/with/:participant_id/dm_events",t,{fullResponse:!0,params:r});return new qs.OneToOneDMTimelineV2Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:{...t},sharedParams:r})}async listDmEventsOfConversation(e,t={}){let r={dm_conversation_id:e},i=await this.get("dm_conversations/:dm_conversation_id/dm_events",t,{fullResponse:!0,params:r});return new qs.ConversationDMTimelineV2Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:{...t},sharedParams:r})}space(e,t={}){return this.get("spaces/:id",t,{params:{id:e}})}spaces(e,t={}){return this.get("spaces",{ids:e,...t})}spacesByCreators(e,t={}){return this.get("spaces/by/creator_ids",{user_ids:e,...t})}searchSpaces(e){return this.get("spaces/search",e)}spaceBuyers(e,t={}){return this.get("spaces/:id/buyers",t,{params:{id:e}})}spaceTweets(e,t={}){return this.get("spaces/:id/tweets",t,{params:{id:e}})}searchStream({autoConnect:e,...t}={}){return this.getStream("tweets/search/stream",t,{payloadIsError:Rs.isTweetStreamV2ErrorPayload,autoConnect:e})}streamRules(e={}){return this.get("tweets/search/stream/rules",e)}updateStreamRules(e,t={}){return this.post("tweets/search/stream/rules",e,{query:t})}sampleStream({autoConnect:e,...t}={}){return this.getStream("tweets/sample/stream",t,{payloadIsError:Rs.isTweetStreamV2ErrorPayload,autoConnect:e})}sample10Stream({autoConnect:e,...t}={}){return this.getStream("tweets/sample10/stream",t,{payloadIsError:Rs.isTweetStreamV2ErrorPayload,autoConnect:e})}complianceJobs(e){return this.get("compliance/jobs",e)}complianceJob(e){return this.get("compliance/jobs/:id",void 0,{params:{id:e}})}async sendComplianceJob(e){let t=await this.post("compliance/jobs",{type:e.type,name:e.name}),r=e.ids instanceof Buffer?e.ids:Buffer.from(e.ids.join(`
`));return await this.put(t.data.upload_url,r,{forceBodyMode:"raw",enableAuth:!1,headers:{"Content-Type":"text/plain"},prefix:""}),t}async complianceJobResult(e){let t=e;for(;t.status!=="complete";){if(t.status==="expired"||t.status==="failed")throw new Error("Job failed to be completed.");await new Promise(i=>setTimeout(i,3500)),t=(await this.complianceJob(e.id)).data}return(await this.get(e.download_url,void 0,{enableAuth:!1,prefix:""})).trim().split(`
`).filter(i=>i).map(i=>JSON.parse(i))}};ct.default=Ss});var Ms=u(lt=>{"use strict";var tu=lt&&lt.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(lt,"__esModule",{value:!0});var ru=C(),su=tu(vs()),Ls=class extends su.default{constructor(){super(...arguments),this._prefix=ru.API_V2_LABS_PREFIX}get readOnly(){return this}};lt.default=Ls});var js=u(dt=>{"use strict";var Ln=dt&&dt.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(dt,"__esModule",{value:!0});var iu=C(),nu=Ln(Ds()),au=Ln(Ms()),Is=class extends nu.default{constructor(){super(...arguments),this._prefix=iu.API_V2_PREFIX}get readOnly(){return this}get labs(){return this._labs?this._labs:this._labs=new au.default(this)}hideReply(e,t){return this.put("tweets/:id/hidden",{hidden:t},{params:{id:e}})}like(e,t){return this.post("users/:id/likes",{tweet_id:t},{params:{id:e}})}unlike(e,t){return this.delete("users/:id/likes/:tweet_id",void 0,{params:{id:e,tweet_id:t}})}retweet(e,t){return this.post("users/:id/retweets",{tweet_id:t},{params:{id:e}})}unretweet(e,t){return this.delete("users/:id/retweets/:tweet_id",void 0,{params:{id:e,tweet_id:t}})}tweet(e,t={}){return typeof e=="object"?t=e:t={text:e,...t},this.post("tweets",t)}reply(e,t,r={}){var i;let n={in_reply_to_tweet_id:t,...(i=r.reply)!==null&&i!==void 0?i:{}};return this.post("tweets",{text:e,...r,reply:n})}quote(e,t,r={}){return this.tweet(e,{...r,quote_tweet_id:t})}async tweetThread(e){var t,r;let i=[];for(let n of e){let a=i.length?i[i.length-1]:null,o={...typeof n=="string"?{text:n}:n},c=a?a.data.id:(t=o.reply)===null||t===void 0?void 0:t.in_reply_to_tweet_id,m=(r=o.text)!==null&&r!==void 0?r:"";c?i.push(await this.reply(m,c,o)):i.push(await this.tweet(m,o))}return i}deleteTweet(e){return this.delete("tweets/:id",void 0,{params:{id:e}})}async bookmark(e){let t=await this.getCurrentUserV2Object();return this.post("users/:id/bookmarks",{tweet_id:e},{params:{id:t.data.id}})}async deleteBookmark(e){let t=await this.getCurrentUserV2Object();return this.delete("users/:id/bookmarks/:tweet_id",void 0,{params:{id:t.data.id,tweet_id:e}})}follow(e,t){return this.post("users/:id/following",{target_user_id:t},{params:{id:e}})}unfollow(e,t){return this.delete("users/:source_user_id/following/:target_user_id",void 0,{params:{source_user_id:e,target_user_id:t}})}block(e,t){return this.post("users/:id/blocking",{target_user_id:t},{params:{id:e}})}unblock(e,t){return this.delete("users/:source_user_id/blocking/:target_user_id",void 0,{params:{source_user_id:e,target_user_id:t}})}mute(e,t){return this.post("users/:id/muting",{target_user_id:t},{params:{id:e}})}unmute(e,t){return this.delete("users/:source_user_id/muting/:target_user_id",void 0,{params:{source_user_id:e,target_user_id:t}})}createList(e){return this.post("lists",e)}updateList(e,t={}){return this.put("lists/:id",t,{params:{id:e}})}removeList(e){return this.delete("lists/:id",void 0,{params:{id:e}})}addListMember(e,t){return this.post("lists/:id/members",{user_id:t},{params:{id:e}})}removeListMember(e,t){return this.delete("lists/:id/members/:user_id",void 0,{params:{id:e,user_id:t}})}subscribeToList(e,t){return this.post("users/:id/followed_lists",{list_id:t},{params:{id:e}})}unsubscribeOfList(e,t){return this.delete("users/:id/followed_lists/:list_id",void 0,{params:{id:e,list_id:t}})}pinList(e,t){return this.post("users/:id/pinned_lists",{list_id:t},{params:{id:e}})}unpinList(e,t){return this.delete("users/:id/pinned_lists/:list_id",void 0,{params:{id:e,list_id:t}})}sendDmInConversation(e,t){return this.post("dm_conversations/:dm_conversation_id/messages",t,{params:{dm_conversation_id:e}})}sendDmToParticipant(e,t){return this.post("dm_conversations/with/:participant_id/messages",t,{params:{participant_id:e}})}createDmConversation(e){return this.post("dm_conversations",e)}};dt.default=Is});var xs=u(De=>{"use strict";var ou=De&&De.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(De,"__esModule",{value:!0});De.TwitterApiv2Labs=void 0;var uu=C(),cu=ou(Ms()),Nt=class extends cu.default{constructor(){super(...arguments),this._prefix=uu.API_V2_LABS_PREFIX}get readWrite(){return this}};De.TwitterApiv2Labs=Nt;De.default=Nt});var Os=u(Le=>{"use strict";var Mn=Le&&Le.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Le,"__esModule",{value:!0});Le.TwitterApiv2=void 0;var lu=C(),du=Mn(js()),hu=Mn(xs()),Vt=class extends du.default{constructor(){super(...arguments),this._prefix=lu.API_V2_PREFIX}get readWrite(){return this}get labs(){return this._labs?this._labs:this._labs=new hu.default(this)}};Le.TwitterApiv2=Vt;Le.default=Vt});var Us=u(ht=>{"use strict";var mt=ht&&ht.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ht,"__esModule",{value:!0});var Ct=mt(Ht()),mu=mt(_r()),fu=mt(Wr()),_u=mt(Ds()),As=mr(),pu=mt(dr()),Fs=class extends mu.default{get v1(){return this._v1?this._v1:this._v1=new fu.default(this)}get v2(){return this._v2?this._v2:this._v2=new _u.default(this)}async currentUser(e=!1){return await this.getCurrentUserObject(e)}async currentUserV2(e=!1){return await this.getCurrentUserV2Object(e)}search(e,t){return this.v2.search(e,t)}async generateAuthLink(e="oob",{authAccessType:t,linkMode:r="authenticate",forceLogin:i,screenName:n}={}){let a=await this.post("https://api.twitter.com/oauth/request_token",{oauth_callback:e,x_auth_access_type:t}),o=`https://api.twitter.com/oauth/${r}?oauth_token=${encodeURIComponent(a.oauth_token)}`;return i!==void 0&&(o+=`&force_login=${encodeURIComponent(i)}`),n!==void 0&&(o+=`&screen_name=${encodeURIComponent(n)}`),this._requestMaker.hasPlugins()&&this._requestMaker.applyPluginMethod("onOAuth1RequestToken",{client:this._requestMaker,url:o,oauthResult:a}),{url:o,...a}}async login(e){let t=this.getActiveTokens();if(t.type!=="oauth-1.0a")throw new Error("You must setup TwitterApi instance with consumer keys to accept OAuth 1.0 login");let r=await this.post("https://api.twitter.com/oauth/access_token",{oauth_token:t.accessToken,oauth_verifier:e}),i=new Ct.default({appKey:t.appKey,appSecret:t.appSecret,accessToken:r.oauth_token,accessSecret:r.oauth_token_secret},this._requestMaker.clientSettings);return{accessToken:r.oauth_token,accessSecret:r.oauth_token_secret,userId:r.user_id,screenName:r.screen_name,client:i}}async appLogin(){let e=this.getActiveTokens();if(e.type!=="oauth-1.0a")throw new Error("You must setup TwitterApi instance with consumer keys to accept app-only login");let r=await new Ct.default({username:e.appKey,password:e.appSecret},this._requestMaker.clientSettings).post("https://api.twitter.com/oauth2/token",{grant_type:"client_credentials"});return new Ct.default(r.access_token,this._requestMaker.clientSettings)}generateOAuth2AuthLink(e,t={}){var r,i;if(!this._requestMaker.clientId)throw new Error("Twitter API instance is not initialized with client ID. You can find your client ID in Twitter Developer Portal. Please build an instance with: new TwitterApi({ clientId: '<yourClientId>' })");let n=(r=t.state)!==null&&r!==void 0?r:As.OAuth2Helper.generateRandomString(32),a=As.OAuth2Helper.getCodeVerifier(),o=As.OAuth2Helper.getCodeChallengeFromVerifier(a),c=(i=t.scope)!==null&&i!==void 0?i:"",m=Array.isArray(c)?c.join(" "):c,h=new URL("https://twitter.com/i/oauth2/authorize"),f={response_type:"code",client_id:this._requestMaker.clientId,redirect_uri:e,state:n,code_challenge:o,code_challenge_method:"s256",scope:m};pu.default.addQueryParamsToUrl(h,f);let w={url:h.toString(),state:n,codeVerifier:a,codeChallenge:o};return this._requestMaker.hasPlugins()&&this._requestMaker.applyPluginMethod("onOAuth2RequestToken",{client:this._requestMaker,result:w,redirectUri:e}),w}async loginWithOAuth2({code:e,codeVerifier:t,redirectUri:r}){if(!this._requestMaker.clientId)throw new Error("Twitter API instance is not initialized with client ID. Please build an instance with: new TwitterApi({ clientId: '<yourClientId>' })");let i=await this.post("https://api.twitter.com/2/oauth2/token",{code:e,code_verifier:t,redirect_uri:r,grant_type:"authorization_code",client_id:this._requestMaker.clientId,client_secret:this._requestMaker.clientSecret});return this.parseOAuth2AccessTokenResult(i)}async refreshOAuth2Token(e){if(!this._requestMaker.clientId)throw new Error("Twitter API instance is not initialized with client ID. Please build an instance with: new TwitterApi({ clientId: '<yourClientId>' })");let t=await this.post("https://api.twitter.com/2/oauth2/token",{refresh_token:e,grant_type:"refresh_token",client_id:this._requestMaker.clientId,client_secret:this._requestMaker.clientSecret});return this.parseOAuth2AccessTokenResult(t)}async revokeOAuth2Token(e,t="access_token"){if(!this._requestMaker.clientId)throw new Error("Twitter API instance is not initialized with client ID. Please build an instance with: new TwitterApi({ clientId: '<yourClientId>' })");return await this.post("https://api.twitter.com/2/oauth2/revoke",{client_id:this._requestMaker.clientId,client_secret:this._requestMaker.clientSecret,token:e,token_type_hint:t})}parseOAuth2AccessTokenResult(e){let t=new Ct.default(e.access_token,this._requestMaker.clientSettings),r=e.scope.split(" ").filter(i=>i);return{client:t,expiresIn:e.expires_in,accessToken:e.access_token,scope:r,refreshToken:e.refresh_token}}};ht.default=Fs});var Bs=u(ft=>{"use strict";var Es=ft&&ft.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ft,"__esModule",{value:!0});var gu=Es(Xr()),wu=Es(js()),yu=Es(Us()),ks=class extends yu.default{get v1(){return this._v1?this._v1:this._v1=new gu.default(this)}get v2(){return this._v2?this._v2:this._v2=new wu.default(this)}get readOnly(){return this}};ft.default=ks});var Ht=u(z=>{"use strict";var _t=z&&z.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(z,"__esModule",{value:!0});z.TwitterApiReadOnly=z.TwitterApiReadWrite=z.TwitterApi=void 0;var vu=_t(xt()),Pu=_t(Os()),bu=_t(Bs()),Wt=class extends bu.default{get v1(){return this._v1?this._v1:this._v1=new vu.default(this)}get v2(){return this._v2?this._v2:this._v2=new Pu.default(this)}get readWrite(){return this}static getErrors(e){var t;return typeof e!="object"?[]:"data"in e?(t=e.data.errors)!==null&&t!==void 0?t:[]:[]}static getProfileImageInSize(e,t){let r=e.split("/").pop(),i=["normal","bigger","mini"],n=e;for(let o of i)if(r.includes(`_${o}`)){n=e.replace(`_${o}`,"");break}if(t==="original")return n;let a=n.lastIndexOf(".");if(a!==-1){let o=n.slice(a+1);return n.slice(0,a)+"_"+t+"."+o}else return n+"_"+t}};z.TwitterApi=Wt;var Tu=Bs();Object.defineProperty(z,"TwitterApiReadWrite",{enumerable:!0,get:function(){return _t(Tu).default}});var Ru=Us();Object.defineProperty(z,"TwitterApiReadOnly",{enumerable:!0,get:function(){return _t(Ru).default}});z.default=Wt});var In=u(T=>{"use strict";var qu=T&&T.__createBinding||(Object.create?function(s,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,r,i)}:function(s,e,t,r){r===void 0&&(r=t),s[r]=e[t]}),ne=T&&T.__exportStar||function(s,e){for(var t in s)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&qu(e,s,t)},Su=T&&T.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(T,"__esModule",{value:!0});T.default=void 0;var Du=Ht();Object.defineProperty(T,"default",{enumerable:!0,get:function(){return Su(Du).default}});ne(Ht(),T);ne(xt(),T);ne(Os(),T);ne(Kr(),T);ne(xs(),T);ne(K(),T);ne(ws(),T);ne(Tt(),T);ne(Pt(),T)});var ku={};ua(ku,{default:()=>Yn});module.exports=la(ku);var ii=require("@raycast/api");var gt=require("@raycast/api");function X(){return{source:{light:"logo.png",dark:"logo@dark.png"}}}var Vu=new gt.OAuth.PKCEClient({redirectMethod:gt.OAuth.RedirectMethod.Web,providerName:"Twitter",providerIcon:X(),providerId:"twitter",description:"Connect your X account"});function ni(){let e=(0,ii.getPreferenceValues)().listwithdetail;return e===void 0?!0:e}function ai(){return!0}var $e=require("@raycast/api"),$n=require("react");var We=require("@raycast/api");function ce(s){return s instanceof Error?s.message:"unknown error"}var oi=(s,e)=>String(s).padStart(e,"\u2000"),da=new Intl.NumberFormat("en",{notation:"compact"});function ze(s){return da.format(s)}var Cn=require("@raycast/api");var Xt=require("@raycast/api");var _=require("@raycast/api");var jn=require("@raycast/api"),Me=require("react"),xn=ca(In());function Lu(){let s=(0,jn.getPreferenceValues)(),e=s.appkey||"",t=s.appsecret||"",r=s.accesstoken||"",i=s.accesssecret||"";return new xn.TwitterApi({appKey:e,appSecret:t,accessToken:r,accessSecret:i})}var Ns=null;function F(){return Ns||(Ns=Lu()),Ns}var Vs;async function Cs(){return Vs||(Vs=await F().v1.accountSettings()),Vs}async function Hs(s){if(s){let e=s.map(i=>i.id_str),t=await F().v1.tweets(e),r=[];for(let i of e){let n=t.find(a=>i===a.id_str);n&&r.push(n)}return r}else return}async function On(s){let e=await Hs([s]);if(e&&e.length===1)return e[0]}function He(s,e){let[t,r]=(0,Me.useState)(),[i,n]=(0,Me.useState)(),[a,o]=(0,Me.useState)(!0),[c,m]=(0,Me.useState)(new Date),h=[c];if(e)for(let oe of e)h.push(oe);let f=!1,w={updateInline:async()=>{await te(!0)},refresh:async()=>{m(new Date)}};async function te(oe=!1){if(!f){o(!0),n(void 0);try{let _e=await s(oe);f||r(_e)}catch(_e){f||n(ce(_e))}finally{f||o(!1)}}}return(0,Me.useEffect)(()=>(te(),()=>{f=!0}),h),{data:t,error:i,isLoading:a,fetcher:w}}function Ws(s){let e=s.entities.media;if(e){for(let t of e)if(t.type==="photo"&&t.media_url_https)return t.media_url_https}}var l=require("@raycast/api"),$t=require("react");var v=require("@raycast/api"),$s=require("react");var fe=require("react/jsx-runtime");async function Mu(s,e){try{let t=s.text;if(t.length<=0)throw Error("Please enter a text");if(t.length>280)throw Error("Tweet text could not be longer than 280 characters");e?(await F().v1.reply(t,e.id_str),await(0,v.showToast)({style:v.Toast.Style.Success,title:"Tweet created",message:"Reply Tweet creation successful"})):(await F().v1.tweet(t),await(0,v.showToast)({style:v.Toast.Style.Success,title:"Tweet created",message:"Tweet creation successful"})),(0,v.popToRoot)()}catch(t){await(0,v.showToast)({style:v.Toast.Style.Failure,title:"Error",message:ce(t)})}}function Iu(s){let e=s.text,t=ju(e);return(0,fe.jsx)(v.Form.Description,{text:`${e.length}/280 ${t?"\u2705":"\u274C"}`})}function An(s){let e=s.replyTweet,t=e?"Send Reply":"Send Tweet",r=e?"Reply":"Tweet",i=e?"Tweet your reply":"What's happening?",[n,a]=(0,$s.useState)("");return(0,fe.jsxs)(v.Form,{actions:(0,fe.jsx)(v.ActionPanel,{children:n.length>0&&n.length<=280&&(0,fe.jsx)(v.Action.SubmitForm,{title:t,onSubmit:o=>Mu(o,e)})}),children:[(0,fe.jsx)(v.Form.TextArea,{id:"text",title:r,placeholder:i,onChange:a}),(0,fe.jsx)(Iu,{text:n})]})}function ju(s){let e=s.length;return!(e<1||e>280)}var U=require("react/jsx-runtime");function Fn(s){return(0,U.jsx)(l.Action.Push,{title:"Show Tweet",target:(0,U.jsx)(kn,{tweet:s.tweet}),icon:{source:l.Icon.List,tintColor:l.Color.PrimaryText}})}function zs(s){return(0,U.jsx)(l.Action.Push,{title:"Reply",target:(0,U.jsx)(An,{replyTweet:s.tweet}),icon:{source:l.Icon.Bubble,tintColor:l.Color.PrimaryText},shortcut:{modifiers:["cmd"],key:"w"}})}function Xs(s){let[e,t]=(0,$t.useState)();(0,$t.useEffect)(()=>{async function n(){try{let a=await Cs();t(a.screen_name)}catch{}}n()},[]);let r=s.tweet,i=async()=>{try{if((await Cs()).screen_name!==r.user.screen_name)throw Error("You can only delete your own Tweets");await F().v1.deleteTweet(r.id_str),(0,l.showToast)({style:l.Toast.Style.Success,title:"Tweet deleted",message:"Tweet deletion successful"})}catch(n){(0,l.showToast)({style:l.Toast.Style.Failure,title:"Could not delete Tweet",message:ce(n)})}};return e===r.user.screen_name?(0,U.jsx)(l.Action,{title:"Delete Tweet",icon:{source:l.Icon.XMarkCircle,tintColor:l.Color.Red},onAction:i}):null}function Ks(s){let e=s.tweet,t=e.retweeted?"unretweet":"retweet",r=e.retweeted?"Unretweet":"Retweet",i=e.retweeted?{source:"retweet.png",tintColor:l.Color.Green}:{source:"retweet.png",tintColor:l.Color.PrimaryText};return(0,U.jsx)(l.Action,{title:r,icon:i,onAction:async()=>{try{await F().v1.post(`statuses/${t}/${e.id_str}.json`),(0,l.showToast)({style:l.Toast.Style.Success,title:"Retweet successful",message:"Retweet creation successful"}),s.fetcher&&await s.fetcher.updateInline()}catch(a){(0,l.showToast)({style:l.Toast.Style.Failure,title:"Could not retweet",message:ce(a)})}},shortcut:{modifiers:["cmd"],key:"t"}})}function Qs(s){let e=s.tweet,t=e.favorited?"destroy":"create",r=e.favorited?"Undo Like":"Like",i=e.favorited?{source:"heart_full.png",tintColor:l.Color.Red}:{source:"heart_empty.png",tintColor:l.Color.PrimaryText},n=async()=>{try{await F().v1.post(`favorites/${t}.json`,{id:e.id_str}),(0,l.showToast)({style:l.Toast.Style.Success,title:`${r} successful`,message:`${r} operation successful`}),s.fetcher&&await s.fetcher.updateInline()}catch(a){(0,l.showToast)({style:l.Toast.Style.Failure,title:`${r} failed`,message:ce(a)})}};return(0,U.jsx)(l.ActionPanel.Item,{title:r,shortcut:{modifiers:["cmd"],key:"l"},icon:i,onAction:n})}function Ys(s){return(0,U.jsx)(l.Action.OpenInBrowser,{title:"Open Author Profile",url:`https://twitter.com/${s.tweet.user.screen_name}`,icon:{source:l.Icon.Person,tintColor:l.Color.PrimaryText}})}function Un(s){let e=async()=>{s.fetcher&&await s.fetcher.updateInline()};return(0,U.jsx)(l.Action,{title:"Refresh Existing Tweets",shortcut:{modifiers:["cmd","shift"],key:"r"},icon:{source:l.Icon.Download,tintColor:l.Color.PrimaryText},onAction:e})}function Js(s){let e=async()=>{s.fetcher&&await s.fetcher.refresh()},t=s.title?s.title:"Refresh Tweets";return(0,U.jsx)(l.Action,{title:t,shortcut:{modifiers:["cmd"],key:"r"},icon:{source:l.Icon.Binoculars,tintColor:l.Color.PrimaryText},onAction:e})}function Gs(s){return(0,U.jsx)(l.Action.Push,{title:s.title||`Tweets from @${s.username}`,shortcut:{modifiers:["cmd","shift"],key:"a"},icon:X(),target:(0,U.jsx)(zt,{username:s.username})})}var d=require("react/jsx-runtime");function En(s){return`https://twitter.com/${s.user.screen_name}/status/${s.id_str}`}function xu(s){let e=s.tweet,t=s.withDetail,r=s.fetcher,i=s.millifyState!==void 0?s.millifyState:!0,n=70,a=e.full_text?e.full_text.trim():"",o=a.slice(0,n)+(a.length>n?" ...":""),m=e.user.profile_image_url_https?{source:e.user.profile_image_url_https,mask:_.Image.Mask.Circle}:void 0,h=e.favorited&&a.startsWith("RT @")?1:0,f=!!Ws(e),w=(ue,ta)=>{if(ue===void 0)return"0";let ra=i?ze(ue):`${ue}`;return oi(ra,ta)},te=1,oe=3,_e=ue=>ue===void 0||ue<te?te:ue>oe?oe:ue,Jn=_e(s.maxCommentDigits),Gn=_e(s.maxRTDigits),Zn=_e(s.maxFavDigits),Qt=[`\u{1F4AC} ${w(e.reply_count||0,Jn)}`,`\u{1F501} ${w(e.retweet_count,Gn)}`,`\u2764\uFE0F ${w(e.favorite_count+h,Zn)}`];f&&(Qt=["\u{1F5BC}\uFE0F",...Qt]);let ea=[{text:Qt.join("  ")}];return(0,d.jsx)(_.List.Item,{id:e.id_str,title:o,icon:m,accessories:t?void 0:ea,detail:t?(0,d.jsx)(_.List.Item.Detail,{markdown:Bn(e)}):void 0,actions:(0,d.jsxs)(_.ActionPanel,{children:[(0,d.jsxs)(_.ActionPanel.Section,{title:"Tweet",children:[(0,d.jsx)(Fn,{tweet:e}),(0,d.jsx)(_.Action.OpenInBrowser,{url:En(e),shortcut:{modifiers:["cmd"],key:"b"}}),(0,d.jsx)(Qs,{tweet:e,fetcher:r}),(0,d.jsx)(zs,{tweet:e}),(0,d.jsx)(Ks,{tweet:e,fetcher:r}),(0,d.jsx)(Gs,{username:e.user.screen_name})]}),(0,d.jsx)(_.ActionPanel.Section,{title:"Info",children:(0,d.jsx)(Ys,{tweet:e})}),(0,d.jsx)(_.ActionPanel.Section,{title:"Destructive",children:(0,d.jsx)(Xs,{tweet:e})}),(0,d.jsxs)(_.ActionPanel.Section,{title:"Update",children:[(0,d.jsx)(Un,{fetcher:r}),(0,d.jsx)(Js,{fetcher:r})]})]})},e.id_str)}function Ou(s){if(s.full_text!==void 0){if(Zs(s)){let e=s.full_text.indexOf(":");if(e!==void 0&&e>0)return s.full_text.substring(e+1).trimStart()}return s.full_text}}function Zs(s){return!!(s.full_text&&s.full_text.startsWith("RT @"))}function Bn(s){let e=s,t=e.favorited&&Zs(e)?1:0,r=[`\u{1F4AC} ${e.reply_count||0}`,`\u{1F501} ${e.retweet_count}`,`\u2764\uFE0F ${e.favorite_count+t}`],i=Ws(e),n=Zs(e)?" retweeted":"",a=[`## ${e.user.name} \`@${e.user.screen_name}\`${n}`,Ou(e)||"",`\`${e.created_at}\``];return i&&a.push(`![${i}](${i})`),a.push(r.join("   ")),a.join(`

`)}function kn(s){let{data:e,error:t,isLoading:r,fetcher:i}=He(async()=>e===void 0?s.tweet:await On(e));t&&(0,_.showToast)({style:_.Toast.Style.Failure,title:"Error",message:t});let n=e||s.tweet,a=Bn(n);return(0,d.jsx)(_.Detail,{isLoading:r,markdown:a,actions:(0,d.jsxs)(_.ActionPanel,{children:[(0,d.jsxs)(_.ActionPanel.Section,{title:"Tweet",children:[(0,d.jsx)(zs,{tweet:n}),(0,d.jsx)(Qs,{tweet:n,fetcher:i}),(0,d.jsx)(Ks,{tweet:n,fetcher:i}),(0,d.jsx)(Gs,{username:n.user.screen_name}),(0,d.jsx)(_.Action.OpenInBrowser,{url:En(n),shortcut:{modifiers:["cmd"],key:"b"}})]}),(0,d.jsx)(_.ActionPanel.Section,{title:"Info",children:(0,d.jsx)(Ys,{tweet:n})}),(0,d.jsx)(_.ActionPanel.Section,{title:"Destructive",children:(0,d.jsx)(Xs,{tweet:n})}),(0,d.jsx)(_.ActionPanel.Section,{title:"Update",children:(0,d.jsx)(Js,{title:"Refresh Tweet",fetcher:i})})]})})}function Nn(s){let e=s.tweets,t=ni(),r=s.millifyState!==void 0?s.millifyState:!0,i=1,n=1,a=1,o=c=>c===void 0?0:(r?ze(c):`${c}`).length;if(e)for(let c of e){let m=o(c.favorite_count);m>i&&(i=m);let h=o(c.retweet_count);h>n&&(n=h);let f=o(c.reply_count);f>a&&(a=f)}return(0,d.jsx)(_.List,{isLoading:s.isLoading,searchBarPlaceholder:"Filter Tweets by name...",isShowingDetail:t,children:e?.map(c=>(0,d.jsx)(xu,{tweet:c,fetcher:s.fetcher,maxCommentDigits:a,maxFavDigits:i,maxRTDigits:n,millifyState:r,withDetail:t},c.id_str))})}var Vn=require("react/jsx-runtime");function zt(s){let e=s.username,{data:t,error:r,isLoading:i,fetcher:n}=He(async a=>a?await Hs(t):await Au(e));return r&&(0,Xt.showToast)({style:Xt.Toast.Style.Failure,title:"Error",message:r}),(0,Vn.jsx)(Nn,{isLoading:i,tweets:t,fetcher:n})}async function Au(s){let e=await F().v1.userTimelineByUsername(s),t=[];for(let r of e.tweets)t.push(r);return t}var ei=require("react/jsx-runtime");function Hn(s){return(0,ei.jsx)(Cn.Action.Push,{title:"Show Tweets",target:(0,ei.jsx)(zt,{username:s.user.screen_name}),icon:X()})}var Kt=require("react/jsx-runtime");function Wn(s){let e=s.user;return(0,Kt.jsx)(We.List.Item,{title:e.name,subtitle:`@${e.screen_name}`,icon:{source:e.profile_image_url_https,mask:We.Image.Mask.Circle},accessoryTitle:`${ze(e.followers_count)}`,accessoryIcon:{source:"\u{1F440}"},actions:(0,Kt.jsx)(We.ActionPanel,{children:(0,Kt.jsx)(Hn,{user:e})})},e.screen_name)}var ti=require("react/jsx-runtime");function zn(){let[s,e]=(0,$n.useState)(),{data:t,error:r,isLoading:i,fetcher:n}=He(async()=>{if(s&&s.length>0&&s!=="@"){let a=await F().v1.searchUsers(s),o=[];for(let c of a)o.push(c);return o}else return},[s]);return r&&(0,$e.showToast)({style:$e.Toast.Style.Failure,title:"Error",message:r}),(0,ti.jsx)($e.List,{isLoading:i,searchBarPlaceholder:"Search User by Name of Handle (e.g. @tonka_2000 or Michael Aigner)...",onSearchTextChange:e,throttle:!0,children:t?.map(a=>(0,ti.jsx)(Wn,{user:a},a.screen_name))})}var ee=require("@raycast/api"),Xn=require("react"),Kn=require("url");var ae=require("react/jsx-runtime");function Fu(s){let e=new Kn.URL("https://twitter.com/search");return e.searchParams.append("q",s.search),e.searchParams.append("f","user"),(0,ae.jsx)(ee.Action.OpenInBrowser,{title:"Search on Twitter.com",icon:X(),url:e.href})}function Uu(s){let e=s.search;return!e||e.length<=0?null:(0,ae.jsx)(ee.List.Item,{title:`Search '${e}' on twitter.com`,icon:X(),actions:(0,ae.jsx)(ee.ActionPanel,{children:(0,ae.jsx)(Fu,{search:e})})})}function Qn(){let[s,e]=(0,Xn.useState)();return(0,ae.jsxs)(ee.List,{searchText:s,onSearchTextChange:e,searchBarPlaceholder:"Search Users by Name or Handle (e.g. @tonka_2000 or Michael Aigner)",children:[(0,ae.jsx)(Uu,{search:s}),(0,ae.jsx)(ee.List.EmptyView,{icon:ee.Icon.Person,title:"Search for a User on X.com"})]})}var ri=require("react/jsx-runtime");function Yn(){return ai()?(0,ri.jsx)(Qn,{}):(0,ri.jsx)(zn,{})}
